%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Roberto Reale - Tesi di laurea in matematica %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% versione finale completata il : 15 ottobre 2009

% convenzioni : 
% non negativo [invece di: non-negativo, nonnegativo]
% disuguaglianza [invece di: diseguaglianza]
% convergenza monotona, dominata [invece di: Convergenza Monotona, Dominata]
% disuguaglianza isodiametrica [invece di: Disuguaglianza Isodiametrica]
% \Card(J), \Lip(f), etc. [invece di: \Card J, \Lip f, etc.]

% \hspace*{\parindent}

\documentclass[a4paper,10pt,openright,oneside]{book}

%%%%%%%%%%%%%
% pacchetti %
%%%%%%%%%%%%%

\usepackage[latin1]{inputenc}
\usepackage[italian]{babel}

\usepackage[T1,OT2]{fontenc} % da caricare prima dei fonts! 
\usepackage{newlfont}
\usepackage{fouriernc}

\usepackage{geometry}

\usepackage{setspace}
\setstretch{1.06}

\usepackage{amsmath}
\usepackage[amsmath]{ntheorem}

\usepackage{microtype}
\usepackage{makeidx}
\usepackage[dvips]{graphicx} % driver 'dvips'

\usepackage{braket}
\usepackage{centernot}

\frenchspacing

%%%%%%%%%%%%%%%%%%%%%%%%%%
% ambienti \theorem-like % 
%%%%%%%%%%%%%%%%%%%%%%%%%%

\makeatletter

\newtheoremstyle{theoremstyle}%
	{\item[\hskip\labelsep \theorem@headerfont (##2)\ ##1\theorem@separator]}%
	{\item[\hskip\labelsep \theorem@headerfont (##2)\ ##1\ (##3)\theorem@separator]}
\newtheoremstyle{theoremstylewoheader}%
	{\item[]}% not used
	{\item[\hskip\labelsep \theorem@headerfont (##2)\ ##3\theorem@separator]}
\newtheoremstyle{proofsecstyle}%
	{\item[\hskip\labelsep \theorem@headerfont (##2)\hspace{-.18em}]}%
	{\item[]}% not used

\makeatother

\theoremstyle{theoremstyle}
\newtheorem{teorema}{Teorema}[section]
\newtheorem{lemma}[teorema]{Lemma}
\newtheorem{corollario}[teorema]{Corollario}

\theoremstyle{theoremstylewoheader}
\newtheorem{teorema2}[teorema]{}

\theoremstyle{theoremstyle}

\theorembodyfont{\upshape}
\newtheorem{definizione}[teorema]{Definizione}
\newtheorem{definizioni}[teorema]{Definizioni}
\newtheorem{esempio}[teorema]{Esempio}
\newtheorem{notazione}[teorema]{Notazione}

\newtheorem{osservazione}[teorema]{Osservazione}
\newtheorem{osservazioni}[teorema]{Osservazioni}

\theoremstyle{proofsecstyle}

\theoremnumbering{alph}
%\theoremindent2cm
\newtheorem{proofsec}{}

\theoremstyle{nonumberplain}
\theoremnumbering{arabic} % importante !!
\theoremprework{\setcounter{proofsec}{0}}
%\theorempostwork{}
%\theorembodyfont{\upshape}
%\theoremsymbol{$\square$}
\newtheorem{proof}{Dim.}

%%%%%%%%%%%%%%%%%%%%%%
% simboli matematici %
%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\AA}{\ensuremath{\mathcal{A}}}
\newcommand{\BB}{\ensuremath{\mathcal{B}}}
\newcommand{\EE}{\ensuremath{\mathcal{E}}}
\newcommand{\FF}{\ensuremath{\mathcal{F}}}
\newcommand{\GG}{\ensuremath{\mathcal{G}}}
\newcommand{\MM}{\ensuremath{\mathcal{M}}}
\newcommand{\OO}{\ensuremath{\mathcal{O}}}
\newcommand{\PP}{\ensuremath{\mathcal{P}}}

\newcommand{\NN}{\ensuremath{\mathbb{N}}}
\newcommand{\ZZ}{\ensuremath{\mathbb{Z}}}
\newcommand{\QQ}{\ensuremath{\mathbb{Q}}}
\newcommand{\RR}{\ensuremath{\mathbb{R}}}

\newcommand{\Leb}{\ensuremath{\mathcal{L}}}
\newcommand{\Haus}{\ensuremath{\mathcal{H}}}
\newcommand{\Hausdim}{\ensuremath{\Haus_\textup{dim}}}

\newcommand{\lDer}[2]{\ensuremath{\underline{D}_{\,#2} #1}}
\newcommand{\uDer}[2]{\ensuremath{\overline{D}_#2 #1}}
\newcommand{\Der}[2]{\ensuremath{D_#2 #1}}

\DeclareSymbolFont{sfletters}{T1}{cmss}{m}{n}
\DeclareMathSymbol{\restr}{\mathbin}{sfletters}{"4C} % lettera 'L'

\DeclareSymbolFont{cyrletters}{OT2}{wncyr}{m}{n}
\DeclareMathSymbol{\ZZZ}{\mathalpha}{cyrletters}{"11} % lettera 'zh' dell'alfabeto cirillico 

\newcommand{\abs}[1]{\ensuremath{\lvert #1 \rvert}}
\newcommand{\Abs}[1]{\ensuremath{\Big\lvert #1 \Big\rvert}}
\newcommand{\norm}[1]{\ensuremath{\| #1 \|}}
\newcommand{\jacobian}[1]{\ensuremath{[\kern-1.7pt[#1]\kern-1.7pt]}}

\newcommand{\boundary}[1]{\ensuremath{\partial #1}}
\newcommand{\closure}[1]{\ensuremath{\overline{#1}}}
\newcommand{\interior}[1]{\ensuremath{#1^o}}

\newcommand{\qo}[1]{\ensuremath{#1\text{-q.o.}}}
\newcommand{\qogni}[2]{\ensuremath{#2\text{-q.o. $\!#1$}}}

\newcommand{\smalloh}{\ensuremath{o}}

\newcommand{\nsim}{\not\sim}
\newcommand{\nll}{\centernot\ll}

\def\Xint#1{\mathchoice
	{\XXint\displaystyle\textstyle{#1}}%
	{\XXint\textstyle\scriptstyle{#1}}%
	{\XXint\scriptstyle\scriptscriptstyle{#1}}%
	{\XXint\scriptscriptstyle\scriptscriptstyle{#1}}%
	\!\int}
\def\XXint#1#2#3{{\setbox0=\hbox{$#1{#2#3}{\int}$}
	\vcenter{\hbox{$#2#3$}}\kern-.5\wd0}}
\def\dashint{\Xint-}

\DeclareMathOperator{\diam}{diam}
\DeclareMathOperator{\dist}{dist}
\DeclareMathOperator{\Card}{Card}
\DeclareMathOperator{\Lip}{Lip}
\DeclareMathOperator{\esssup}{ess\:sup}
\DeclareMathOperator{\essinf}{ess\:inf}
\DeclareMathOperator{\sgn}{sgn}

%%%%%%%%%%%%%%%%%%%%
% comandi speciali %
%%%%%%%%%%%%%%%%%%%%

\renewcommand{\qedsymbol}{\ensuremath{\square}}
\newcommand{\qed}{\unskip\nobreak\hfill\nobreak\hspace{.5em}\qedsymbol}

\newcommand{\mymath}[2]{\begin{itemize}%
  \item[]\hfill\hbox{}\ensuremath{\displaystyle #1}\hfill\ensuremath{\displaystyle #2}%
  \end{itemize}}

\makeindex

\begin{document}

%\fontencoding{T1}\selectfont

%%%%%%%%%%%%%%%%
% frontespizio %
%%%%%%%%%%%%%%%%

\begin{titlepage}
\begin{center}
{\LARGE{\textsc{Universit\`a degli Studi di Napoli $\cdot$ Federico II}}}
\rule[0.1cm]{\textwidth}{0.1mm}\\\rule[0.5cm]{\textwidth}{0.6mm}
{\large{\bf FACOLT\`A DI SCIENZE MATEMATICHE, FISICHE E NATURALI\\
\vspace{1mm}Corso di Laurea in Matematica}}
\end{center}
\vspace{3mm}
\begin{center}
\includegraphics[scale=.035]{media/logo}
\end{center}
\vspace{5mm}
\begin{center}
{\Huge{\bf UNA INTRODUZIONE}}\\
\vspace{3mm}
{\Huge{\bf ALLA TEORIA}}\\
\vspace{3mm}
{\Huge{\bf GEOMETRICA DELLA MISURA}}\\
\vspace{10mm} {\LARGE{\bf Tesi di Laurea in Matematica}}%\\
%\vspace{1mm} {\large{\bf (Tesi compilativa)}}
\end{center}
\vfill
\par
\noindent
\begin{minipage}[t]{0.47\textwidth}
{\large{\bf Relatore:\\
Ch.mo~Prof.~Nicola FUSCO}}
\end{minipage}
\hfill
\begin{minipage}[t]{0.47\textwidth}\raggedleft
{\large{\bf Candidato:\\
Roberto REALE\\
matr.~565/85}}
\end{minipage}
\vspace{5mm}
\begin{center}
{\large{\bf Sessione Autunnale\\
Anno Accademico 2008/09}}
\end{center}
\end{titlepage}

%%%%%%%%%%
% dedica %
%%%%%%%%%%

\cleardoublepage\thispagestyle{empty}\mbox{} % lascia una pagina bianca
\cleardoublepage\thispagestyle{empty}
\null\vspace*{\stretch{1}}
\begin{flushright}
\emph{\Large a Raffaella}
\end{flushright}
\vspace*{\stretch{1.61803398874}}\null % sezione aurea

%%%%%%%%%%%%%%%%%%%
% indice generale %
%%%%%%%%%%%%%%%%%%%

\microtypesetup{protrusion=false}
\tableofcontents
\microtypesetup{protrusion=true}

%%%%%%%%%%%%%%%%
% introduzione %
%%%%%%%%%%%%%%%%

\chapter*{Introduzione}
\addcontentsline{toc}{chapter}{Introduzione}

\begin{flushright}
\emph{Geometric measure theory could be described\\
as differential geometry, generalized through measure theory\\
to deal with maps and surfaces that are not necessarily smooth,\\
and applied to the calculus of variations.}\\
F.~Morgan
\end{flushright}\vspace{2em}

\noindent In questa tesi introduciamo i concetti fondamentali della {\bfseries teoria geometrica della misura}; una disciplina che non soltanto rappresenta una fonte di problemi interessanti di per sé, come quelli che riguardano le superfici minime, ma che è uno dei più potenti strumenti della moderna analisi matematica, con applicazioni in delicate questioni di calcolo delle variazioni ed equazioni alle derivate parziali.

Il lavoro si apre con un capitolo dedicato alla {\bfseries teoria astratta della misura}. L'approccio seguito è quello, dovuto a {\bfseries Caratheodory}, di partire dalla nozione più generale di misura esterna, e da questa ottenere poi, per restrizione alla $\sigma$-algebra degli insiemi misurabili, le misure nell'accezione comune del termine.

Tra le misure definite su uno spazio topologico $X$ e ``compatibili'' con la topologia di $X$, concentriamo la nostra attenzione su una classe dotata di buone proprietà di ``regolarità'' e ``locale finitezza'', ossia la classe delle {\bfseries misure di Radon} su spazi euclidei; ad essa appartiene ad esempio la misura di Lebesgue $n$-dimensionale $\Leb^n$. In particolare, studiamo la possibilità di ``approssimare'' un insieme per mezzo di aperti e di compatti, i classici teoremi di passaggio al limite sotto il segno di integrale e il {\bfseries teorema di Fubini}; quest'ultimo verrà presentato in una forma estremamente generale.

Nel secondo capitolo, dopo aver dimostrato il {\bfseries teorema di ricoprimento di Vitali} e poi, in tutta la sua generalità, quello di {\bfseries Besicovitch}, introduciamo la nozione di {\bfseries derivata di una misura} rispetto ad un'altra e dimostriamo i teoremi di ``calcolo differenziale e integrale'': il teorema di Radon-Nikodym, il teorema di decomposizione di Lebesgue e, soprattutto, il {\bfseries teorema di differenziazione di Lebesgue-Besicovitch}.

L'approccio di Caratheodory alla teoria della misura si rivela particolarmente vantaggioso nel terzo capitolo, nel quale definiamo le {\bfseries misure di Hausdorff} $s$-dimensionali $\Haus^s$ su $\RR^n$ $(0 \le s \le n)$ come misure esterne, e ne studiamo le proprietà. Utilizzando la nozione geometrica di {\bfseries simmetrizzazione di Steiner} perveniamo poi ad una dimostrazione rigorosa della classica {\bfseries disuguaglianza isodiametrica}; quest'ultima, a sua volta, ci permette di provare che $\Haus^n = \Leb^n$. Nel capitolo sono inclusi inoltre alcuni risultati concernenti la {\bfseries dimensione di Hausdorff} (una generalizzazione dell'ordinaria dimensione di uno spazio euclideo adeguata a descrivere oggetti ``frattali'') e le {\bfseries proprietà fini} delle funzioni reali.

Ma è nell'ultimo capitolo che gli strumenti sviluppati, ed in particolare le misure di Hausdorff, trovano una più cospicua applicazione, vale a dire le {\bfseries formule di area e coarea} nel caso di mappe Lipschitz di $\RR^n$ in $\RR^m$. La dimostrazione di queste fondamentali formule, per le quali si rimanda a \cite{federer}, \cite{evans}, \cite{fusco}, è stata omessa per brevità; attraverso numerosi corollari ed esempi mostriamo tuttavia come, a partire da esse, sia possibile ritrovare, in una forma più generale, i risultati classici di geometria delle curve e delle superfici. 

%%%%%%%%%%%%%%%%%%
% capitolo primo %
%%%%%%%%%%%%%%%%%%

\chapter[Misure di Radon]{Misure di Radon su $\RR^n$}
% Ricordarsi di modificare manualmente il file `tesi.toc' per inserire il titolo completo del capitolo;
% questo ``hack'' è necessario altrimenti nell'intestazione del capitolo compare ``MISURE DI RADON SU \RR^N'',
% con l'esponente maiuscolo.

\section{Misure su un insieme}

Questo capitolo è principalmente una ricapitolazione della teoria standard della misura, con particolare enfasi rivolta alle misure di Radon su $\RR^n$. Anche se intendiamo lavorare quasi esclusivamente in $\RR^n$, è conveniente cominciare in modo astratto.

\begin{notazione}
Denotiamo con $X$ un insieme e con $2^X$ la famiglia dei sottoinsiemi di $X$.
\end{notazione}

\begin{definizione}
\label{def:misura}
Un'applicazione $\mu: 2^X \rightarrow [0,\, \infty]$ si dice una \emph{misura}\index{misura} su $X$ se
\begin{itemize}
\item[(i)] $\mu(\emptyset) = 0$, e
\item[(ii)] $\mu(A) \le \sum_{k=1}^{\infty} \mu(A_k)$ ogni volta che $A \subset \bigcup_{k=1}^{\infty} A_k$ (\emph{subadditività numerabile}).
\end{itemize}
\end{definizione}

\begin{osservazione}
La maggior parte degli autori chiama una siffatta applicazione $\mu$ una misura \emph{esterna}, riservando il nome \emph{misura} per $\mu$ ristretta alla famiglia dei sottoinsiemi $\mu$-misurabili (\emph{cfr.}~(\ref{def:insieme_misurabile})). Vedremo, però, che sussistono indubbi vantaggi nel poter ``misurare'' anche insiemi non misurabili.
\end{osservazione}

\begin{lemma}
Sia $\mu$ una misura su $X$.
\begin{itemize}
\item[(i)] \emph{Monotonia.} Se $A \subset B \subset X$, allora $\mu(A) \le \mu(B)$.
\item[(ii)] \emph{Subadditività finita.} $\mu(A \cup B) \le \mu(A) + \mu(B)$ per ogni $A,\, B \subset X$.
\item[(iii)] $\mu(B) \le \mu(B - A) + \mu(B \cap A)$ per ogni $A,\, B \subset X$.
\end{itemize}
\end{lemma}

\begin{proof}
\begin{proofsec}
Si ponga $B_1 = B$ e $B_k = \emptyset$ per $k > 1$. Allora $A \subset \bigcup_{k=1}^\infty B_k$, sicché $\mu(A) \le \sum_{k=1}^\infty \mu(B_k) = \mu(B)$. Questo prova la (i).
\end{proofsec}

\begin{proofsec}
Per dimostrare la (ii), si ponga $C_1 = A,\, C_2 = B$ e $C_k = \emptyset$ per $k > 2$. Allora $A \cup B \subset \bigcup_{k=1}^\infty C_k$, sicché $\mu(A \cup B) \le \sum_{k=1}^\infty \mu(C_k) = \mu(A) + \mu(B)$.
\end{proofsec}

\begin{proofsec}
La (iii) segue subito dalla (ii), purché si osservi che $B = (B - A) \cup (B \cap A)$.\qed
\end{proofsec}
\end{proof}

\begin{definizione}
\label{def:misura_ristretta}
\index{restrizione!di una misura}
Sia $\mu$ una misura su $X$ e sia $A \subset X$; poniamo
\[
(\mu \restr A)(B) \equiv \mu(A \cap B)\qquad\text{ per ogni $B \subset X$. }
\]
Si verifica subito che $\mu \restr A$, al pari di $\mu$, è una misura su $X$; la chiameremo \emph{$\mu$ ristretta ad $A$}\index{misura!ristretta a un sottoinsieme}.
\end{definizione}

\begin{definizione}
\label{def:insieme_misurabile}
Un insieme $A \subset X$ è \emph{$\mu$-misurabile}\index{insieme!misurabile} se
\[
\mu(B) = \mu(B \cap A) + \mu(B - A)
\]
per ogni insieme $B \subset X$.
\end{definizione}

\begin{osservazione}
Avendosi, per ogni $A,\, B \subset X$,
\[
\mu(B) \le \mu(B \cap A) + \mu(B - A),
\]
per provare che un insieme $A$ è $\mu$-misurabile è sufficiente dimostrare che vale la disuguaglianza opposta.
\end{osservazione}

\begin{lemma}
\label{lem:proprieta_elementari_insiemi_misurabili}
\index{proprietà!degli insiemi misurabili}
\mbox{}
\begin{itemize}
\item[(i)] Se $\mu(A) = 0$, allora $A$ è $\mu$-misurabile.
\item[(ii)] $A$ è $\mu$-misurabile se e solo se $X - A$ è $\mu$-misurabile.
\item[(iii)] Se $A$ è un qualunque sottoinsieme di $X$, allora ogni insieme $\mu$-misurabile è anche $(\mu \restr A)$-misurabile.
\end{itemize}
\end{lemma}

\begin{proof}
\begin{proofsec}
Sia $\mu(A) = 0$. Allora per ogni insieme $B \subset X$
\[
\mu(B \cap A) + \mu(B - A) \le \mu(A) + \mu(B) = \mu(B).
\]
Pertanto $A$ è $\mu$-misurabile.
\end{proofsec}

\begin{proofsec}
Per dimostrare la (ii) basta osservare che per ogni $B \subset X$
\[
B \cap (X - A) = B - A,\qquad B - (X - A) = B \cap A,
\]
sicché
\[
\mu\Big(B \cap (X - A)\Big) + \mu\Big(B - (X - A)\Big) = \mu(B - A) + \mu(B \cap A).
\]
\end{proofsec}

\begin{proofsec}
Sia infine $B \subset X$ $\mu$-misurabile. Allora per ogni $C \subset X$ si ha
\[
\mu(A \cap C) = \mu\Big((A \cap C) \cap B\Big) + \mu\Big((A \cap C) - B\Big) = \mu\Big(A \cap (C \cap B)\Big) + \mu\Big(A \cap (C - B)\Big),
\]
cioè
\[
(\mu \restr A)(C) = (\mu \restr A)(C \cap B) + (\mu \restr A)(C - B).
\]
Per l'arbitrarietà di $C \subset X$, $B$ è $(\mu \restr A)$-misurabile, e la (iii) è provata.\qed
\end{proofsec}
\end{proof}
\pagebreak

\begin{teorema}[Proprietà degli insiemi misurabili]
\label{thm:proprieta_insiemi_misurabili}
\index{proprietà!degli insiemi misurabili}
\index{successione!di insiemi misurabili} 
Sia $\{A_k\}_{k=1}^{\infty}$ una successione di insiemi $\mu$-misurabili.
\begin{itemize}
\item[(i)] Gli insiemi $\bigcup_{k=1}^{\infty} A_k$ e $\bigcap_{k=1}^{\infty} A_k$ sono $\mu$-misurabili.
\item[(ii)] Se gli insiemi $\{A_k\}_{k=1}^{\infty}$ sono disgiunti, allora
\[
\mu\left(\bigcup_{k=1}^{\infty} A_k\right) = \sum_{k=1}^{\infty} A_k.
\]
\item[(iii)] Se $A_1 \subset \ldots \subset A_k \subset A_{k+1} \subset \ldots$ allora
\[
\lim_{k \to \infty} \mu(A_k) = \mu\left(\bigcup_{k=1}^{\infty} A_k\right).
\]
\item[(iv)] Se $A_1 \supset \ldots \supset A_k \supset A_{k+1} \supset \ldots$ e $\mu(A_1) < \infty$, allora
\[
\lim_{k \to \infty} \mu(A_k) = \mu\left(\bigcap_{k=1}^{\infty} A_k\right).
\]
\end{itemize}
\end{teorema}

\begin{proof}
\begin{proofsec}
Siano $A_1,\, A_2 \subset X$ $\mu$-misurabili. Allora, per ogni insieme $B \subset X$, risulta 
\begin{align*}
\mu(B) &= \mu(B \cap A_1) + \mu(B - A_1) = \mu(B \cap A_1) + \mu((B - A_1) \cap A_2) + \mu((B - A_1) - A_2)\\
&\ge \mu(B \cap (A_1 \cup A_2)) + \mu(B - (A_1 \cup A_2)),
\end{align*}
in quanto
\[
(B \cap A_1) \cup ((B - A_1) \cap A_2) = B \cap (A_1 \cup A_2)
\]
e
\[
(B - A_1) - A_2 = B - (A_1 \cup A_2).
\]
Pertanto $A_1 \cup A_2$ è $\mu$-misurabile. Per induzione, un'unione \emph{finita} di insiemi $\mu$-misurabili è $\mu$-misurabile.
\end{proofsec}

\begin{proofsec}
Avendosi
\[
X - (A_1 \cap A_2) = (X - A_1) \cup (X - A_2),
\]
l'intersezione di due insiemi $\mu$-misurabili è $\mu$-misurabile, e quindi per induzione tale è anche ogni intersezione \emph{finita} di insiemi $\mu$-misurabili.
\end{proofsec}

\begin{proofsec}
Supponiamo ora che gli insiemi $\{A_k\}_{k=1}^\infty$ siano disgiunti, e scriviamo \mymath{B_j \equiv \bigcup_{k=1}^j A_k.}{(j = 1, 2, \ldots)}
Allora, essendo $A_{j+1}$ $\mu$-misurabile per ogni $j$, \mymath{\mu(B_{j+1}) = \mu(B_{j+1} \cap A_{j+1}) + \mu(B_{j+1} - A_{j+1}) = \mu(A_{j+1}) + \mu(B_j),}{(j = 1, 2, \ldots)} sicché per induzione \mymath{\mu\left(\bigcup_{k=1}^{j+1} A_k\right) = \sum_{k=1}^{j+1} \mu(A_k).}{(j = 1, 2, \ldots)} Avendosi, per ogni $j$,
\[
\bigcup_{k=1}^{j+1} A_k \subset \bigcup_{k=1}^\infty A_k,
\]
\mymath{\sum_{k=1}^{j+1} \mu(A_k) = \mu\left(\bigcup_{k=1}^{j+1} A_k\right) \le \mu\left(\bigcup_{k=1}^\infty A_k\right),}{(j = 1, 2, \ldots)} e passando al limite per $j \to \infty$
\[
\sum_{k=1}^\infty \mu(A_k) \le \mu\left(\bigcup_{k=1}^\infty A_k\right).
\]
Dal momento che la disuguaglianza opposta vale per definizione, la (ii) è dimostrata.
\end{proofsec}

\begin{proofsec}
Per provare la (iii), poniamo $B_1 = A_1$ e $B_k = A_k - A_{k-1}$ per $k > 1$, sicché gli insiemi $\{B_k\}_{k=1}^\infty$ sono disgiunti e
\[
\bigcup_{k=1}^\infty A_k = \bigcup_{k=1}^\infty B_k.
\]
Per la (ii) si ha allora
\[
\sum_{k=1}^\infty \mu(B_k) = \mu\left(\bigcup_{k=1}^\infty A_k\right).
\]
Ma
\begin{align*}
\mu(A_1) &= \mu(B_1),\\
\mu(A_2) &= \mu(A_2 \cap A_1) + \mu(A_2 - A_1) = \mu(A_1) + \mu(B_2) = \mu(B_1) + \mu(B_2),\\
\mu(A_3) &= \mu(A_3 \cap A_2) + \mu(A_3 - A_2) = \mu(A_2) + \mu(B_3) = \mu(B_1) + \mu(B_2) + \mu(B_3),\\
&\:\:\,\vdots\\
\mu(A_{k+1}) &= \mu(A_{k+1} \cap A_k) + \mu(A_{k+1} - A_k) = \mu(A_k) + \mu(B_{k+1}) = \mu(B_1) + \mu(B_2) + \ldots + \mu(B_k) + \mu(B_{k+1})
\end{align*}
e così via. Pertanto
\[
\lim_{k \to \infty} \mu(A_k) = \sum_{k=1}^\infty \mu(B_k) = \mu\left(\bigcup_{k=1}^\infty A_k\right).
\]
\end{proofsec}

\begin{proofsec}
Per dimostrare la (iv), osserviamo che per ogni $k$ da
\[
\mu(A_1) = \mu(A_1 \cap A_k) + \mu(A_1 - A_k) = \mu(A_k) + \mu(A_1 - A_k)
\]
segue, avendosi $\mu(A_k) \le \mu(A_1) < \infty$,
\[
\mu(A_1) - \mu(A_k) = \mu(A_1 - A_k),
\]
sicché
\[
\mu(A_1) - \lim_{k \to \infty} \mu(A_k) = \lim_{k \to \infty} \mu(A_1 - A_k).
\]
D'altra parte, essendo $A_k \supset A_{k+1}$ per ogni $k$, si ha $A_1 - A_k \subset A_1 - A_{k+1}$ per ogni $k$, e dalla (iii) segue
\[
\lim_{k \to \infty} \mu(A_1 - A_k) = \mu\left(\bigcup_{k=1}^\infty (A_1 - A_k)\right);
\]
quindi
\[
\mu(A_1) - \lim_{k \to \infty} \mu(A_k) = \lim_{k \to \infty} \mu(A_1 - A_k) = \mu\left(\bigcup_{k=1}^\infty (A_1 - A_k)\right).
\]
Ma
\[
\mu(A_1) \le \mu\left(A_1 \cap \bigcap_{k=1}^\infty A_k\right) + \mu\left(A_1 - \bigcap_{k=1}^\infty A_k\right) \le \mu\left(\bigcap_{k=1}^\infty A_k\right) + \mu\left(\bigcup_{k=1}^\infty (A_1 - A_k)\right),
\]
da cui, tenendo presente che $\mu\left(\bigcap_{k=1}^\infty A_k\right) \le \mu(A_1) < \infty$,
\[
\mu\left(\bigcup_{k=1}^\infty (A_1 - A_k)\right) \ge \mu(A_1) - \mu\left(\bigcap_{k=1}^\infty A_k\right);
\]
ricapitolando,
\[
\mu(A_1) - \lim_{k \to \infty} \mu(A_k) = \lim_{k \to \infty} \mu(A_1 - A_k) = \mu\left(\bigcup_{k=1}^\infty (A_1 - A_k)\right) \ge \mu(A_1) - \mu\left(\bigcap_{k=1}^\infty A_k\right).
\]
Sottraendo $\mu(A_1) < \infty$ dal primo e dall'ultimo membro otteniamo
\[
\lim_{k \to \infty} \mu(A_k) \le \mu\left(\bigcap_{k=1}^\infty A_k\right).
\]
La disuguaglianza opposta è immediata per la proprietà di monotonia; la (iv) resta così dimostrata.
\end{proofsec}

\begin{proofsec}
Dobbiamo infine provare la (i). Si noti in primo luogo che se $B$ è un sottoinsieme di $X$ con $\mu(B) = \infty$, allora
\[
\infty = \mu(B) \le \mu\left(B \cap \bigcup_{k=1}^\infty A_k\right) + \mu\left(B - \bigcup_{k=1}^\infty A_k\right),
\]
sicché
\[
\mu\left(B \cap \bigcup_{k=1}^\infty A_k\right) + \mu\left(B - \bigcup_{k=1}^\infty A_k\right) = \mu(B).
\]
Per dimostrare questa uguaglianza anche nel caso $\mu(B) < \infty$, ricordiamo da (\ref{lem:proprieta_elementari_insiemi_misurabili}) che ogni insieme $\mu$-misurabile è anche $(\mu \restr B)$-misurabile. Dal momento che per la (a) ogni $B_j \equiv \bigcup_{k=1}^j A_k$ è $\mu$-misurabile, e inoltre
\begin{gather*}
B_1 \subset \ldots \subset B_k \subset B_{k+1} \subset \ldots,\\
X - B_1 \supset \ldots \supset X - B_k \supset X - B_{k+1} \supset \ldots,\qquad (\mu\restr B)(X - B_1) \le \mu(B) < \infty,
\end{gather*}
applicando la (iii) e la (iv) possiamo scrivere
\begin{align*}
(\mu \restr B) \left(\bigcup_{k=1}^\infty B_k\right) &+ (\mu \restr B) \left(\bigcap_{k=1}^\infty (X - B_k)\right) = \lim_{k \to \infty} (\mu \restr B) (B_k) + \lim_{k \to \infty} (\mu \restr B) (X - B_k)\\
&= \lim_{k \to \infty} \Big((\mu \restr B) (X \cap B_k) + (\mu \restr B) (X - B_k)\Big) = (\mu \restr B) (X) = \mu(B \cap X) = \mu(B).
\end{align*}
Ma
\[
\bigcup_{k=1}^\infty B_k = \bigcup_{k=1}^\infty A_k
\]
e
\[
\bigcap_{k=1}^\infty (X - B_k) = X - \bigcup_{k=1}^\infty B_k = X - \bigcup_{k=1}^\infty A_k,
\]
sicché
\begin{align*}
\mu\left(B \cap \bigcup_{k=1}^\infty A_k\right) + \mu\left(B - \bigcup_{k=1}^\infty A_k\right) &= (\mu \restr B) \left(\bigcup_{k=1}^\infty A_k\right) + (\mu \restr B) \left(X - \bigcup_{k=1}^\infty A_k\right)\\
&= (\mu \restr B) \left(\bigcup_{k=1}^\infty B_k\right) + (\mu \restr B) \left(\bigcap_{k=1}^\infty (X - B_k)\right) = \mu(B).
\end{align*}
Pertanto
\[
\mu\left(B \cap \bigcup_{k=1}^\infty A_k\right) + \mu\left(B - \bigcup_{k=1}^\infty A_k\right) = \mu(B)
\]
qualunque sia $B \subset X$, ossia $\bigcup_{k=1}^\infty A_k$ è $\mu$-misurabile. Tale è poi anche $\bigcap_{k=1}^\infty A_k$, in quanto
\[
X - \bigcap_{k=1}^\infty A_k = \bigcup_{k=1}^\infty (X - A_k).
\]
Questo prova la (i), e completa la dimostrazione del teorema.\qed
\end{proofsec}
\end{proof}

\begin{definizione}
\label{def:sigma_algebra}
Una famiglia di sottoinsiemi $\AA \subset 2^X$ è una \emph{$\sigma$-algebra}\index{$\sigma$-algebra} su $X$ se
\begin{itemize}
\item[(i)] $\emptyset,\, X \in \AA$;
\item[(ii)] $A \in \AA$ implica $X - A \in \AA$;
\item[(iii)] $\bigcup_{k=1}^\infty A_k \in \AA$ per ogni successione $\{A_k\}_{k=1}^\infty$ in $\AA$.
\end{itemize}
\end{definizione}

\begin{osservazione}
La famiglia di tutti i sottoinsiemi $\mu$-misurabili di $X$ forma una $\sigma$-algebra, che denoteremo con $\MM(X,\, \mu)$.
\end{osservazione}

\begin{lemma}
\label{pro:proprieta_sigma_algebra}
\index{proprietà!di una $\sigma$-algebra}
Siano $X$ un insieme, $\AA$ una $\sigma$-algebra su $X$. Allora:
\begin{itemize}
\item[(i)] $A \cup B \in \AA$ e $A \cap B \in \AA$ per ogni $A,\, B \in \AA$;
\item[(ii)] $A - B \in \AA$ per ogni $A,\, B \in \AA$;
\item[(iii)] se $\{A_k\}_{k=1}^\infty$ è una successione in $\AA$, $\bigcap_{k=1}^\infty A_k \in \AA$.
\end{itemize}
\end{lemma}
\pagebreak

\begin{definizioni}
Siano $X$ un insieme, $\mu$ una misura su $X$. Allora:
\mbox{}
\begin{itemize}
\item[(i)] $\mu$ si dice \emph{finita}\index{misura!finita} se $\mu(X) < \infty$;
\item[(i)] un sottoinsieme $A \subset X$ si dice \emph{$\sigma$-finito} rispetto a $\mu$\index{insieme!$\sigma$-finito} se possiamo scrivere $A = \bigcup_{k=1}^\infty B_k$, dove $B_k \subset X$ è $\mu$-misurabile e $\mu(B_k) < \infty$ per $k = 1, 2, \ldots$;
\item[(iii)] $\mu$ si dice \emph{$\sigma$-finita}\index{misura!$\sigma$-finita} se $X$ è $\sigma$-finito rispetto a $\mu$.
\end{itemize}
\end{definizioni}

\begin{osservazione}
Se $A \subset X$ è $\sigma$-finito rispetto a $\mu$, possiamo scrivere $A = \bigcup_{k=1}^\infty B_k$, dove $\{B_k\}_{k=1}^\infty$ è una successione \emph{disgiunta} di insiemi $\mu$-misurabili con $\mu(B_k) < \infty$ per $k = 1, 2, \ldots$
\end{osservazione}

\begin{esempio}
\label{ex:misura_che_conta}
Sia $X$ un insieme, e definiamo un'applicazione $\mu_0 : 2^X \rightarrow [0,\, \infty]$ ponendo
\[
\mu_0(A) \equiv \begin{cases}
\Card(A) & \text{se $A$ è finito,}\\
\infty & \text{altrimenti.}
\end{cases}
\]
Si verifica subito che $\mu_0$ è una misura $\sigma$-finita su $X$ e che ogni $A \subset X$ è $\mu_0$-misurabile; $\mu_0$ dicesi la \emph{misura che conta i punti}\index{misura!che conta i punti}.
\end{esempio}

\begin{definizione}
\label{def:misure_regolari}
Una misura $\mu$ su un insieme $X$ è \emph{regolare}\index{misura!regolare} se per ogni insieme $A \subset X$ esiste un insieme $\mu$ -misurabile $B \subset X$ tale che $A \subset B$ e $\mu(A) = \mu(B)$.
\end{definizione}

\begin{teorema}
\label{thm:proprieta_misure_regolari}
\index{proprietà!di una misura regolare}
\index{successione!di insiemi misurabili} 
Sia $\mu$ una misura regolare su $X$. Se
\[
A_1 \subset \ldots \subset A_k \subset A_{k+1} \subset \ldots
\]
allora
\[
\lim_{k \to \infty} \mu(A_k) = \mu\left(\bigcup_{k=1}^\infty A_k\right).
\]
(Gli insiemi $\{A_k\}_{k=1}^\infty$ possono non essere $\mu$-misurabili; si confronti con (\ref{thm:proprieta_insiemi_misurabili}).)
\end{teorema}

\begin{proof}
Essendo $\mu$ regolare, esistono insiemi $\mu$-misurabili $\{C_k\}_{k=1}^\infty$, con $A_k \subset C_k$ e $\mu(A_k) = \mu(C_k)$ per ogni $k$. Si ponga $B_k \equiv \bigcap_{j \ge k} C_j$. Allora
\[
A_k = \bigcap_{j \ge k} A_j \subset \bigcap_{j \ge k} C_j = B_k,
\]
ogni $B_k$ è $\mu$-misurabile, e
\[
\mu(A_k) \le \mu(B_k) \le \mu(C_k) = \mu(A_k)
\]
da cui $\mu(A_k) = \mu(B_k)$ $(k = 1, 2, \ldots)$. Inoltre $\{B_k\}_{k=1}^\infty$ è una successione crescente sicché, per (\ref{thm:proprieta_insiemi_misurabili}), 
\[
\lim_{k \to \infty} \mu(A_k) = \lim_{k \to \infty} \mu(B_k) = \mu\left(\bigcup_{k=1}^\infty B_k\right) \ge \mu\left(\bigcup_{k=1}^\infty A_k\right).
\]
La disuguaglianza opposta
\[
\lim_{k \to \infty} \mu(A_k) \le \mu\left(\bigcup_{j=1}^\infty A_j\right)
\]
consegue dall'essere $A_k \subset \bigcup_{j=1}^\infty A_j$ $(k = 1, 2, \ldots)$.\qed
\end{proof}

\section{Misure su $\RR^n$}

\subsection{Boreliani. Misure di Borel. Misure di Radon}

\begin{lemma}
\label{pro:sigma_algebra_generata}
Siano $X$ un insieme ed $\FF$ una famiglia di parti di $X$. Esiste allora la più piccola $\sigma$-algebra $\AA^\star$ su $X$ contenente $\FF$. (Diremo che $\AA^\star$ è \emph{generata} da $\FF$\index{$\sigma$-algebra!generata da una famiglia di insiemi}, o che $\FF$ \emph{genera} $\AA^\star$.)
\end{lemma}

\begin{proof}
Sia
\[
\ZZZ \equiv \Set{ \AA | \text{$\AA$ è una $\sigma$-algebra su $X$, $\FF \subset \AA$} }.
\]
Banalmente, $2^X \in \ZZZ$ sicché $\ZZZ \ne \emptyset$. Poniamo
\[
\AA^\star \equiv \bigcap_{\AA \in \ZZZ} \AA;
\]
è chiaro che $\FF \subset \AA^\star$ e che $\AA^\star \subset \AA$, per ogni $\sigma$-algebra $\AA$ su $X$ contenente $\FF$. Per completare la dimostrazione, occorre far vedere che $\AA^\star$ è una $\sigma$-algebra su $X$; ma questo è immediato.\qed
\end{proof}
 
\begin{definizione}
\label{def:sigma_algebra_borel}
Sia $X$ uno spazio topologico. La \emph{$\sigma$-algebra di Borel} $\BB(X)$ di $X$\index{$\sigma$-algebra!di Borel} è la più piccola $\sigma$-algebra su $X$ contenente gli aperti di $X$, o, ciò che è lo stesso, è la $\sigma$-algebra generata dalla topologia di $X$. Gli elementi di $\BB(X)$ si dicono \emph{insiemi di Borel}\index{insieme!di Borel} o \emph{boreliani}\index{boreliano}.
\end{definizione}

\begin{osservazione}
\label{oss:sigma_algebra_borel_est_generata_dai_chiusi}
La $\sigma$-algebra di Borel $\BB(X)$ è generata dai chiusi. E invero, è sufficiente osservare che ogni $\sigma$-algebra $\AA$ su $X$ contiene gli aperti se e solo se contiene i chiusi.
\end{osservazione}

\begin{definizioni}
\label{def:misure_di_borel_e_di_radon}
Sia $X$ uno spazio topologico.
\begin{itemize}
\item[(i)] Una misura $\mu$ su $X$ si dice \emph{di Borel}\index{misura!di Borel} se ogni boreliano $B \subset X$ è $\mu$-misurabile.
\item[(ii)] Una misura $\mu$ su $X$ è \emph{Borel regolare}\index{misura!Borel regolare} se $\mu$ è di Borel e per ogni $A \subset X$ esiste un boreliano $B \subset X$ tale che $A \subset B$ e $\mu(A) = \mu(B)$.
\item[(iii)] Una misura $\mu$ su $X$ è una \emph{misura di Radon}\index{misura!di Radon} se $\mu$ è Borel regolare e $\mu(K) < \infty$ per ogni compatto $K \subset X$.
\end{itemize}
\end{definizioni}

\begin{osservazioni}
Una misura Borel regolare è anche regolare; una misura di Radon su $\RR^n$ è $\sigma$-finita.
\end{osservazioni}

\begin{teorema}
\label{thm:restrizione_misura_borel_regolare}
\index{restrizione!di una misura Borel regolare}
Sia $\mu$ una misura Borel regolare su uno spazio topologico $X$, e sia $A \subset X$. Supponiamo che
\begin{itemize}
\item[(i)] $A$ sia $\mu$-misurabile e $\mu(A) < \infty$, oppure che
\item[(ii)] $A$ sia un boreliano.
\end{itemize}
Allora $\mu \restr A$ è una misura Borel regolare.
\end{teorema}

\begin{proof}
\begin{proofsec}
Supponiamo che valga la (i). Siccome $\mu$ è Borel regolare, esiste un boreliano $B \subset X$ tale che $A \subset B$ e $\mu(B) = \mu(A) < \infty$. Allora, essendo $A$ $\mu$-misurabile,
\[
\mu(B - A) = \mu(B) - \mu(A) = 0.
\]
Scegliamo $C \subset X$. Allora
\begin{align*}
(\mu \restr B) (C) &= \mu(C \cap B) = \mu((C \cap B) \cap A) + \mu((C \cap B) - A)\\
&\le \mu(C \cap A) + \mu(B - A) = \mu(C \cap A) = (\mu \restr A) (C),
\end{align*}
e inoltre, avendosi $A \subset B$, vale anche la disuguaglianza opposta. Pertanto, per l'arbitrarietà di $C \subset X$, $\mu \restr B = \mu \restr A$; possiamo allora assumere che $A$ sia un boreliano, ossia che valga la (ii).
\end{proofsec}

\begin{proofsec}
Poniamo $\nu \equiv \mu \restr A$. Siccome ogni insieme $\mu$-misurabile è anche $\nu$-misurabile e $\mu$ è di Borel, tale è anche $\nu$.
\end{proofsec}

\begin{proofsec}
Ci resta da dimostrare che $\nu$ è Borel regolare. A tale scopo, scegliamo $C \subset X$. Dobbiamo far vedere che esiste un boreliano $D$ tale che $C \subset D$ e $\nu(C) = \nu(D)$. Siccome $\mu$ è una misura Borel regolare, esiste un boreliano $E$ tale che $A \cap C \subset E$ e $\mu(E) = \mu(A \cap C)$. Sia $D \equiv E \cup (X - A)$. Essendo $A$ ed $E$ boreliani, tale è $D$. Inoltre,
\[
C = (C \cap A) \cup (C - A) \subset (C \cap A) \cup (X - A) \subset E \cup (X - A) = D.
\]
Infine
\[
\nu(D) = \mu(D \cap A) = \mu(E \cap A) \le \mu(E) = \mu(A \cap C) = \nu(C),
\]
dal momento che $D \cap A = E \cap A$.\qed
\end{proofsec}
\end{proof}

\begin{corollario}
\label{cor:restrizione_misura_borel_regolare}
Sia $\mu$ una misura Borel regolare su $X$. Supponiamo che $A$ sia $\mu$-misurabile e che $\mu(A) < \infty$. Allora $\mu \restr A$ è una misura di Radon.
\end{corollario}

\begin{proof}
Per il teorema, $\nu \equiv \mu \restr A$ è una misura Borel regolare; inoltre $\nu(K) \le \mu(A) < \infty$ per ogni compatto $K \subset X$, sicché $\nu$ è di Radon.\qed
\end{proof}

\begin{notazione}
Siano $\mu$, $\nu$ misure su un insieme $X$. Scriveremo
\[
\mu \le \nu
\]
se $\mu(A) \le \nu(A)$ per ogni insieme $A \subset X$.
\end{notazione}

\begin{teorema}
\label{thm:limite_di_misure}
\index{successione!di misure}
\index{limite!di misure}
Sia $\{\mu_k\}_{k=1}^\infty$ una successione di misure su un insieme $X$ tale che
\[
\mu_1 \le \ldots \le \mu_k \le \mu_{k+1} \le \ldots
\]
Posto
\[
\mu \equiv \lim_{k \to \infty} \mu_k,
\]
risulta:
\begin{itemize}
\item[(i)] $\mu$ è una misura su $X$;
\item[(ii)] se $X$ è uno spazio topologico e ogni $\mu_k$ è di Borel, tale è $\mu$;
\item[(iii)] se $X$ è uno spazio topologico e ogni $\mu_k$ è Borel regolare, tale è $\mu$.
\end{itemize}
\end{teorema}

\begin{proof}
\begin{proofsec}
Ovviamente $\mu(\emptyset) = \lim_{k \to \infty} \mu_k(\emptyset) = 0$. Siano $A,\, \{A_j\}_{j=1}^\infty \subset X$ insiemi tali che $A \subset \bigcup_{j=1}^\infty A_j$; allora per ogni $k$ risulta 
\[
\mu_k(A) \le \sum_{j=1}^\infty \mu_k(A_j) \le \sum_{j=1}^\infty \mu(A_j),
\]
e quindi, passando al limite per $k \to \infty$,
\[
\mu(A) \le \sum_{j=1}^\infty \mu(A_j).
\]
Quindi $\mu$ è una misura su $X$, e la (i) è provata. 
\end{proofsec}

\begin{proofsec}
Dimostriamo ora la (ii). Siano $B \subset X$ un boreliano, $C \subset X$ un insieme arbitrario. Allora, per ogni intero positivo $k$, risulta
\[
\mu_k(C) = \mu_k(C \cap B) + \mu_k(C - B),
\]
sicché passando al limite per $k \to \infty$ otteniamo
\[
\mu(C) = \mu(C \cap B) + \mu(C - B),
\]
ossia $B$ è $\mu$-misurabile. Per l'arbitrarietà di $B$, $\mu$ è di Borel.
\end{proofsec}

\begin{proofsec}
Proviamo infine la (iii). Sia $A \subset X$ un insieme arbitrario, e scegliamo per ogni $k$ un boreliano $B_k \subset X$ tale che $A \subset B_k$ e che $\mu_k(B_k) = \mu_k(A)$. Poniamo $B \equiv \bigcap_{k=1}^\infty B_k$; $B$ è un boreliano, $A \subset B$, e inoltre per ogni $k$ risulta 
\[
\mu_k(A) \le \mu_k(B) \le \mu_k(B_k) = \mu_k(A),
\]
ossia
\[
\mu_k(B) = \mu_k(A).
\]
L'asserto si ottiene per $k \to \infty$.\qed
\end{proofsec}
\end{proof}

\subsection{Approssimazione per mezzo di aperti e di compatti}

Consideriamo ora la possibilità di approssimare un insieme arbitrario, nel senso della misura, per mezzo di aperti, chiusi o compatti.

\begin{teorema}
\label{lem:approssimazione_con_aperti_e_compatti}
\index{approssimazione!di un insieme}
Sia $\mu$ una misura di Borel su $\RR^n$ e sia $B \subset \RR^n$ un boreliano.
\begin{itemize}
\item[(i)] Se $\mu(B) < \infty$, esiste per ogni $\epsilon > 0$ un chiuso $C$ tale che $C \subset B$ e $\mu(B - C) < \epsilon$.
\item[(ii)] Se $\mu$ è una misura di Radon, esiste per ogni $\epsilon > 0$ un aperto $U$ tale che $B \subset U$ e $\mu(U - B) < \epsilon$.
\end{itemize}
\end{teorema}

\begin{proof}
\begin{proofsec}
Sia $\nu \equiv \mu \restr B$. Essendo $\mu$ di Borel ed essendo $\mu(B) < \infty$, $\nu$ è una misura di Borel finita. Sia
\[
\FF \equiv \Set{ A \subset \RR^n | \text{$A$ è $\mu$-misurabile e per ogni $\epsilon > 0$ esiste un chiuso $C \subset A$ tale che $\nu(A - C) < \epsilon$} }.
\]
Banalmente, $\FF$ contiene tutti i chiusi.
\end{proofsec}

\begin{proofsec}
\emph{Se $\{A_i\}_{i=1}^\infty$ è una successione in $\FF$, allora $A \equiv \bigcap_{i=1}^\infty A_i \in \FF$.}\hspace{.5em} Si fissi $\epsilon > 0$. Avendosi $A_i \in \FF$, esiste per ogni $i$ un chiuso $C_i \subset A_i$ con $\nu(A_i - C_i) < \epsilon/2^i$. Sia $C \equiv \bigcap_{i=1}^\infty C_i$. Allora $C$ è chiuso, e inoltre
\[
\nu(A - C) = \nu\left(\bigcap_{i=1}^\infty A_i - \bigcap_{i=1}^\infty C_i\right) \le \nu\left(\bigcup_{i=1}^\infty (A_i - C_i)\right)\le \sum_{i=1}^\infty \nu(A_i - C_i) < \sum_{i=1}^\infty \frac{\epsilon}{2^i} = \epsilon.
\]
Pertanto $A \in \FF$.
\end{proofsec}

\begin{proofsec}
\emph{Se $\{A_i\}_{i=1}^\infty$ è una successione in $\FF$, allora $A \equiv \bigcup_{i=1}^\infty A_i \in \FF$.}\hspace{.5em} Si fissi $\epsilon > 0$ e si scelga $C_i$ $(i = 1, 2, \ldots)$ come nella (b). Si ponga poi, per ogni intero positivo $m$, $D_m \equiv \bigcup_{i=1}^m C_i$. Allora, avendosi $\nu(A) < \infty$, risulta
\[
\lim_{m \to \infty} \nu(A - D_m) = \nu\left(\bigcap_{m=1}^\infty (A - D_m)\right) = \nu\left(\bigcup_{i=1}^\infty A_i - \bigcup_{i=1}^\infty C_i\right) \le \nu\left(\bigcup_{i=1}^\infty (A_i - C_i)\right) \le \sum_{i=1}^\infty \nu(A_i - C_i) < \epsilon.
\]
Per conseguenza, esiste un intero $m$ tale che
\[
\nu(A - D_m) < \epsilon.
\]
Ma $D_m$ è chiuso, in quanto unione \emph{finita} di chiusi, onde $A \in \FF$.
\end{proofsec}

\begin{proofsec}
Ora, siccome ogni aperto di $\RR^n$ può scriversi come unione numerabile di chiusi, la (c) mostra che $\FF$ contiene tutti gli aperti. Ora si consideri
\[
\GG \equiv \Set{ A \in \FF | \RR^n - A \in \FF }.
\]
Ovviamente, $A \in \GG$ se e solo se $\RR^n - A \in \GG$. Si noti anche che $\GG$ contiene tutti gli aperti, in quanto $\FF$ contiene tutti gli aperti \emph{e} tutti i chiusi.
\end{proofsec}

\begin{proofsec}
\emph{Se $\{A_i\}_{i=1}^\infty$ è una successione in $\GG$, allora $A \equiv \bigcup_{i=1}^\infty A_i \in \GG$.}\hspace{.5em} Avendosi $\{A_i\}_{i=1}^\infty \subset \GG \subset \FF$, per la (c) $A \in \FF$. Siccome è anche $\{\RR^n - A_i\}_{i=1}^\infty \subset \FF$ per la definizione di $\GG$, la (b) implica $\RR^n - A = \bigcap_{i=1}^\infty(\RR^n - A_i) \in \FF$. Pertanto $A \in \GG$.
\end{proofsec}

\begin{proofsec}
Pertanto $\GG$ è una $\sigma$-algebra contenente gli aperti e quindi anche i boreliani. In particolare, $B \in \GG$ e pertanto dato $\epsilon > 0$ esiste un chiuso $C \subset B$ tale che
\[
\mu(B - C) = \nu(B - C) < \epsilon.
\]
Questo prova la (i).
\end{proofsec}

\begin{proofsec}
Per dimostrare la (ii), denotiamo con $U_m \equiv U(0,\, m)$, per ogni intero positivo $m$, la palla aperta di centro 0, raggio $m$. Allora $U_m - B$ è un boreliano con $\mu(U_m - B) \le \mu(\closure{U_m}) < \infty$ (essendo $\mu$ una misura di Radon), e pertanto possiamo applicare la (i) per trovare un chiuso $C_m \subset U_m - B$ tale che
\[
\mu((U_m - C_m) - B) = \mu((U_m - B) - C_m) < \frac{\epsilon}{2^m}.
\]
Sia $U \equiv \bigcup_{m=1}^\infty (U_m - C_m)$; ciascun $U_m - C_m$ è aperto sicché tale è anche la loro unione $U$. Ora da $C_m \subset U_m - B$ segue $B \subset \RR^n - C_m$, e quindi anche
\[
U_m \cap B \subset U_m \cap (\RR^n - C_m) = U_m - C_m.
\]
Conseguentemente,
\[
B = \bigcup_{m=1}^\infty (U_m \cap B) \subset \bigcup_{m=1}^\infty (U_m - C_m) = U;
\]
inoltre,
\[
\mu(U - B) = \mu\left(\left(\bigcup_{m=1}^\infty (U_m - C_m)\right) - B\right) = \mu\left(\bigcup_{m=1}^\infty ((U_m - C_m) - B)\right) \le \sum_{m=1}^\infty \mu((U_m - C_m) - B) < \sum_{m=1}^\infty \frac{\epsilon}{2^m} = \epsilon,
\]
come volevasi.\qed
\end{proofsec}
\end{proof}

\begin{lemma}
\label{lem:sup_chiusi_uguale_sup_compatti}
Sia $\mu$ una misura su $\RR^n$. Allora
\[
\sup\Set{ \mu(C) | C \subset A,\, C \text{ chiuso} } = \sup\Set{ \mu(K) | K \subset A,\, K \text{ compatto} },
\]
per ogni insieme $A \subset \RR^n$.
\end{lemma}

\begin{proof}
Per ogni intero positivo $m$, sia $B_m \equiv B(0,\, m)$ la palla chiusa di centro 0 e raggio $m$. Siano inoltre $C$ un chiuso, e $C_m \equiv C \cap B_m$. Ogni $C_m$ è chiuso e limitato, quindi compatto. Inoltre da
\[
C = \bigcup_{m=1}^\infty C_m \qquad\text{ e }\qquad C_1 \subset \ldots \subset C_m \subset C_{m+1} \subset \ldots
\]
segue
\[
\mu(C_1) \le \ldots \le \mu(C_m) \le \mu(C_{m+1}) \le \ldots
\]
e
\[
\mu(C) = \lim_{m \to \infty} \mu(C_m) = \sup_{m \ge 1} \mu(C_m).
\]
Pertanto, tenendo presente che se $C \subset A$ allora anche $C_m \subset A$ per ogni $m$, possiamo scrivere
\[
\mu(C) \le \sup\Set{ \mu(K) | K \subset A,\, K \text{ compatto} },
\]
e perciò, stante l'arbitrarietà di $C$,
\[
\sup\Set{ \mu(C) | C \subset A,\, C \text{ chiuso} } \le \sup\Set{ \mu(K) | K \subset A,\, K \text{ compatto} }.
\]
La disuguaglianza opposta è conseguenza immediata del fatto che ogni insieme compatto è anche chiuso.\qed
\end{proof}

\begin{teorema}
\label{thm:approssimazione_con_aperti_e_compatti}
\index{approssimazione!di un insieme}
Sia $\mu$ una misura di Radon su $\RR^n$. Allora
\begin{itemize}
\item[(i)] per ogni insieme $A \subset \RR^n$,
\[
\mu(A) = \inf\Set{ \mu(U) | A \subset U,\, U \text{ aperto} };
\]
\item[(ii)] per ogni insieme \emph{$\mu$-misurabile} $A \subset \RR^n$,
\[
\mu(A) = \sup\Set{ \mu(K) | K \subset A,\, K \text{ compatto} }.
\]
\end{itemize}
(Si noti che la (i) non richiede che $A$ sia $\mu$-misurabile.)
\end{teorema}

\begin{proof}
\begin{proofsec}
Banalmente,
\[
\mu(A) \le \inf\Set{ \mu(U) | A \subset U,\, U \text{ aperto} },
\]
onde se in particolare $\mu(A) = \infty$ si ha
\[
\inf\Set{ \mu(U) | A \subset U,\, U \text{ aperto} } = \infty = \mu(A).
\]
Possiamo allora supporre $\mu(A) < \infty$.
\end{proofsec}

\begin{proofsec}
Assumiamo dapprima che $A$ sia un boreliano. Si fissi $\epsilon > 0$. Allora per (\ref{lem:approssimazione_con_aperti_e_compatti}) esiste un aperto $U \supset A$ con $\mu(U - A) < \epsilon$. Siccome $\mu(A) < \infty$, $\mu(U) - \mu(A) = \mu(U - A) < \epsilon$; per l'arbitrarietà di $\epsilon$, si ha la (i) nel caso $A$ boreliano.

Ora, sia $A \subset \RR^n$ un insieme arbitrario. Essendo $\mu$ Borel regolare, esiste un boreliano $B \supset A$ con $\mu(A) = \mu(B)$. Ma allora
\[
\Set{ \mu(U) | B \subset U,\, U \text{ aperto} } \subset \Set{ \mu(U) | A \subset U,\, U \text{ aperto} },
\]
sicché
\[
\mu(A) = \mu(B) = \inf\Set{ \mu(U) | B \subset U,\, U \text{ aperto} } \ge \inf\Set{ \mu(U) | A \subset U,\, U \text{ aperto} }.
\]
L'asserto (i) è così dimostrato.
\end{proofsec}

\begin{proofsec}
Sia ora $A$ $\mu$-misurabile, con $\mu(A) < \infty$. Si ponga $\nu \equiv \mu \restr A$; $\nu$ è una misura di Radon secondo (\ref{cor:restrizione_misura_borel_regolare}). Si fissi $\epsilon > 0$. Applicando la (i) a $\nu$ e $\RR^n - A$, otteniamo un aperto $U$ con $\RR^n - A \subset U$ e
\[
\nu(U) \le \nu(\RR^n - A) + \epsilon = \epsilon.
\]
Sia $C \equiv \RR^n - U$. Allora $U$ aperto implica $C$ chiuso, e da $\RR^n - A \subset U$ segue, passando ai complementari, $C \subset A$. Inoltre
\[
\mu(A - C) = \nu(\RR^n - C) = \nu(U) \le \epsilon.
\]
Pertanto, ricordando che $\mu(C) \le \mu(A) < \infty$, otteniamo
\[
0 \le \mu(A) - \mu(C) = \mu(A - C) \le \epsilon,
\]
e quindi
\[
\mu(A) = \sup\Set{ \mu(C) | C \subset A,\, C \text{ chiuso} }.
\]
\end{proofsec}

\begin{proofsec}
Supponiamo ora che $\mu(A) = \infty$. Definiamo \mymath{D_k \equiv \Set{ x | k-1 \le \abs{x} < k }.}{(k = 1, 2, \ldots)} Allora $A = \bigcup_{k=1}^\infty (D_k \cap A)$; quindi, essendo $\{D_k \cap A\}_{k=1}^\infty$ una successione \emph{disgiunta} di insiemi $\mu$-misurabili,
\[
\infty = \mu(A) = \sum_{k=1}^\infty \mu(A \cap D_k).
\]
Ora $\mu(D_k \cap A) \le \mu(D_k) \le \mu(\closure{D_k}) < \infty$ in quanto $\mu$ è una misura di Radon, per cui, tenendo presente che ciascun $D_k \cap A$ è ovviamente $\mu$-misurabile, la (c) ci garantisce che
\[
\mu(D_k \cap A) = \sup\Set{ \mu(C) | C \subset D_k \cap A,\, C \text{ chiuso} };
\]
di conseguenza, per ogni $k$ esiste un chiuso $C_k \subset D_k \cap A$ con $\mu(C_k) \ge \mu(D_k \cap A) - 1/2^k$. Si ha allora
\mymath{\bigcup_{k=1}^m C_k \subset \bigcup_{k=1}^\infty (D_k \cap A) = A}{(m = 1, 2, \ldots)}
e
\[
\lim_{m \to \infty} \mu\left(\bigcup_{k=1}^m C_k\right) = \mu\left(\bigcup_{k=1}^\infty C_k\right) = \sum_{k=1}^\infty \mu(C_k) = \sum_{k=1}^\infty \mu(D_k \cap A) - \sum_{k=1}^\infty \frac{1}{2^k} = \infty.
\]
Ma $\bigcup_{k=1}^m C_m$ è chiuso per ogni $m$, onde, anche in questo caso,
\[
\sup\Set{ \mu(C) | C \subset A,\, C \text{ chiuso} } = \infty = \mu(A).
\]
\end{proofsec}

\begin{proofsec}
Infine, applichiamo (\ref{lem:sup_chiusi_uguale_sup_compatti}) per ottenere
\[
\mu(A) = \sup\Set{ \mu(C) | C \subset A,\, C \text{ chiuso} } = \sup\Set{ \mu(K) | K \subset A,\, K \text{ compatto} },
\]
per ogni insieme $\mu$-misurabile $A \subset \RR^n$.\qed
\end{proofsec}
\end{proof}

\subsection{Criterio di Caratheodory}

Introduciamo ora un criterio utile per verificare che una misura è di Borel.

\begin{teorema}[Criterio di Caratheodory]
\label{thm:criterio_caratheodory}
\index{criterio di Caratheodory}
Sia $\mu$ una misura su $\RR^n$. Se
\[
\mu(A \cup B) = \mu(A) + \mu(B)
\]
per tutti gli insiemi $A,\, B \subset \RR^n$ con $\dist(A,\, B) > 0$, allora $\mu$ è una misura di Borel.
\end{teorema}

\begin{proof}
\begin{proofsec}
Basterà, per (\ref{oss:sigma_algebra_borel_est_generata_dai_chiusi}), dimostrare che ogni chiuso è $\mu$-misurabile. Supponiamo allora che $C \subset \RR^n$ sia chiuso (e non vuoto); è sufficiente far vedere che risulta \mymath{\mu(A) \ge \mu(A \cap C) + \mu(A - C),}{(*)} per tutti gli insiemi $A \subset \RR^n$, dal momento che la disuguaglianza opposta segue dalla subadditività.
\end{proofsec}

\begin{proofsec}
Se $\mu(A) = \infty$, la (*) è ovvia. Assumiamo invece che $\mu(A) < \infty$. Definiamo \mymath{C_n \equiv \Set { x \in \RR^n | \dist(x,\, C) \le \frac{1}{n} }.}{(n = 1, 2, \ldots)} Se $x \in A$ e $\dist(x,\, C) \le 1/n$, allora $x \in C_n$; pertanto $\dist(A - C_n,\, A \cap C) \ge 1/n > 0$ e, per l'ipotesi, \mymath{\mu(A - C_n) + \mu(A \cap C) = \mu((A - C_n) \cup (A \cap C)) \le \mu(A).}{(**)}
\end{proofsec}

\begin{proofsec}
\emph{Risulta}
\[
\lim_{n \to \infty} \mu(A - C_n) = \mu(A - C).
\]
Si ponga, per ogni intero positivo $k$,
\[
R_k \equiv \Set{ x \in A | \frac{1}{k+1} < \dist(x,\, C) \le \frac{1}{k} }.
\]
Sia $x \in A - C$; allora $d \equiv \dist(x,\, C) > 0$ in quanto $C$ è chiuso, sicché, per ogni intero positivo $n$, o $d > 1/n$ oppure $1/(k+1) < d \le 1/k$ per qualche $k \ge n$. Nel primo caso, $x \in A - C_n$; nel secondo, $x \in R_k$. Pertanto $A - C = (A - C_n) \cup \left(\bigcup_{k=n}^\infty R_k\right)$, da cui segue
\[
\mu(A - C) \le \mu(A - C_n) + \sum_{k=n}^\infty \mu(R_k).
\]
D'altra parte, si ha banalmente $C \subset C_n$, per cui $A - C_n \subset A - C$ e \mymath{\mu(A - C_n) \le \mu(A - C).}{(n = 1, 2, \ldots)} Se possiamo provare che $\sum_{k=1}^\infty \mu(R_k) < \infty$, avremo $\lim_{n \to \infty} \sum_{k=n}^\infty \mu(R_k) = 0$ e quindi anche
\begin{align*}
\lim_{n \to \infty} \mu(A - C_n) \le \mu(A - C)
\le \lim_{n \to \infty} \mu(A - C_n) + \lim_{n \to \infty} \sum_{k=n}^\infty \mu(R_k) = \lim_{n \to \infty} \mu(A - C_n),
\end{align*}
ossia $\lim_{n \to \infty} \mu(A - C_n) = \mu(A - C)$.
\end{proofsec}

\begin{proofsec}
\emph{Si ha}
\[
\sum_{k=1}^\infty \mu(R_k) < \infty.
\]
Siano $i,\, j$ interi positivi con $j \ge i+2$, e supponiamo per assurdo $\dist(R_i,\, R_j) = 0$. Allora, per ogni $\epsilon > 0$, esistono $x \in R_i$ e $y \in R_j$ tali che $\abs{x - y} < \epsilon$; pertanto, fissato $z \in C$ tale che $\abs{y - z} = \dist(y,\, C)$\linebreak ($z$ esiste in quanto $C$ è chiuso), risulta
\[
\abs{x - z} \le \abs{x - y} + \abs{y - z} < \epsilon + \frac{1}{j} \le \epsilon + \frac{1}{i+2},
\]
cioè $\dist(x,\, C) \le \epsilon + 1/(i+2)$. Scegliendo $\epsilon > 0$ abbastanza piccolo, si ottiene l'assurdo $\dist(x,\, C) \le 1/(i+1)$.

Pertanto, $\dist(R_i,\, R_j) > 0$ se $j \ge i+2$. Applicando l'ipotesi otteniamo per induzione
\[
\sum_{k=1}^m \mu(R_{2k}) = \mu \left(\bigcup_{k=1}^m R_{2k}\right) \le \mu(A),
\]
e analogamente
\[
\sum_{k=0}^m \mu(R_{2k+1}) = \mu \left(\bigcup_{k=0}^m R_{2k+1}\right) \le \mu(A),
\]
per ogni intero positivo $m$. Combinando queste due maggiorazioni e facendo tendere $m \to \infty$, otteniamo
\[
\sum_{k=1}^\infty \mu(R_k) \le 2\mu(A) < \infty.
\]
\end{proofsec}

\begin{proofsec}
Per la (c) e per la (**) abbiamo infine
\[
\mu(A - C) + \mu(A \cap C) = \lim_{n \to \infty} \mu(A - C_n) + \mu(A \cap C) \le \mu(A),
\]
per cui $C$ è $\mu$-misurabile.\qed
\end{proofsec}
\end{proof}

\subsection{La misura di Lebesgue}

Sia $Q \subset \RR^n$ un cubo il cui spigolo misura $l$ (qui e nel seguito consideriamo soltanto cubi con spigoli paralleli agli assi coordinati); poniamo $\Leb^n(Q) \equiv l^n$.

\begin{definizione}
\label{def:misura_lebesgue}
La \emph{misura di Lebesgue $n$-dimensionale} $\Leb^n$ su $\RR^n$\index{misura!di Lebesgue} è definita da
\[
\Leb^n(A) \equiv \inf\Set{ \sum_{i=1}^\infty \Leb^n(Q_i) | Q_i \text{ cubi, } A \subset \bigcup_{i=1}^\infty Q_i }.
\]
per ogni $A \subset \RR^n$.
\end{definizione}

\begin{osservazione}
\label{oss:caratterizzazione_misura_lebesgue_lineare}
Si noti che \mymath{\Leb^1(A) = \inf\Set{ \sum_{j=1}^\infty \diam C_j | A \subset \bigcup_{j=1}^\infty C_j }.}{(*)} E invero, in $\RR^1$ un cubo di spigolo $l$ non è altro che un intervallo di lunghezza $l$, sicché per definizione
\[
\Leb^1(A) = \inf\Set{ \sum_{j=1}^\infty (b_j - a_j) | A \subset \bigcup_{j=1}^\infty [a_j,\, b_j] }.
\]
Inoltre, per un insieme arbitrario $C \subset \RR^1$ risulta banalmente $C \subset [\inf C,\, \sup C]$ e $\diam C = \sup C - \inf C$; di conseguenza, se $\{C_j\}_{j=1}^\infty \subset \RR^1$ è una famiglia di insiemi tali che $A \subset \bigcup_{j=1}^\infty C_j$, posto $a_j \equiv \inf C_j$ e $b_j \equiv \sup C_j$ $(j = 1, 2, \ldots)$ si ha
\[
A \subset \bigcup_{j=1}^\infty [a_i,\, b_i] \qquad\text{ e }\qquad \sum_{j=1}^\infty \diam C_j = \sum_{j=1}^\infty (b_j - a_j),
\]
da cui la (*).
\end{osservazione}

\begin{teorema}
Per ogni $n \ge 1$, $\Leb^n$ è una misura di Radon su $\RR^n$.
\end{teorema}

\begin{proof}
Dopo aver osservato che $\Leb^n(K) < \infty$ per ogni compatto $K \subset \RR^n$, la dimostrazione ricalca quella di (\ref{thm:misura_hausdorff}).
\end{proof}

\begin{lemma}
\label{pro:misura_di_lebesgue_invariante_per_traslazioni}
$\Leb^n$ è invariante per traslazioni; più precisamente, posto
\[
A + x \equiv \Set{ a + x | a \in A }
\]
per $A \subset \RR^n$, $x \in \RR^n$, risulta:
\begin{itemize}
\item[(i)] $\Leb^n(A + x) = \Leb^n(A)$;
\item[(ii)] se $A \subset \RR^n$ è $\Leb^n$-misurabile, tale è anche $A + x$.
\end{itemize}
\end{lemma}

\begin{proof}
\begin{proofsec}
Se $A \subset \RR^n$, $x \in \RR^n$ e $\epsilon > 0$ possiamo trovare una successione $\{Q_i\}_{i=1}^\infty$ di cubi in $\RR^n$ tali che $A \subset \bigcup_{i=1}^\infty Q_i$ e $\sum_{i=1}^\infty \Leb^n(Q_i) \le \Leb^n(A) + \epsilon$. Pertanto
\[
A + x \subset \bigcup_{i=1}^\infty (Q_i + x)
\]
e quindi, dal momento che ciascun $Q_i + x$ è ovviamente un cubo al pari di $Q_i$ e $\Leb^n(Q_i + x) = \Leb^n(Q_i)$ $(i = 1, 2, \ldots)$,
\[
\Leb^n(A + x) \le \sum_{i=1}^\infty \Leb^n(Q_i + x) = \sum_{i=1}^\infty \Leb^n(Q_i) \le \Leb^n(A) + \epsilon.
\]
Per l'arbitrarietà di $\epsilon > 0$, $\Leb^n(A + x) \le \Leb^n(A)$. Di conseguenza è anche
\[
\Leb^n(A) = \Leb^n((A + x) + (-x)) \le \Leb^n(A + x),
\]
sicché $\Leb^n(A + x) = \Leb^n(A)$, e la (i) è provata.
\end{proofsec}

\begin{proofsec}
Supponiamo ora che $A \subset \RR^n$ sia $\Leb^n$-misurabile, e sia $B \subset \RR^n$ un insieme arbitrario. Allora, posto $A - x \equiv A + (-x) = \Set{ a - x | a \in A }$ e usando la (i),
\[
\begin{split}
\Leb^n(B \cap (A + x)) &+ \Leb^n(B - (A + x)) = \Leb^n(((B - x) \cap A) + x) + \Leb^n(((B - x) - A) + x)\\
&= \Leb^n((B - x) \cap A) + \Leb^n((B - x) - A) = \Leb^n(B - x) = \Leb^n(B).
\end{split}
\]
Pertanto $A + x$ è $\Leb^n$-misurabile; la (ii) è così dimostrata.\qed
\end{proofsec}
\end{proof}

\begin{osservazione}
In (\ref{cor:misura_lebesgue_est_invariante_per_rotazioni}) dimostreremo che $\Leb^n$ è anche invariante per rotazioni.
\end{osservazione}

\begin{esempio}
\index{insieme!non misurabile secondo Lebesgue}
Esistono insiemi $A \subset \RR^n$ che \emph{non} sono $\Leb^n$-misurabili. Poniamo, invero,
\[
Q \equiv [0,\, 1] \times \cdots \times [0,\, 1] = \Set{ (x_1, \ldots, x_n) | 0 \le x_i \le 1 \text{ per ogni $1 \le i \le n$} },
\]
e consideriamo la relazione binaria $\sim$ definita da
\[
x \sim y \stackrel{\text{def}}{\iff} y - x \in \QQ^n. 
\]
È facile verificare che $\sim$ è una relazione di equivalenza, per cui essa determina una partizione di $Q$ in classi di equivalenza. Scegliamo (usando l'Assioma della Scelta) un elemento $a$ da ciascuna classe, e sia $A$ l'insieme di tutti gli $a$.  Chiaramente, $\Leb^n(A) \le \Leb^n(Q) = 1$.

Sia
\[
A + \QQ^n \equiv \Set{ a + q | a \in A,\, q \in \QQ^n } = \bigcup_{q \in \QQ^n} A + q;
\]
dico che $A + \QQ^n = \RR^n$. E invero, se $x \in \RR^n$, esiste un $e \in \ZZ^n$ tale che $x - e \in Q$, per cui esiste anche un $a \in A$ tale che $a \sim x - e$, ossia $x - e - a \in \QQ^n$. Ma $x = a + (e + x - e - a) \in A + \QQ^n$.

Essendo poi $\QQ^n$ numerabile, risulta
\[
\infty = \Leb^n(\RR^n) \le \sum_{q \in \QQ^n} \Leb^n(A + q),
\]
sicché deve esistere un $q \in \QQ^n$ tale che $\Leb^n(A + q) > 0$; ma essendo $\Leb^n$, per (\ref{pro:misura_di_lebesgue_invariante_per_traslazioni}), invariante per traslazioni, se ne trae $\Leb^n(A) > 0$.

Scegliamo ora un intero positivo $k$ tale che
\[
k > \frac{2^n}{\Leb^n(A)},
\]
e siano $q_1, \ldots, q_k$ elementi \emph{distinti} di $Q \cap \QQ^n$. Se $a,\, b \in A$ e $1 \le i < j \le k$, allora $a + q_i \ne b + q_j$; perché se $a = b$ allora $q_i \ne q_j$, mentre se $a \ne b$ allora $a \nsim b$ e quindi $b - a \ne q_i - q_j \in \QQ^n$. Pertanto gli insiemi $A + q_1, \ldots, A + q_k$ sono disgiunti. D'altra parte, essi sono tutti inclusi in $R \equiv [0,\, 2] \times \cdots \times [0,\, 2]$. Di conseguenza,
\[
\sum_{i=1}^k \Leb^n(A + q_i) = k\Leb^n(A) > 2^n = \Leb^n(R) \ge \Leb^n\left(\bigcup_{i=1}^k (A + q_i)\right). 
\]
Quindi gli insiemi $A + q_i$ non possono essere tutti $\Leb^n$-misurabili; ne segue, applicando nuovamente (\ref{pro:misura_di_lebesgue_invariante_per_traslazioni}), che $A$ stesso non è $\Leb^n$-misurabile.
\end{esempio}

\section{Funzioni misurabili}

Estendiamo ora la nozione di misurabilità dagli insiemi alle funzioni.

\begin{definizione}
\label{def:funzione_misurabile}
Siano $X$ un insieme, $Y$ uno spazio topologico, $\AA$ una $\sigma$-algebra su $X$.
\begin{itemize}
\item[(i)] Una funzione $f : X \rightarrow Y$ si dice \emph{$\AA$-misurabile}\index{funzione!$\AA$-misurabile} se, per ogni aperto $U \subset Y$, $f^{-1} (U) \in \AA$.
\item[(ii)] Una funzione $\MM(X,\, \mu)$-misurabile, dove $\MM(X,\, \mu)$ è la $\sigma$-algebra di tutti i sottoinsiemi $\mu$-misurabili di $X$, si dirà anche \emph{$\mu$-misurabile}\index{funzione!$\mu$-misurabile}.
\item[(iii)] Se anche $X$ è uno spazio topologico, una funzione $\BB(X)$-misurabile, dove $\BB(X)$ è la $\sigma$-algebra di Borel di $X$, si dirà \emph{Borel misurabile}\index{funzione!Borel misurabile}.
\end{itemize}
\end{definizione}

\begin{osservazione}
\label{oss:caratterizzazione_funzioni_misurabili}
Una funzione $f : X \rightarrow Y$ è $\AA$-misurabile se e solo se $f^{-1} (B) \in \AA$, per ogni $B \in \BB(Y)$. Invero,
\[
\Set { A \subset Y | f^{-1} (A) \in \AA } 
\]
è una $\sigma$-algebra e quindi contiene gli aperti di $Y$ se e solo se contiene i boreliani.
\end{osservazione}

\begin{lemma}
\label{lem:caratterizzazione_funzioni_misurabili}
Per una funzione $f : X \rightarrow [-\infty,\, \infty]$, sono equivalenti:
\begin{itemize}
\item[($\alpha$)] $f$ è $\AA$-misurabile,
\item[($\beta$)] $f^{-1}[-\infty,\, a) \in \AA$ per ogni $a \in \RR$, e
\item[($\gamma$)] $f^{-1}[-\infty,\, a] \in \AA$ per ogni $a \in \RR$.
\end{itemize}
\end{lemma}

\begin{proof}
Invero, per (\ref{oss:caratterizzazione_funzioni_misurabili}), $(\alpha) \implies (\beta)$ e $(\alpha) \implies (\gamma)$. D'altra parte, per ogni $a \in \RR$ si ha
\[
[-\infty,\, a) = \bigcup_{n=1}^\infty [-\infty,\, a - 1/n]
\]
e
\[
[-\infty,\, a] = \bigcap_{n=1}^\infty [-\infty,\, a + 1/n),
\]
sicché $(\beta) \iff (\gamma)$. Di conseguenza, osservando che per $a < b$ si può scrivere 
\[
(a,\, b) = [-\infty,\, b) - [-\infty,\, a]
\]
e che ogni aperto $U \subset [-\infty,\, \infty]$ è della forma
\[
G_1 \cup G_2 \cup \bigcup_{r,\, s \in \QQ} G_{rs},
\]
dove
\begin{align*}
G_1 = \emptyset\qquad &\lor\qquad G_1 = [-\infty,\, a),\\
G_2 = \emptyset\qquad &\lor\qquad G_2 = (b,\, \infty] = [-\infty,\, \infty] - [-\infty,\, b],\\
G_{rs} = \emptyset\qquad &\lor\qquad G_{rs} = (r,\, s),
\end{align*}
otteniamo che $(\beta) \implies (\alpha)$ e $(\gamma) \implies (\alpha)$.\qed
\end{proof}

\begin{notazione}
Se $f : X \rightarrow \RR$ è una funzione, poniamo 
\[
f^+ \equiv \max(f,\, 0),\qquad f^- \equiv \max(-f,\, 0).
\]
Chiamiamo $f^+$ la \emph{parte positiva}\index{parte!positiva} di $f$, $f^-$ la \emph{parte negativa}\index{parte!negativa} di $f$. \`E immediato riconoscere che
\[
f = f^+ - f^- \qquad\text{ e }\qquad \abs{f} = f^+ + f^-.
\]
\end{notazione}

\begin{lemma}
\label{lem:proprieta_parte_positiva_e_parte_negativa}
Siano $f,\, g : X \rightarrow \RR$. Allora
\begin{itemize}
\item[(i)] $\max(f,\, g) = (f - g)^+ + g$,
\item[(ii)] $\min(f,\, g) = -(f - g)^- + g$.
\end{itemize}
\end{lemma}

\begin{proof}
Risulta
\[
\max(f,\, g) - g = \max(f-g,\, 0) = (f-g)^+,
\]
da cui la (i). Inoltre, tenendo presente che per una qualsiasi funzione $h : X \rightarrow \RR$ si ha $(-h)^+ = \max(-h,\, 0) = h^-$, dalla (i) segue
\[
\min(f,\, g) = -\max(-f,\, -g) = -(((-f)-(-g))^+ + (-g)) = -(-(f-g))^+ + g = -(f-g)^- + g,
\] 
cioè la (ii).\qed
\end{proof}

\begin{osservazione}
\label{oss:proprieta_funzione_caratteristica}
Siano $X$ uno spazio topologico e $\AA$ una $\sigma$-algebra su $X$. Allora, per ogni insieme $A \subset X$, la \emph{funzione caratteristica}\index{funzione!caratteristica} $\chi_A$ di $A$ è $\AA$-misurabile se e solo se $A \in \AA$. Basta invero osservare che per ogni $a \in \RR$ risulta
\[
\chi_A^{-1}[-\infty,\, a] = \begin{cases}
X & \text{se $a \ge 1$,}\\
X-A & \text{se $0 \le a < 1$}\\
\emptyset & \text{se $a < 0$}
\end{cases}
\]
ed applicare (\ref{lem:caratterizzazione_funzioni_misurabili}).
\end{osservazione}

\begin{teorema}[Proprietà delle funzioni misurabili]
\label{thm:proprieta_funzioni_misurabili}
\index{proprietà!delle funzioni misurabili}
\index{successione!di funzioni misurabili}
\index{limite!di funzioni misurabili}
Siano $X$ un insieme, $\AA$ una $\sigma$-algebra su $X$.
\begin{itemize}
\item[(i)] Se $f,\, g : X \rightarrow \RR$ sono $\AA$-misurabili, allora tali sono anche $f+g$, $fg$, $\abs{f}$, $\min(f,g)$ e $\max(f,g)$. Inoltre la funzione $f/g$ è $\AA$-misurabile, purché $g \ne 0$ su $X$.
\item[(ii)] Se le funzioni $f_k : X \rightarrow [-\infty,\, \infty]$ sono $\AA$-misurabili $(k = 1, 2, \ldots)$, allora $\inf_{k \ge 1} f_k$, $\sup_{k \ge 1} f_k$, $\liminf_{k \to \infty} f_k$ e $\limsup_{k \to \infty} f_k$ sono anch'esse $\AA$-misurabili. Inoltre, se esiste, $\lim_{k \to \infty} f_k$ è $\AA$-misurabile.
\end{itemize}
\end{teorema}

\begin{proof}
\begin{proofsec}
Supponiamo che $f,\, g : X \rightarrow \RR$ siano $\AA$-misurabili. Fissiamo $a \in \RR$. Allora, data la densità di $\QQ$ in $\RR$, si ha $(f+g)(x) < a$ se e solo se esistono $r,\, s \in \QQ$ tali che $r+s < a$ e $f(x) < r$, $g(x) < s$. Pertanto
\[
(f+g)^{-1} (-\infty,\, a) = \bigcup_{\substack{r,\, s\in\QQ\\r+s<a}} (f^{-1}(-\infty,\, r) \cap g^{-1}(-\infty,\, s)),
\]
sicché l'insieme a primo membro è unione \emph{numerabile} di elementi di $\AA$, e quindi appartiene ad $\AA$. Per l'arbitrarietà di $a \in \RR$, $f+g$ è $\AA$-misurabile.
\end{proofsec}

\begin{proofsec}
Essendo, per $a > 0$,
\[
f^2(x) < a \iff -a^\frac{1}{2} < f(x) < a^\frac{1}{2},
\]
risulta per un arbitrario $a \in \RR$
\[
(f^2)^{-1} (-\infty,\, a) = \begin{cases}
f^{-1} (-\infty,\, a^\frac{1}{2}) - f^{-1} (-\infty,\, -a^\frac{1}{2}] & \text{se $a > 0$}\\
\emptyset & \text{se $a \le 0$}
\end{cases}
\]
sicché $f^2$ è $\AA$-misurabile. Di conseguenza tale è anche 
\[
fg = \frac{1}{2} [(f+g)^2 - f^2 - g^2].
\]
\end{proofsec}

\begin{proofsec}
Supponiamo $g(x) \ne 0$ per ogni $x \in X$. Allora, fissato $a \in \RR$, risulta
\[
\frac{1}{g}(x) < a \iff \begin{cases}
\left(g(x)<0 \land \frac{1}{a}<g(x)\right) \iff \frac{1}{a} < g(x) < 0 & \text{se $a < 0$}\\
g(x)<0 & \text{se $a = 0$}\\
\left(g(x)<0 \lor \left(g(x)>0 \land \frac{1}{a} < g(x)\right)\right) \iff \left(g(x)<0 \lor g(x) > \frac{1}{a}\right) & \text{se $a > 0$,}
\end{cases}
\]
per cui
\[
\left(\frac{1}{g}\right)^{-1} (-\infty, a) =
\begin{cases}
g^{-1} (\frac{1}{a},\, 0) & \text{se $a < 0$}\\
g^{-1} (-\infty,\, 0) & \text{se $a = 0$}\\
g^{-1} (-\infty,\, 0) \cup g^{-1} (\frac{1}{a},\, \infty) & \text{se $a < 0$}.
\end{cases}
\]
Pertanto $1/g$ è $\AA$-misurabile, e quindi tale è anche $f/g$.
\end{proofsec}

\begin{proofsec}
Infine, si ha facilmente
\[
f^+ = \max(f,\, 0) = f\chi_{\{f \ge 0\}},\qquad f^- = \max(-f,\, 0) = -f\chi_{\{f < 0\}},
\]
sicché tenendo conto di (\ref{oss:proprieta_funzione_caratteristica}) $f^+$ e $f^-$ sono $\AA$-misurabili. Pertanto tali sono anche
\[
\abs{f} = f^+ + f^-
\]
e, in virtù di (\ref{lem:proprieta_parte_positiva_e_parte_negativa}),
\begin{align*}
\max(f,\, g) &= (f - g)^+ + g,\\
\min(f,\, g) &= -(f - g)^- + g.
\end{align*}
Con ciò, la dimostrazione della (i) è completa.
\end{proofsec}

\begin{proofsec}
Supponiamo poi che le funzioni $f_k : X \rightarrow [-\infty,\, \infty]$ $(k = 1, 2, \ldots)$ siano $\AA$-misurabili. Allora, fissato $a \in \RR$, risulta
\[
\inf_{k \ge 1} f_k(x) < a \iff \text{esiste $k_0 \ge 1$ tale che $f_{k_0}(x) < a$}
\]
e
\[
\sup_{k \ge 1} f_k(x) \le a \iff \text{$f_k(x) \le a$ per ogni $k \ge 1$,}
\]
sicché
\[
\left(\inf_{k \ge 1} f_k\right)^{-1} [-\infty,\, a) = \bigcup_{k=1}^\infty f_k^{-1} [-\infty,\, a)
\]
e
\[
\left(\sup_{k \ge 1} f_k\right)^{-1} [-\infty,\, a] = \bigcap_{k=1}^\infty f_k^{-1} [-\infty,\, a].
\]
Pertanto, $\inf_{k \ge 1} f_k$ e $\sup_{k \ge 1} f_k$ sono $\AA$-misurabili.
\end{proofsec}

\begin{proofsec}
Per completare la dimostrazione si noti che
\begin{align*}
\liminf_{k \to \infty} f_k &= \sup_{m \ge 1} \inf_{k \ge m} f_k,\\
\limsup_{k \to \infty} f_k &= \inf_{m \ge 1} \sup_{k \ge m} f_k,
\end{align*}
e che
\mymath{\lim_{k \to \infty} f_k \text{ esiste} \iff \liminf_{k \to \infty} f_k = \limsup_{k \to \infty} f_k.}{\qedsymbol}
\end{proofsec}
\end{proof}

\begin{definizione}
Siano $X$ uno spazio topologico ed $f : X \rightarrow [-\infty,\, \infty[$ una funzione (si noti che il valore $\infty$ non è permesso). Diremo che $f$ è \emph{superiormente semicontinua}\index{funzione!superiormente semicontinua} in $x_0 \in X$ se valgono le condizioni seguenti:
\begin{itemize}
\item[($\alpha$)] Se $f(x_0) > -\infty$, allora per ogni $\epsilon > 0$ esiste un intorno $U$ di $x_0$ tale che $f(x) < f(x_0) + \epsilon$ per ogni $x \in U$.
\item[($\beta$)] Se $f(x_0) = -\infty$, allora per ogni reale $M > 0$ esiste un intorno $U$ di $x_0$ tale che $f(x) < -M$ per ogni $x \in U$.
\end{itemize}
Se $f$ è superiormente semicontinua in ogni punto di $X$, diremo che $f$ è superiormente semicontinua su $X$. In modo analogo si dà la definizione di funzione \emph{inferiormente semicontinua}\index{funzione!inferiormente semicontinua}.
\end{definizione}

\begin{osservazione}
Equivalentemente, la condizione di superiore (rispettivamente, inferiore) semicontinuità in un punto $x_0 \in X$ può essere espressa richiedendo che
\[
\limsup_{x \to x_0} f(x) \le f(x_0)\qquad\text{(rispettivamente, $\liminf_{x \to x_0} f(x) \ge f(x_0)$).}
\]
\end{osservazione}

\begin{lemma}
Sia $X$ uno spazio topologico.
\begin{itemize}
\item[(i)] Una funzione $f : X \rightarrow [-\infty,\, \infty[$ è superiormente semicontinua se e solo se $f^{-1}([-\infty,\, t[)$ è aperto in $X$ per ogni $t \in \RR$. 
\item[(ii)] Una funzione $f : X \rightarrow ]-\infty,\, \infty]$ è inferiormente semicontinua se e solo se $f^{-1}(]t,\, \infty])$ è aperto in $X$ per ogni $t \in \RR$.
\end{itemize}
\end{lemma}

\begin{corollario}
\label{cor:funzioni_semicontinue}
Una funzione superiormente (rispettivamente, inferiormente) semicontinua è Borel misurabile. Inoltre, tale è anche ogni funzione continua $f : X \rightarrow \RR$.
\end{corollario}

\begin{proof}
La prima parte dell'enunciato segue subito da (\ref{lem:caratterizzazione_funzioni_misurabili}); la seconda, dall'osservazione che una funzione reale continua è superiormente (e inferiormente) semicontinua.\qed
\end{proof}

\begin{teorema}
\label{thm:decomposizione_funzione_misurabile_non_negativa}
\index{decomposizione!di una funzione misurabile non negativa}
Supponiamo che $f : X \rightarrow [0,\, \infty]$ sia $\mu$-misurabile. Esistono allora insiemi $\mu$-misurabili $\{A_k\}_{k=1}^\infty \subset X$ tali che
\[
f = \sum_{k=1}^\infty \frac{1}{k} \chi_{A_k}.
\]
\end{teorema}

\begin{proof}
Poniamo 
\[
A_1 \equiv \Set{ x \in X | f(x) \ge 1 },
\]
e induttivamente definiamo, per $k \ge 2$,
\[
A_k \equiv \Set{ x \in X | f(x) \ge \frac{1}{k} + \sum_{j=1}^{k-1} \frac{1}{j} \chi_{A_j}(x) }.
\]
Chiaramente, ciascun $A_k$ è $\mu$-misurabile. Inoltre, è immediato riconoscere, per induzione su $k$, che $f \ge \sum_{j=1}^k \frac{1}{j}\chi_{A_j}$ per ogni intero positivo $k$. E invero, fissato $x \in X$, risulta $f(x) \ge 1 = \chi_{A_1}(x)$ se $x \in A_1$ e $f(x) \ge 0 = \chi_{A_1}(x)$ se $x \notin A_1$; se poi $k$ è tale che $f(x) \ge \sum_{j=1}^k \frac{1}{j}\chi_{A_j}(x)$, si ha $f(x) \ge \frac{1}{k+1} + \sum_{j=1}^k \frac{1}{j} \chi_{A_j}(x) = \sum_{j=1}^{k+1} \frac{1}{j} \chi_{A_j}(x)$ se $x \in A_{k+1}$ (per definizione di $A_{k+1}$) e $f(x) \ge \frac{1}{k+1}\chi_{A_{k+1}}(x) + \sum_{j=1}^k \frac{1}{j}\chi_{A_j}(x) = \sum_{j=1}^{k+1} \frac{1}{j}\chi_{A_j}(x)$ se $x \notin A_{k+1}$ (per l'ipotesi di induzione). Di conseguenza, \mymath{f \ge \sum_{k=1}^\infty \frac{1}{k} \chi_{A_k}.}{(*)} Se ora $f(x) = \infty$, allora $x \in A_k$ per ogni $k$, per cui
\[
\sum_{k=1}^\infty \frac{1}{k} \chi_{A_k}(x) = \sum_{k=1}^\infty \frac{1}{k} = \infty = f(x);
\]
se invece $f(x) = 0$, allora $x \notin A_k$ per ogni $k$ sicché
\[
\sum_{k=1}^\infty \frac{1}{k} \chi_{A_k}(x) = 0 = f(x).
\]
Resta da considerare il caso $0 < f(x) < \infty$. In tale ipotesi, per la (*), deve essere
\[
\sum_{k=1}^\infty \frac{1}{k} \chi_{A_k}(x) < \infty;
\]
quindi $x \notin A_n$ per infiniti $n$. Esiste pertanto una successione strettamente crescente $\{n_h\}_{h=1}^\infty$ di interi positivi tali che \mymath{f(x) \le \frac{1}{n_h} + \sum_{k=1}^{n_h-1} \frac{1}{k} \chi_{A_k}(x),}{(h = 1, 2, \ldots)} ossia, facendo intervenire ancora la (*), \mymath{0 \le f(x) - \sum_{k=1}^{n_h-1} \frac{1}{k} \chi_{A_k}(x) \le \frac{1}{n_h}.}{(h = 1, 2, \ldots)} Passando al limite per $h \to \infty$ otteniamo la tesi.\qed
\end{proof}

\subsection{Teoremi di Lusin e di Egorov}

\begin{teorema}
\label{thm:estensione_funzioni_continue}
\index{estensione di una funzione continua}
\index{prolungamento di una funzione continua}
Supponiamo che $K \subset \RR^n$ sia compatto e $f : K \rightarrow \RR^m$ sia continua. Allora esiste una funzione continua $\bar{f} : \RR^n \rightarrow \RR^m$ tale che $\bar{f} = f$ su $K$.
\end{teorema}

\begin{proof}
\begin{proofsec}
Cominciamo con l'osservare che se l'asserto è vero nel caso $m = 1$ allora, denotate con $f^1, \ldots, f^m$ le componenti di $f$, esiste, per $i = 1, \ldots, m$, una funzione continua $\bar{f}^i : \RR^n \rightarrow \RR$ tale che $\bar{f}^i = f^i$ su $K$. Pertanto la funzione
\[
\bar{f} \equiv (\bar{f}^1, \ldots, \bar{f}^m) : \RR^n \rightarrow \RR^m
\]
è continua e inoltre $\bar{f} = f$ su $K$.

Possiamo dunque porci nel caso $m = 1$ e assumere $f : K \rightarrow \RR$.
\end{proofsec}

\begin{proofsec}
Sia $U \equiv \RR^n - K$. Per $x \in U$ e $s \in K$, poniamo
\[
u_s(x) \equiv \max \left\{2 - \frac{\abs{x - s}}{\dist(x,\, K)},\;\; 0\right\}.
\]
Si noti che $\dist(x,\, K) > 0$ per ogni $x \in U$, in quanto $K$ è chiuso e $x \notin K$; resta così definita una funzione, ovviamente continua,
\[
u_s : U \rightarrow \RR.
\]
\`E immediato riconoscere che $0 \le u_s(x) \le 1$ per ogni $x \in U$ e che $u_s(x) = 0$ se (e solo se) $\abs{x - s} \ge 2\dist(x,\, K)$. 
\end{proofsec}

\begin{proofsec}
Sia ora $\{s_j\}_{j=1}^\infty$ un sottoinsieme numerabile denso di $K$, e definiamo
\[
\sigma(x) \equiv \sum_{j=1}^\infty 2^{-j} u_{s_j}(x)
\]
per $x \in U$. Osserviamo che, essendo $u_{s_j}(x) \le 1$, si ha anche
\[
\sum_{j=1}^\infty 2^{-j} u_{s_j}(x) \le \sum_{j=1}^\infty 2^{-j} = 1;
\]
inoltre, essendo $\{s_j\}_{j=1}^\infty$ denso in $K$ e tenendo presente che $\dist(x,\, K) > 0$, esiste $j_0$ tale che $\abs{x - s_{j_0}} < 2\dist(x,\, K)$. Ma allora, per quanto osservato nella (b), $u_{s_{j_0}} (x) > 0$ e quindi $\sigma(x) \ge 2^{-j_0}u_{s_{j_0}}(x) > 0$. Pertanto
\[
0 < \sigma(x) \le 1\qquad \text{ per $x \in U$}.
\]
\end{proofsec}

\begin{proofsec}
Ora poniamo
\[
v_k(x) \equiv \frac{2^{-k}u_{s_k}(x)}{\sigma(x)}
\]
per $x \in U$, $k = 1, 2, \ldots$ Le funzioni $\{v_k\}_{k=1}^\infty$ sono ovviamente continue su $U$ e inoltre
\[
\sum_{k=1}^\infty v_k(x) = \frac{1}{\sigma(x)} \sum_{k=1}^\infty 2^{-k} u_{s_k}(x) = \frac{1}{\sigma(x)} \sigma(x) = 1.
\]
Definiamo
\[
\bar{f}(x) \equiv \begin{cases}
f(x) & \text{se $x \in K$}\\
\sum_{k=1}^\infty v_k(x) f(s_k) & \text{se $x \in U$.}
\end{cases}
\]
La funzione $f : K \rightarrow \RR$, essendo continua sul compatto $K \subset \RR^n$, è ivi dotata di massimo assoluto $M$ per cui
\[
\sum_{k=1}^\infty v_k(x) f(s_k) \le M\sum_{k=1}^\infty v_k(x) = M\qquad\text{ per $x \in U$};
\]
pertanto la serie a primo membro converge totalmente, e quindi anche uniformemente, su $U$. Dal momento che ogni termine della serie è una funzione continua su $U$, tale è anche la sua somma $\bar{f}(x)$.
\end{proofsec}

\begin{proofsec}
Per dimostrare che $\bar{f}$ è continua su tutto $\RR^n$ basterà allora far vedere che
\[
\lim_{\substack{x \to a\\x \in U}} \bar{f}(x) = f(a)
\]
per ogni $a \in \boundary{K}$. Si fissi $\epsilon > 0$. Esiste allora, per la continuità di $f$ su $K$, un $\delta > 0$ tale che
\[
\abs{f(a) - f(s_k)} < \epsilon
\]
per ogni $s_k$ tale che $\abs{a - s_k} < \delta$. Mostreremo che
\[
\abs{\bar{f}(x) - f(a)} < \epsilon
\]
per ogni $x \in U$ con $\abs{x - a} < \delta/4$. Fissiamo dunque un $x$ siffatto. Se $\abs{a - s_k} \ge \delta$, allora
\[
\delta \le \abs{a - s_k} \le \abs{a - x} + \abs{x - s_k} < \frac{\delta}{4} + \abs{x - s_k},
\]
sicché
\[
\abs{x - s_k} > \frac{3}{4}\delta > 2 \cdot \frac{\delta}{4} > 2\abs{x - a} \ge 2\dist(x,\, K).
\]
Pertanto, non appena $\abs{x - a} < \delta/4$ e $\abs{a - s_k} \ge \delta$, $u_{s_k}(x) = 0$ e quindi $v_k(x) = 0$. Ricordando che
\[
\sum_{k=1}^\infty v_k(x) = 1
\]
per ogni $x \in U$ e ponendo
\[
I \equiv \Set{ k | \abs{a - s_k} < \delta },
\]
otteniamo per $x \in U$, $\abs{x - a} < \delta/4$
\begin{align*}
\bar{f}(x) - f(a) &= \sum_{k=1}^\infty v_k(x)f(s_k) - f(a) = \sum_{k=1}^\infty v_k(x)f(s_k) - \sum_{k=1}^\infty v_k(x)f(a)\\
&= \sum_{k=1}^\infty v_k(x)\Big(f(s_k) - f(a)\Big) = \sum_{k \in I} v_k(x)\Big(f(s_k) - f(a)\Big).
\end{align*}
Ne segue
\[
\abs{\bar{f}(x) - f(a)} \le \sum_{k \in I} v_k(x) \abs{f(s_k) - f(a)} < \sum_{k \in I} v_k(x) \epsilon \le \epsilon\sum_{k=1}^\infty v_k(x) = \epsilon,
\]
come volevasi.\qed
\end{proofsec}
\end{proof}

\noindent Proviamo ora che una funzione misurabile può essere approssimata, nel senso della misura, da una funzione continua.

\begin{teorema2}[Lemma di Incollamento]
\label{thm:lemma_incollamento}
\index{lemma!di incollamento}
Siano $X$ e $Y$ spazi topologici. Se $\{C_i\}_{i=1}^k$ è una famiglia \emph{finita} di chiusi tali che $X = \bigcup_{i=1}^k C_i$, e $f : X \rightarrow Y$ è una funzione le cui restrizioni $f_i \equiv f_{|C_i} : C_i \rightarrow Y$ a ciascuno dei $C_i$ sono continue, allora $f$ è continua. 
\end{teorema2}

\begin{proof}
Sia $C \subset Y$ un chiuso. Allora
\[
f^{-1}(C) = \bigcup_{i=1}^k (C_i \cap f^{-1}(C)) = \bigcup_{i=1}^k f_i^{-1}(C);
\]
ma ciascun $f_i^{-1}(C)$ è chiuso essendo $f_i$ continua, sicché anche la loro unione $f^{-1}(C)$ è chiusa. Per l'arbitrarietà della scelta di $C$, $f$ è continua.\qed
\end{proof}

\begin{teorema2}[Teorema di Lusin]
\label{thm:lusin}
\index{teorema!di Lusin}
Sia $\mu$ una misura Borel regolare su $\RR^n$ e sia $f : \RR^n \rightarrow \RR^m$ $\mu$-misurabile. Supponiamo che $A \subset \RR^n$ sia $\mu$-misurabile e che $\mu(A) < \infty$. Fissiamo $\epsilon > 0$. Esiste allora un compatto $K \subset A$ tale che:
\begin{itemize}
\item[(i)] $\mu(A - K) < \epsilon$;
\item[(ii)] $f_{|K}$ è continua.
\end{itemize}
\end{teorema2}

\begin{proof}
\begin{proofsec}
Per ogni intero positivo $i$, sia $\{B_{ij}\}_{j=1}^\infty \subset \RR^m$ una famiglia di boreliani \emph{disgiunti}\/ tali che $\RR^m = \bigcup_{j=1}^\infty B_{ij}$ e $\diam B_{ij} < 1/i$ per $j = 1, 2, \ldots$ Poniamo $A_{ij} \equiv A \cap f^{-1}(B_{ij})$; per ogni $i$ otteniamo in tal modo una famiglia disgiunta $\{A_{ij}\}_{j=1}^\infty$ di sottoinsiemi $\mu$-misurabili di $\RR^n$ e inoltre
\[
A = \bigcup_{j=1}^\infty (A \cap f^{-1}(B_{ij})) = \bigcup_{j=1}^\infty A_{ij}.
\]
\end{proofsec}

\begin{proofsec}
Poniamo $\nu \equiv \mu \restr A$; $\nu$ è una misura di Radon per (\ref{cor:restrizione_misura_borel_regolare}), sicché (\ref{thm:approssimazione_con_aperti_e_compatti}) assicura per ogni $i$ e per ogni $j$ l'esistenza di un compatto $K_{ij} \subset A_{ij}$ con $\nu(A_{ij} - K_{ij}) < \epsilon/2^{i+j}$. Possiamo allora scrivere
\[
\mu\left(A - \bigcup_{j=1}^\infty K_{ij}\right) = \nu\left(A - \bigcup_{j=1}^\infty K_{ij}\right) = \nu\left(\bigcup_{j=1}^\infty A_{ij} - \bigcup_{j=1}^\infty K_{ij}\right) \le \nu\left(\bigcup_{j=1}^\infty (A_{ij} - K_{ij})\right) < \sum_{j=1}^\infty \frac{\epsilon}{2^{i+j}} = \frac{\epsilon}{2^i}.
\]
Ma avendosi per ipotesi $\mu(A) < \infty$, risulta
\[
\lim_{N \to \infty} \mu\left(A - \bigcup_{j=1}^N K_{ij}\right) = \mu\left(A - \bigcup_{j=1}^\infty K_{ij}\right) < \frac{\epsilon}{2^i},
\]
per cui esiste, per ogni intero positivo $i$, un numero $N(i)$ tale che \mymath{\mu\left(A - \bigcup_{j=1}^{N(i)} K_{ij}\right) < \frac{\epsilon}{2^i}.}{(*)}
\end{proofsec}

\begin{proofsec}
Per ogni $i$, poniamo $D_i \equiv \bigcup_{j=1}^{N(i)} K_{ij}$; $D_i$ è compatto in quanto unione finita di compatti. Inoltre, per $j = 1, \ldots, N(i)$, fissiamo $b_{ij} \in B_{ij}$ e poi definiamo $g_i : D_i \rightarrow \RR^m$ ponendo $g_i(x) \equiv b_{ij}$ per $x \in K_{ij}$. La definizione è ben posta in quanto le famiglie $\{K_{ij}\}_{j=1}^{N(i)}$ e $\{B_{ij}\}_{j=1}^{N(i)}$ sono disgiunte; applicando poi il lemma di incollamento (\ref{thm:lemma_incollamento}) vediamo che $g_i$ è continua. Inoltre, se $x \in D_i$ esiste $j$ tale che $x \in K_{ij} \subset A_{ij}$, sicché $f(x) \in B_{ij}$. Dal momento che anche $g_i(x) = b_{ij} \in B_{ij}$, e ricordando che $\diam B_{ij} < 1/i$, si ha $\abs{f(x) - g_i(x)} < 1/i$.
\end{proofsec}

\begin{proofsec}
Poniamo $K \equiv \bigcap_{i=1}^\infty D_i$; $K$ è compatto e $A - K = \bigcup_{i=1}^\infty (A - D_i)$, per cui tenendo presente la (*) possiamo scrivere
\[
\mu(A - K) \le \sum_{i=1}^\infty \mu(A - D_i) = \sum_{i=1}^\infty \mu\left(A - \bigcup_{j=1}^{N(i)} K_{ij}\right) < \sum_{i=1}^\infty \frac{\epsilon}{2^i} = \epsilon.
\]
Infine, avendosi $\abs{f(x) - g_i(x)} < 1/i$ per ogni $x \in D_i$, è chiaro che $g_i \to f$ uniformemente su $K$. Pertanto $f_{|K}$, in quanto limite uniforme di funzioni continue su un compatto, è continua, come volevasi.\qed
\end{proofsec}
\end{proof}

\begin{corollario}
Sia $\mu$ una misura Borel regolare su $\RR^n$ e sia $f : \RR^n \rightarrow \RR^m$ $\mu$-misurabile. Assumiamo che $A \subset \RR^n$ sia $\mu$-misurabile e che $\mu(A) < \infty$. Allora, per ogni $\epsilon > 0$, esiste una funzione continua $\bar{f} : \RR^n \rightarrow \RR^m$ tale che $\mu\left(\Set{ x \in A | \bar{f}(x) \ne f(x) }\right) < \epsilon$.
\end{corollario}

\begin{proof}
Per il teorema di Lusin esiste un compatto $K \subset A$ tale che $\mu(A - K) < \epsilon$ e $f_{|K}$ è continua. Allora per (\ref{thm:estensione_funzioni_continue}) esiste una funzione continua $\bar{f} : \RR^n \rightarrow \RR^m$ tale che $\bar{f}_{|K} = f_{|K}$ e
\mymath{\mu\left(\Set{ x \in A | \bar{f}(x) \ne f(x) }\right) \le \mu(A - K) < \epsilon.}{\qedsymbol}
\end{proof}

\begin{notazione}
L'espressione ``$\qo{\mu}$'' significa ``quasi ovunque rispetto alla misura $\mu$'', cioè, eccettuato al più su un insieme $A$ con $\mu(A) = 0$. Analogamente, l'espressione ``$\qogni{x \in X}{\mu}$'' significa ``quasi ogni $x \in X$ (rispetto alla misura $\mu$)'', ossia, per ogni $x \in X - A$ con $\mu(A) = 0$. 
\end{notazione}

\begin{teorema2}[Teorema di Egorov]
\label{thm:egorov}
\index{teorema!di Egorov}
Sia $\mu$ una misura su $\RR^n$ e supponiamo che $f_k : \RR^n \rightarrow \RR^m$ $(k = 1, 2, \ldots)$ sia una successione di funzioni $\mu$-misurabili. Assumiamo inoltre che $A \subset \RR^n$ sia $\mu$-misurabile, con $\mu(A) < \infty$, e $f_k \to g$ $\qo{\mu}$ su $A$. Allora per ogni $\epsilon > 0$ esiste un insieme $\mu$-misurabile $B \subset A$ tale che:
\begin{itemize}
\item[(i)] $\mu(A - B) < \epsilon$;
\item[(ii)] $f_k \to g$ uniformemente su $B$.
\end{itemize}
\end{teorema2}

\begin{proof}
\begin{proofsec}
Definiamo \mymath{E_{ik} \equiv \Set{ x | \abs{f_k(x) - g(x)} > 2^{-i} },}{(i,\, k = 1, 2, \ldots)} e \mymath{C_{ij} \equiv \bigcup_{k=j}^\infty E_{ik},}{(i,\, j = 1, 2, \ldots)} Ogni $E_{ik}$ è $\mu$-misurabile e quindi tale è anche ogni $C_{ij}$; inoltre
\[
C_{i1} \supset C_{i2} \supset \ldots \supset C_{ij} \supset C_{i,\,j+1} \supset \ldots
\]
per ogni $i$, ed essendo $A$ $\mu$-misurabile e $\mu(A) < \infty$ otteniamo \mymath{\lim_{j \to \infty} \mu(A \cap C_{ij}) = \mu\left(A \cap \bigcap_{j=1}^\infty C_{ij}\right).}{(i = 1, 2, \ldots)}
\end{proofsec}

\begin{proofsec}
Osserviamo poi che se $x \in \bigcap_{j=1}^\infty C_{ij}$, allora per ogni $j$ esiste $k \ge j$ tale che $\abs{f_k(x) - g(x)} > 2^{-i}$, cioè $f_k(x)$ \emph{non} converge a $g(x)$. Questo implica
\[
\mu\left(A \cap \bigcap_{j=1}^\infty C_{ij}\right) = 0,
\]
in quanto per ipotesi $f_k \to g$ $\qo{\mu}$ su $A$. Pertanto $\lim_{j \to \infty} \mu(A \cap C_{ij}) = 0$, ossia per ogni $i$ esiste un intero $N(i)$ tale che $\mu(A \cap C_{i,\,N(i)}) < \epsilon/2^i$.
\end{proofsec}

\begin{proofsec}
Sia $B \equiv A - \bigcup_{i=1}^\infty C_{i,\,N(i)}$. Allora $B$ è $\mu$-misurabile,
\[
A - B = A \cap \bigcup_{i=1}^\infty C_{i,\,N(i)} = \bigcup_{i=1}^\infty (A \cap C_{i,\,N(i)}),
\]
e quindi
\[
\mu(A - B) \le \sum_{i=1}^\infty \mu(A \cap C_{i,\, N(i)}) < \sum_{i=1}^\infty \frac{\epsilon}{2^i} = \epsilon.
\]
Infine, per ogni $i$ e per ogni $x \in B$ si ha $x \notin C_{i,\, N(i)}$, da cui, ricordando che
\[
C_{i,\, N(i)} = \bigcup_{k=N(i)}^\infty E_{ik} = \bigcup_{k=N(i)}^\infty \Set{ x | \abs{f_k(x) - g(x)} > 2^{-i} },
\]
segue $\abs{f_k(x) - g(x)} \le 2^{-i}$ per ogni $k \ge N(i)$. Siccome $N(i)$ dipende solo da $i$, abbiamo dimostrato che $f_k \to g$ uniformemente su $B$, come volevasi.\qed
\end{proofsec}
\end{proof}

\section{Integrali e teoremi di passaggio al limite}

Sia $\mu$ una misura su un insieme $X$.

\begin{definizione}
\label{def:funzione_semplice}
Una funzione $g : X \rightarrow [-\infty,\, \infty]$ si dice una \emph{funzione semplice}\index{funzione!semplice} se l'immagine di $g$ è numerabile.
\end{definizione}

\begin{definizione}
\label{def:integrale_funzione_semplice_non_negativa}
Sia $g$ una funzione semplice $\mu$-misurabile non negativa; definiamo l'\emph{integrale} di $g$ rispetto a $\mu$ come
\[
\int g\, d\mu \equiv \sum_{0 \le y \le \infty} y\mu(g^{-1}\{y\}).
\]
\end{definizione}

\begin{definizione}
\label{def:integrale_funzione_semplice}
Se $g$ è una funzione semplice $\mu$-misurabile e $\int g^+\, d\mu < \infty$ oppure $\int g^-\, d\mu < \infty$, diciamo che $g$ è \emph{$\mu$-integrabile} e definiamo l'\emph{integrale} di $g$ rispetto a $\mu$ come
\[
\int g\, d\mu \equiv \int g^+\, d\mu - \int g^-\, d\mu.
\]
\end{definizione}

\begin{osservazione}
Se $g$ è una funzione semplice $\mu$-integrabile risulta
\[
\int g\, d\mu = \sum_{-\infty \le y \le \infty} y\mu(g^{-1}\{y\}).
\]
Basta invero notare che per ogni $y$
\[
g^{-1}\{y\} =
\begin{cases}
(g^+)^{-1}\{y\} & \text{se $y > 0$}\\
(g^-)^{-1}\{-y\} & \text{se $y < 0$,}
\end{cases}
\]
ed applicare le definizioni (\ref{def:integrale_funzione_semplice_non_negativa}) e (\ref{def:integrale_funzione_semplice}).
\end{osservazione}

\begin{definizione}
\label{def:integrali_superiore_inferiore}
Sia $f : X \rightarrow [-\infty,\, \infty]$. Definiamo l'\emph{integrale superiore}\index{integrale!superiore} di $f$ rispetto a $\mu$ come
\[
\int^\star f\, d\mu \equiv \inf\Set{ \int g\, d\mu | g \text{ è una funzione semplice $\mu$-integrabile con $g \ge f$ $\qo{\mu}$} }
\]
e l'\emph{integrale inferiore}\index{integrale!inferiore} di $f$ rispetto a $\mu$ come
\[
\int_\star f\, d\mu \equiv \sup\Set{ \int g\, d\mu | g \text{ è una funzione semplice $\mu$-integrabile con $g \le f$ $\qo{\mu}$} }.
\]
\end{definizione}

\begin{definizione}
\label{def:funzione_integrabile}
Una funzione $\mu$-misurabile si dice \emph{$\mu$-integrabile}\index{funzione!integrabile} se $\int^\star f\, d\mu = \int_\star f\, d\mu$; in tal caso scriveremo 
\[
\int f\, d\mu \equiv \int^\star f\, d\mu = \int_\star f\, d\mu
\]
e chiameremo $\int f\, d\mu$ l'\emph{integrale}\index{integrale} di $f$ rispetto a $\mu$.
\end{definizione}

\begin{osservazione}
Per una funzione $\mu$-integrabile $f$ può anche aversi $\int f\, d\mu = \pm\infty$.
\end{osservazione}

\begin{osservazione}
\label{oss:funzione_misurabile_non_negativa_est_integrabile}
Una funzione $\mu$-misurabile non negativa è sempre $\mu$-integrabile.
\end{osservazione}

\begin{definizione}
Siano $f$ una funzione $\mu$-integrabile, $A \subset X$ un insieme $\mu$-misurabile. L'integrale di $f$ \emph{su $A$} (rispetto a $\mu$)\index{integrale!su un sottoinsieme} è definito come
\[
\int_A f\, d\mu = \int f\chi_A\, d\mu.
\]
\end{definizione}

\begin{definizioni}
\label{def:funzione_sommabile}
Diremo che:
\begin{itemize}
\item[(i)] Una funzione $f : X \rightarrow [-\infty,\, \infty]$ è \emph{$\mu$-sommabile}\index{funzione!sommabile} se $f$ è $\mu$-integrabile e
\[
\int |f|\, d\mu < \infty.
\]
\item[(ii)] Una funzione $f : \RR^n \rightarrow [-\infty,\, \infty]$ è \emph{localmente $\mu$-sommabile}\index{funzione!localmente sommabile} se $f_{|K}$ è $\mu$-sommabile per ogni compatto $K \subset \RR^n$.
\end{itemize}
\end{definizioni}

\begin{notazione}
Sia $1 \le p < \infty$ un numero reale. Denotiamo con
\[
L^p (X,\, \mu)
\]
l'insieme di tutte le funzioni $f$ tali che $\abs{f}^p$ sia $\mu$-sommabile su $X$, e con
\[
L_\textup{loc}^p (\RR^n,\, \mu)
\]
l'insieme di tutte le funzioni $g$ tali che $\abs{g}^p$ sia localmente $\mu$-sommabile.
\end{notazione}

\begin{osservazione}
\emph{Non} identificheremo funzioni che sono $\qo{\mu}$ uguali.
\end{osservazione}

\begin{notazione}
Scriveremo ``$dx$'', ``$dy$'', etc. invece che ``$d\Leb^n$'' negli integrali calcolati rispetto a $\Leb^n$. Scriveremo anche $L^p(\RR^n)$ al posto di $L^p(\RR^n,\, \Leb^n)$, etc.
\end{notazione}

\begin{teorema}[Lemma di Fatou]
\label{thm:lemma_fatou}
\index{lemma!di Fatou}
Siano $f_k : X \rightarrow [0,\, \infty]$ $\mu$-misurabili $(k = 1, 2, \ldots)$. Allora
\[
\int \liminf_{k \to \infty} f_k\, d\mu \le \liminf_{k \to \infty} \int f_k\, d\mu.
\]
\end{teorema}

\begin{proof}
Si prenda una qualsiasi funzione semplice $\mu$-misurabile $g$ con
\[
0 \le g \le \liminf_{k \to \infty} f_k;
\]
denotati con $\{a_j\}_{j=1}^\infty$ i valori \emph{positivi} distinti assunti da $g$ e posto $A_j \equiv g^{-1}\{a_j\}$ $(j = 1, 2, \ldots$), possiamo scrivere $g$ nella forma
\[
g = \sum_{j=1}^\infty a_j \chi_{A_j},
\] 
con $\{A_j\}_{j=1}^\infty$ successione \emph{disgiunta} di insiemi $\mu$-misurabili. Si fissi $0 < t < 1$ e si osservi che se $x \in A_j$ si ha anche $g(x) = a_j$, sicché
\[
\left(\liminf_{k \to \infty} f_k\right) (x) \ge a_j > ta_j;
\]
pertanto, esiste $k \ge 1$ tale che $f_l(x) > ta_j$, per ogni $l \ge k$. Di conseguenza, \mymath{A_j = \bigcup_{k=1}^\infty B_{j,\,k},}{(*)} dove
\[
B_{j,\,k} \equiv A_j \cap \Set{ x | f_l(x) > ta_j \text{ per ogni $l \ge k$ } }.
\]
Si noti anche che \mymath{A_j \supset B_{j,\,k+1} \supset B_{j,\,k}.}{(**)} Pertanto, per ogni coppia $h,\, k$ di interi positivi risulta
\[
\int f_k\, d\mu \ge \int_{A_1 \cup \ldots \cup A_h} f_k\, d\mu = \sum_{j=1}^h \int_{A_j} f_k\, d\mu
\ge \sum_{j=1}^h \int_{B_{j,\,k}} f_k\, d\mu \ge t \sum_{j=1}^h a_j \mu(B_{j,\,k}),
\]
da cui, avendosi per la (*) e la (**) $\lim_{k \to \infty} \mu(B_{j,\,k}) = \mu(A_j)$, segue \mymath{\liminf_{k \to \infty} \int f_k\, d\mu \ge t\sum_{j=1}^h a_j \mu(A_j).}{(h = 1, 2, \ldots)} Facendo ora tendere $h \to \infty$ otteniamo
\[
\liminf_{k \to \infty} \int f_k\, d\mu \ge t\sum_{j=1}^\infty a_j \mu(A_j) = t \int g\, d\mu;
\]
questa stima vale per ogni $0 < t < 1$, sicché per $t \to 1^-$ si ha
\[
\liminf_{k \to \infty} \int f_k\, d\mu \ge \int g\, d\mu.
\]
Ma $g$ è un'arbitraria funzione semplice $\mu$-misurabile con $0 \le g \le \liminf_{k \to \infty} f_k$; pertanto
\[
\liminf_{k \to \infty} \int f_k\, d\mu \ge \int_\star \liminf_{k \to \infty} f_k\, d\mu.
\]
Ricordando (\ref{oss:funzione_misurabile_non_negativa_est_integrabile}), si ha la tesi.\qed
\end{proof}

\begin{teorema2}[Teorema della convergenza monotona]
\label{thm:convergenza_monotona}
\index{teorema!della convergenza monotona}
Siano $f_k : X \rightarrow [0,\, \infty]$ $\mu$-misurabili, con
\[
f_1 \le \ldots \le f_k \le f_{k+1} \le \ldots
\]
Allora
\[
\int \lim_{k \to \infty} f_k\, d\mu = \lim_{k \to \infty} \int f_k\, d\mu.
\]
\end{teorema2}

\begin{proof}
\`E chiaro che $\lim_{k \to \infty} f_k$ esiste ed è una funzione $\mu$-misurabile non negativa, quindi, per (\ref{oss:funzione_misurabile_non_negativa_est_integrabile}), $\mu$-integrabile; inoltre $f_j \le \lim_{k \to \infty} f_k$ $(j = 1, 2, \ldots)$, sicché per la proprietà di monotonia dell'integrale si ha \mymath{\int f_j\, d\mu \le \int \lim_{k \to \infty} f_k\, d\mu,}{(*)} per $j = 1, 2, \ldots$ Ancora per monotonia, essendo la successione di funzioni $\{f_k\}_{k=1}^\infty$ per ipotesi non decrescente, risulta 
\[
\int f_1\, d\mu \le \ldots \le \int f_k\, d\mu \le \int f_{k+1}\, d\mu \le \ldots,
\]
per cui $\lim_{k \to \infty} \int f_k\, d\mu$ esiste e, per la (*),
\[
\lim_{k \to \infty} \int f_k\, d\mu \le \int \lim_{k \to \infty} f_k\, d\mu
\]
La disuguaglianza opposta segue dal lemma di Fatou.\qed
\end{proof}

\begin{corollario}
\label{cor:convergenza_monotona}
Siano $f_k : X \rightarrow [0,\, \infty]$ $\mu$-misurabili $(k = 1, 2, \ldots)$. Allora
\[
\int \sum_{k=1}^\infty f_k\, d\mu = \sum_{k=1}^\infty \int f_k\, d\mu.
\]
\end{corollario}

\begin{proof}
Applicando il teorema alla successione non decrescente di funzioni $\mu$-misurabili $g_j \equiv \sum_{k=1}^j f_k$ $(j = 1, 2, \ldots)$ otteniamo
\[
\int \sum_{k=1}^\infty f_k\, d\mu = \int \lim_{j \to \infty} g_j\, d\mu = \lim_{j \to \infty} \int g_j\, d\mu.
\]
Ma, per l'additività finita dell'integrale,
\[
\lim_{j \to \infty} \int g_j\, d\mu = \lim_{j \to \infty} \sum_{k=1}^j \int f_k\, d\mu = \sum_{k=1}^\infty \int f_k\, d\mu,
\]
ossia la tesi.\qed
\end{proof}

\begin{teorema2}[Teorema della convergenza dominata]
\label{thm:convergenza_dominata}
\index{teorema!della convergenza dominata}
Siano $f$ ed $\{f_k\}_{k=1}^\infty$ $\mu$-misurabili, e supponiamo che $f_k \to f$ $\qo{\mu}$ per $k \to \infty$ e $\abs{f_k} \le g$ $(k = 1, 2, \ldots)$. Allora
\[
\lim_{k \to \infty} \int \abs{f_k - f}\, d\mu = 0.
\]
\end{teorema2}

\begin{proof}
Possiamo assumere che $\abs{f_k} \le g$ e $f_k \to f$ per $k \to \infty$ su tutto $X$. Osserviamo in primo luogo che
\[
\abs{f - f_k} \le \abs{f} + \abs{f_k} \le g + g = 2g,
\]
per cui
\[
2g - \abs{f - f_k}
\]
è una funzione $\mu$-misurabile non negativa per $k = 1, 2, \ldots$ Applicando allora il lemma di Fatou (\ref{thm:lemma_fatou}) scriviamo \mymath{\int \liminf_{k \to \infty} (2g - \abs{f - f_k})\, d\mu \le \liminf_{k \to \infty} \int 2g - \abs{f - f_k}\, d\mu.}{(*)} Ma $\liminf_{k \to \infty} (2g - \abs{f - f_k}) = 2g$ in quanto $f_k \to f$, e inoltre, essendo $g$ $\mu$-sommabile,
\[
\liminf_{k \to \infty} \int 2g - \abs{f - f_k}\, d\mu = \liminf_{k \to \infty} \int 2g\, d\mu + \liminf_{k \to \infty} \int (-\abs{f - f_k})\, d\mu = \int 2g\, d\mu - \limsup_{k \to \infty} \int \abs{f - f_k}\, d\mu.
\]
Pertanto la (*) si riscrive come
\[
\int 2g\, d\mu \le \int 2g\, d\mu - \limsup_{k \to \infty} \int \abs{f - f_k}\, d\mu
\]
da cui, facendo nuovamente intervenire l'ipotesi che $g$ sia $\mu$-sommabile,
\[
\limsup_{k \to \infty} \int \abs{f - f_k}\, d\mu \le 0.
\]
Ne segue ovviamente
\[
\lim_{k \to \infty} \int \abs{f - f_k}\, d\mu = 0,
\]
come volevasi.\qed
\end{proof}

\begin{teorema}
Siano $g,\, \{g_k\}_{k=1}^\infty$ $\mu$-sommabili e $f,\, \{f_k\}_{k=1}^\infty$ $\mu$-misurabili. Supponiamo che $\abs{f_k} \le g_k$ $(k = 1, 2, \ldots)$, $f_k \to f$ $\qo{\mu}$, $g_k \to g$ $\qo{\mu}$, e
\[
\lim_{k \to \infty} \int g_k\, d\mu = \int g\, d\mu.
\]
Allora
\[
\lim_{k \to \infty} \int \abs{f_k - f}\, d\mu = 0.
\]
\end{teorema}

\begin{proof}
Simile alla dimostrazione di (\ref{thm:convergenza_dominata}).\qed
\end{proof}

\begin{osservazione}
\`E facile verificare che $\lim_{k \to \infty} \int \abs{f_k - f}\, d\mu = 0$ \emph{non} implica necessariamente  $f_k \to f$ $\qo{\mu}$ Si consideri ad esempio la successione di funzioni $\{f_k\}_{k=1}^\infty$ definita da
\[
f_k \equiv \chi_{\left[\frac{j}{2^i},\, \frac{j+1}{2^i}\right]},\qquad\text{ con $k = 2^i + j,\;\; 0 \le j < 2^i$.}
\]
Quindi $f_1 = \chi_{[0,\, 1]}$, $f_2 = \chi_{\left[0,\, \frac{1}{2}\right]}$, $f_3 = \chi_{\left[\frac{1}{2},\, 1\right]}$, $f_4 = \chi_{\left[0,\, \frac{1}{4}\right]}$, $f_5 = \chi_{\left[\frac{1}{4},\, \frac{1}{2}\right]}$, $f_6 = \chi_{\left[\frac{1}{2},\, \frac{3}{4}\right]}$, $f_7 = \chi_{\left[\frac{3}{4},\, 1\right]}$, $f_8 = \chi_{\left[0,\, \frac{1}{8}\right]}$, $f_9 = \chi_{\left[\frac{1}{8},\, \frac{1}{4}\right]}$, $f_{10} = \chi_{\left[\frac{1}{4},\, \frac{3}{8}\right]}, \ldots$ Si ha ovviamente $\int_0^1 f_k\, dx = \frac{1}{2^i} \to 0$ per $k \to \infty$, sicché
\[
\lim_{k \to \infty} \int_0^1 \abs{f_k - f}\, dx = 0
\]
dove $f$ è la funzione identicamente nulla su $[0,\, 1]$. D'altra parte, se $x \in [0,\, 1]$ allora esistono infiniti $k$ tali che $x \in \left[\frac{j}{2^i},\, \frac{j+1}{2^i}\right]$ ed infiniti altri tali che $x \notin \left[\frac{j}{2^i},\, \frac{j+1}{2^i}\right]$, ossia la successione $\{f_k(x)\}_{k=1}^\infty$ contiene infiniti 1 ed infiniti 0. Pertanto, $\{f_k\}_{k=1}^\infty$ \emph{non} converge puntualmente in nessun punto di $[0,\, 1]$.

Se però passiamo ad una opportuna successione estratta la convergenza quasi ovunque ci è garantita dal risultato che segue.
\end{osservazione}

\begin{teorema}
Assumiamo che $f$ e $\{f_k\}_{k=1}^\infty$ siano $\mu$-sommabili e che
\[
\lim_{k \to \infty} \int \abs{f_k - f}\, d\mu = 0.
\]
Esiste allora una successione estratta $\{f_{k_j}\}_{j=1}^\infty$ tale che
\[
f_{k_j} \to f\qquad \qo{\mu}
\]
\end{teorema}

\begin{proof}
Per ogni $j \ge 1$ esiste, per l'ipotesi $\lim_{k \to \infty} \int \abs{f_k - f}\, d\mu = 0$, un $k_j \ge j$ tale che
\[
\int \abs{f_{k_j} - f}\, d\mu \le \frac{1}{2^j}.
\]
Applicando (\ref{cor:convergenza_monotona}) otteniamo allora
\[
\int \sum_{j=1}^\infty \abs{f_{k_j} - f}\, d\mu = \sum_{j=1}^\infty \int \abs{f_{k_j} - f}\, d\mu < \infty.
\]
Pertanto
\[
\sum_{j=1}^\infty \abs{f_{k_j} - f}\, d\mu < \infty\qquad \qo{\mu},
\]
cioè la serie a primo membro converge $\qo{\mu}$ Questo implica ovviamente che il suo termine generale è infinitesimo, vale a dire che
\[
\abs{f_{k_j} - f} \to 0\qquad \qo{\mu}
\]
per $j \to \infty$.\qed
\end{proof}

\begin{lemma}
\label{lem:estensione_di_una_misura}
Siano $\AA$ una $\sigma$-algebra su $X$ e $\mu : \AA \rightarrow [0, \infty]$ un'applicazione soddisfacente le proprietà
\begin{itemize}
\item[($\alpha$)] $\mu(\emptyset) = 0$, e
\item[($\beta$)] $\mu(A) \le \sum_{k=1}^{\infty} \mu(A_k)$ ogni volta che $A \in \AA$, $\{A_k\}_{k=1}^\infty$ è una successione in $\AA$ e $A \subset \bigcup_{k=1}^{\infty} A_k$.
\end{itemize}
(Si noti che la ($\beta$) ha senso per la definizione di $\sigma$-algebra.) Otteniamo allora una misura $\nu$ su $X$ ponendo, per ogni insieme $B \subset X$,
\[
\nu(B) \equiv \inf\Set{ \mu(A) | A \in \AA,\, B \subset A }. 
\]
\end{lemma}

\begin{proof}
Siano $B,\, \{B_k\}_{k=1}^\infty \subset X$ insiemi arbitrari tali che $B \subset \bigcup_{k=1}^\infty B_k$, e per ogni coppia di interi positivi $k,\, l$ scegliamo $A_k^l \in \AA$ tale che $B_k \subset A_k^l$ e
\[
\mu(A_k^l) \le \nu(B_k) + \frac{1}{2^k l}.
\]
Ovviamente, $\bigcup_{k=1}^\infty A_k^l \in \AA$ e $B \subset \bigcup_{k=1}^\infty A_k^l$ $(l = 1, 2, \ldots)$. Pertanto
\[
\nu(B) \le \mu\left(\bigcup_{k=1}^\infty A_k^l\right) \le \sum_{k=1}^\infty \mu(A_k^l) \le \sum_{k=1}^\infty \nu(B_k) + \frac{1}{l}\sum_{k=1}^\infty \frac{1}{2^k} = \sum_{k=1}^\infty \nu(B_k) + \frac{1}{l},
\] 
per $l = 1, 2, \ldots$ Si faccia tendere $l \to \infty$.\qed
\end{proof}

\begin{teorema}
\label{thm:misura_da_integrale}
Siano $\mu$ una misura su $X$, $\AA$ una $\sigma$-algebra di insiemi $\mu$-misurabili, $f : X \rightarrow [0, \infty]$ una funzione $\mu$-misurabile. Otteniamo allora una misura $\nu$ su $X$ ponendo, per ogni insieme $A \in \AA$,
\[
\nu(A) \equiv \int_A f\, d\mu
\]
e, per un insieme arbitrario $B \subset X$,
\[
\nu(B) \equiv \inf\Set{ \nu(A) | A \in \AA,\, B \subset A }.
\]
\end{teorema}

\begin{proof}
Ovviamente $\nu(\emptyset) = 0$. Siano invece $A,\, \{A_k\}_{k=1}^\infty$ elementi di $\AA$ tali che $A \subset \bigcup_{k=1}^\infty A_k$. Allora
\[
f\chi_A \le \sum_{k=1}^\infty f\chi_{A_k},
\]
sicché per (\ref{cor:convergenza_monotona})
\[
\nu(A) = \int_A f\, d\mu = \int f\chi_A\, d\mu \le \sum_{k=1}^\infty \int f\chi_{A_k}\, d\mu = \sum_{k=1}^\infty \int_{A_k} f\, d\mu = \sum_{k=1}^\infty \nu(A_k).
\]
Dunque $\mu$ soddisfa le proprietà $(\alpha)$ e $(\beta)$ di (\ref{lem:estensione_di_una_misura}); ne segue la tesi.\qed
\end{proof}

\begin{teorema}
\label{thm:assoluta_continuita_integrale}
\index{assoluta continuità dell'integrale}
Sia $f \in L^1(X,\, \mu)$. Allora per ogni $\epsilon > 0$ esiste un $\delta > 0$, dipendente solo da $\epsilon$ e da $f$, tale che per ogni insieme $\mu$-misurabile $A \subset X$
\[
\mu(A) < \delta \qquad\text{ implica }\qquad \int_A \abs{f}\, d\mu < \epsilon.
\]
\end{teorema}

\begin{proof}
Per $k = 1, 2, \ldots$ poniamo
\[
g_k(x) \equiv \begin{cases}
\abs{f(x)} & \text{se $\abs{f(x)} \le k$,}\\
k & \text{altrimenti.}\end{cases}
\]
Allora $\{g_k\}_{k=1}^\infty$ è una successione di funzioni $\mu$-misurabili, e \mymath{g_k = \min(\abs{f},\, k) \le \min(\abs{f},\, k+1) = g_{k+1},}{(k = 1, 2, \ldots)} sicché
\[
g_1 \le \ldots \le g_k \le g_{k+1} \le \ldots;
\]
inoltre, $\lim_{k \to \infty} g_k = \abs{f}$. (Invero, se $\abs{f(x)} \le N < \infty$, si ha $g_k(x) = \abs{f(x)}$ per ogni $k \ge N$; se invece $\abs{f(x)} = \infty$, allora per ogni $k$ risulta $g_k(x) = k$ e quindi $\lim_{k \to \infty} g_k(x) = \infty = \abs{f(x)}$.) Applicando il teorema della convergenza monotona (\ref{thm:convergenza_monotona}) possiamo quindi scrivere
\[
\lim_{k \to \infty} \int g_k\, d\mu = \int \lim_{k \to \infty} g_k\, d\mu = \int \abs{f}\, d\mu. 
\]
Pertanto,
\[
\lim_{k \to \infty} \int (\abs{f} - g_k)\, d\mu = 0,
\]
per cui fissato $\epsilon > 0$ esiste $k_0$ tale che
\[
\int (\abs{f} - g_{k_0})\, d\mu < \frac{1}{2} \epsilon.
\]
Poniamo $\delta \equiv \epsilon/(2k_0)$ e scegliamo un insieme $\mu$-misurabile $A \subset X$ tale che $\mu(A) < \delta$; otterremo così
\[
\int_A g_{k_0}\, d\mu \le \int_A k_0\, d\mu = k_0\mu(A) \le \frac{1}{2}\epsilon.
\]
Ne segue
\[
\int_A \abs{f}\, d\mu = \int_A (\abs{f} - g_{k_0})\, d\mu + \int_A g_{k_0}\, d\mu \le \int (\abs{f} - g_{k_0})\, d\mu + \frac{1}{2}\epsilon < \frac{1}{2}\epsilon + \frac{1}{2}\epsilon = \epsilon,
\]
come volevasi.\qed
\end{proof}

\section{Misure prodotto. Teorema di Fubini}

Siano $X$ e $Y$ insiemi.

\begin{lemma}
Siano $\mu$ una misura su $X$ e $\nu$ una misura su $Y$. Definiamo un'applicazione $\mu \times \nu : 2^{X \times Y} \rightarrow [0,\, \infty]$ ponendo, per ogni $S \subset X \times Y$,
\[
(\mu \times \nu) (S) \equiv \inf \Set {\sum_{k=1}^\infty \mu(A_i)\nu(B_i)} ,
\]
dove l'estremo inferiore è preso su tutte le famiglie di insiemi $\mu$-misurabili $A_i \subset X$ e insiemi $\nu$-misurabili $B_i \subset Y$ $(i = 1, 2, \ldots)$ tali che
\[
S \subset \bigcup_{i=1}^\infty (A_i \times B_i).
\]
Allora $\mu\times\nu$ è una misura su $X \times Y$.
\end{lemma}

\begin{proof}
Siano $S,\, \{S_j\}_{j=1}^\infty \subset X \times Y$ insiemi tali che $S \subset \bigcup_{j=1}^\infty S_j$, e scegliamo per ogni $j$ una successione $\{A_i^j\}_{i=1}^\infty \subset X$ di insiemi $\mu$-misurabili ed una successione $\{B_i^j\}_{i=1}^\infty \subset Y$ di insiemi $\nu$-misurabili tali che $S_j \subset \bigcup_{i=1}^\infty (A_i^j \times B_i^j)$ $(j = 1, 2, \ldots)$. Allora $S \subset \bigcup_{i,\, j = 1}^\infty (A_i^j \times B_i^j)$, sicché per definizione di $\mu\times\nu$ risulta
\[
(\mu\times\nu)(S) \le \sum_{j=1}^\infty \sum_{i=1}^\infty \mu(A_i^j)\nu(B_i^j).
\]
Passando agli estremi inferiori su tutte le famiglie $\{A_i^j \times B_i^j\}_{i=1}^\infty$ $(j = 1, 2, \ldots)$, otteniamo quindi
\mymath{(\mu\times\nu)(S) \le \sum_{j=1}^\infty (\mu\times\nu)(S_j).}{\qedsymbol}
\end{proof}

\begin{definizione}
\label{def:misura_prodotto}
La misura $\mu\times\nu$ è chiamata la \emph{misura prodotto}\index{misura!prodotto} di $\mu$ e $\nu$.
\end{definizione}

\begin{definizione}
\label{def:funzione_sigma_finita}
Una funzione $f : X \rightarrow [-\infty,\, \infty]$ è \emph{$\sigma$-finita rispetto a $\mu$}\index{funzione!$\sigma$-finita} se $f$ è $\mu$-misurabile e $\Set{ x | f(x) \ne 0 }$ è $\sigma$-finito rispetto a $\mu$.
\end{definizione}

\begin{osservazione}
Una funzione $\mu$-sommabile $f : X \rightarrow [-\infty,\, \infty]$ è sempre $\sigma$-finita rispetto a $\mu$. Posto invero $E \equiv \Set{ x | f(x) \ne 0 }$, denotiamo con $B(0,\, k)$, per ogni intero positivo $k$, la palla chiusa di centro l'origine e raggio $k$ e scriviamo \mymath{E_k \equiv B(0,\, k) \cap E.}{(k = 1, 2, \ldots)} Ovviamente ciascun $E_k$ è $\mu$-misurabile; inoltre
\[
\int_{E_k} f\, d\mu \le \int_{B(0,\, k)} f\, d\mu < \infty
\]
in quanto $f$ è $\mu$-sommabile. Ma $f$ è non nulla su $E_k$, sicché \mymath{\mu(E_k) < \infty.}{(k = 1, 2, \ldots)} Avendosi $E = \bigcup_{k=1}^\infty E_k$, $f$ è $\sigma$-finita rispetto a $\mu$.
\end{osservazione}

\begin{teorema2}[Teorema di Fubini]
\label{thm:fubini}
\index{teorema!di Fubini}
Siano $\mu$ una misura su $X$ e $\nu$ una misura su $Y$. Allora:
\begin{itemize}
\item[(i)] $\mu\times\nu$ è una misura regolare su $X \times Y$, anche se $\mu$ e $\nu$ non sono regolari.
\item[(ii)] Se $A \subset X$ è $\mu$-misurabile e $B \subset Y$ è $\nu$-misurabile, allora $A \times B$ è $(\mu\times\nu)$-misurabile e $(\mu\times\nu)(A \times B) = \mu(A)\nu(B).$
\item[(iii)] Se $S \subset X \times Y$ è $\sigma$-finito rispetto a $\mu\times\nu$, allora $S_y \equiv \Set{ x | (x,\, y) \in S }$ è $\mu$-misurabile per $\qogni{y}{\nu}$, $S_x \equiv \Set{ y | (x,\, y) \in S }$ è $\nu$-misurabile per $\qogni{x}{\mu}$, $\mu(S_y)$ è $\nu$-integrabile, e $\nu(S_x)$ è $\mu$-integrabile. Inoltre,
\[
(\mu\times\nu) (S) = \int_Y \mu(S_y)\, d\nu(y) = \int_X \nu(S_x)\, d\mu(x).
\]
\item[(iv)] Se $f$ è $(\mu\times\nu)$-integrabile e $f$ è $\sigma$-finita rispetto a $\mu\times\nu$ (in particolare, se $f$ è $(\mu\times\nu)$-sommabile), allora la funzione
\[
y \mapsto \int_X f(x,\, y)\, d\mu(x)
\]
è $\nu$-integrabile, la funzione
\[
x \mapsto \int_Y f(x,\, y)\, d\nu(y)
\]
è $\mu$-integrabile, e
\begin{align*}
\int_{X \times Y} f\, d(\mu\times\nu) = \int_Y \left[\int_X f(x,\, y)\, d\mu(x)\right] d\nu(y) = \int_X \left[\int_Y f(x,\, y)\, d\nu(y)\right] d\mu(x).
\end{align*}
\end{itemize}
\end{teorema2}

\begin{proof}
\begin{proofsec}
Denotiamo con $\FF$ la famiglia di tutti gli insiemi $S \subset X \times Y$ per i quali la funzione
\[
x \mapsto \chi_S(x,\, y)
\]
è $\mu$-integrabile per ogni $y \in Y$ e la funzione
\[
y \mapsto \int_X \chi_S(x,\, y)\, d\mu(x)
\]
è $\nu$-integrabile. Per $S \in \FF$ scriviamo
\[
\rho(S) \equiv \int_Y \left[\int_X \chi_S(x,\, y)\, d\mu(x)\right] d\nu(y).
\]
Definiamo
\begin{align*}
\PP_0 &\equiv \Set{ A \times B | \text{$A$ è $\mu$-misurabile, B è $\nu$-misurabile} },\\
\PP_1 &\equiv \Set{ \bigcup_{j=1}^\infty S_j | S_j \in \PP_0 },\\
\PP_2 &\equiv \Set{ \bigcap_{j=1}^\infty S_j | S_j \in \PP_1 }.
\end{align*}
\end{proofsec}

\begin{proofsec}
\emph{$\PP_0 \subset \FF$ e $\rho(A \times B) = \mu(A) \nu(B)$ per ogni $A \times B \in \PP_0$.}\hspace{.5em} Siano invero $A \subset X$ $\mu$-misurabile e $B \subset Y$ $\nu$-misurabile. Per ogni $y \in Y$ risulta allora
\[
\chi_{A \times B} (x,\, y) =
\begin{cases}
\chi_A(x) & \text{se $y \in B$}\\
0 & \text{se $y \notin B$,}
\end{cases}
\]
per cui $x \mapsto \chi_{A \times B}(x,\, y)$ è $\mu$-integrabile; inoltre 
\[
\int_X \chi_{A \times B} (x,\, y)\, d\mu(x) =
\begin{cases}
\int_X \chi_A(x)\, d\mu(x) = \mu(A) & \text{se $y \in B$}\\
0 & \text{se $y \notin B$,}
\end{cases}
\]
sicché $y \mapsto \int_X \chi_{A \times B} (x,\, y)\, d\mu(x)$ è $\nu$-integrabile. Pertanto, $A \times B \in \FF$. Si ha poi
\[
\rho(A \times B) = \int_Y \left[\int_X \chi_{A \times B}(x,\, y)\, d\mu(x)\right] d\nu(y) = \int_B \mu(A)\, d\nu(y) = \mu(A) \nu(B).
\]
\end{proofsec}

\begin{proofsec}
\emph{Ogni elemento di $\PP_1$ è unione di una successione \emph{disgiunta} di elementi di $\PP_0$; inoltre $\PP_1 \subset \FF$.}\hspace{.5em} Se $A_1 \times B_1,\, A_2 \times B_2 \in \PP_0$, allora
\[
(A_1 \times B_1) \cap (A_2 \times B_2) = (A_1 \cap A_2) \times (B_1 \cap B_2) \in \PP_0
\]
e
\[
(A_1 \times B_1) - (A_2 \times B_2) = ((A_1 - A_2) \times B_1) \cup ((A_1 \cap A_2) \times (B_1 - B_2))
\]
è un'unione disgiunta di elementi di $\PP_0$. Scegliamo un $R \equiv \bigcup_{j=1}^\infty (A_j \times B_j) \in \PP_1$ e costruiamo una successione $\{A'_j \times B'_j\}_{j=1}^\infty$ ponendo
\begin{align*}
A'_1 \times B'_1 &\equiv A_1 \times B_1\\
A'_2 \times B'_2 &\equiv (A_2 \times B_2) - (A_1 \times B_1)\\
A'_3 \times B'_3 &\equiv A_3 \times B_3 - ((A_1 \times B_1) \cup (A_2 \times B_2))\\
&= ((A_3 \times B_3) - (A_2 \times B_2)) - (A_1 \times B_1)\\
A'_4 \times B'_4 &\equiv A_4 \times B_4 - ((A_1 \times B_1) \cup (A_2 \times B_2) \cup (A_3 \times B_3))\\
&= (((A_4 \times B_4) - (A_3 \times B_3)) - (A_2 \times B_2)) - (A_1 \times B_1)\\
&\:\:\,\vdots\\
A'_k \times B'_k &\equiv (A_k \times B_k) - \bigcup_{j=1}^{k-1} (A_j \times B_j)\\
&= ((\cdots((((A_k \times B_k) - (A_{k-1} \times B_{k-1})) - (A_{k-2} \times B_{k-2})) - \ldots)\cdots) - (A_2 \times B_2)) - (A_1 \times B_1)
\end{align*}
e così via. Essendo ciascun $A'_j \times B'_j$ un'unione \emph{disgiunta} di elementi di $\PP_0$, tale è anche $\bigcup_{j=1}^\infty (A'_j \times B'_j)$; inoltre $R = \bigcup_{j=1}^\infty (A'_j \times B'_j)$. Pertanto, per ogni $y \in Y$,
\[
\chi_R(x,\, y) = \sum_{j=1}^\infty \chi_{A'_j \times B'_j} (x,\, y),\qquad(x \in X)
\]
sicché $\chi_R(x,\, y)$ è $\mu$-integrabile e in virtù di (\ref{cor:convergenza_monotona})
\[
\int_X \chi_R(x,\, y)\, d\mu(x) = \sum_{j=1}^\infty \int_X \chi_{A'_j \times B'_j}\, d\mu(x)
\]
è $\nu$-integrabile, cioè $R \in \FF$. Per l'arbitrarietà di $R \in \PP_1$ risulta allora $\PP_1 \subset \FF$.
\end{proofsec}

\begin{proofsec}
\emph{Ogni elemento di $\PP_2$ è intersezione di una successione \emph{decrescente} di elementi di $\PP_1$; inoltre $\PP_2 \subset \FF$.}\hspace{.5em} Sia invero $\{S_j\}_{j=1}^\infty$ una successione in $\PP_1$, dove $S_j = \bigcup_{i=1}^\infty (A_i^j \times B_i^j)$ per $j = 1, 2, \ldots$ Risulta allora \mymath{\bigcap_{j=1}^k S_j = \bigcap_{j=1}^k \bigcup_{i_j=1}^\infty (A_{i_j}^j \times B_{i_j}^j) = \bigcup_{i_1, \ldots, i_k = 1}^\infty \bigcap_{j=1}^k (A_{i_j}^j \times B_{i_j}^j),}{(k = 1, 2, \ldots)} dove, per quanto osservato nella dimostrazione della (c), ciascun $\bigcap_{j=1}^k (A_{i_j}^j \times B_{i_j}^j) \in \PP_0$. Pertanto $\bigcap_{j=1}^k S_j \in \PP_1$ per $k = 1, 2, \ldots$ e inoltre
\[
\bigcap_{j=1}^\infty S_j = \bigcap_{k=1}^\infty \bigcap_{j=1}^k S_j.
\]
Poniamo allora \mymath{S \equiv \bigcap_{j=1}^{\infty} S_j \qquad\text{ e }\qquad S^{(k)} \equiv \bigcap_{j=1}^k S_j;}{(k = 1, 2, \ldots)} per ogni $y \in Y$ e per ogni intero positivo $k$ la funzione $x \mapsto \chi_{S^{(k)}}(x,\, y)$ è $\mu$-integrabile, sicché tale è anche $\chi_S (x,\, y) = \lim_{k \to \infty} \chi_{S^{(k)}} (x,\, y)$. Inoltre, \mymath{\chi_{S^{(k)}} \le \chi_S,}{(k = 1, 2, \ldots)} per cui il teorema della convergenza dominata (\ref{thm:convergenza_dominata}) ci garantisce che 
\[
\int_X \chi_S(x,\, y)\, d\mu(x) = \lim_{k \to \infty} \int_X \chi_{S^{(k)}} (x,\, y)\, d\mu(x).
\]
La funzione $y \mapsto \int_X \chi_S(x,\, y)\, d\mu(x)$ è pertanto $\nu$-integrabile; di conseguenza, $S \in \FF$.
\end{proofsec}

\begin{proofsec}
\emph{Per ogni $S \subset X \times Y$,}
\[
(\mu\times\nu)(S) = \inf\Set{ \rho(R) | S \subset R \in \PP_1 }.
\]
\emph{In particolare, se $S \in \PP_1$ allora $(\mu\times\nu)(S) = \rho(S)$.}\hspace{.5em} Innanzitutto notiamo che se $S \subset R \equiv \bigcup_{j=1}^\infty A_j \times B_j$, con $\{A_j \times B_j\}_{j=1}^\infty \subset \PP_0$, allora
\[
\chi_R \le \sum_{j=1}^\infty \chi_{A_j \times B_j}
\]
e quindi applicando (\ref{cor:convergenza_monotona})
\[
\rho(R) \le \int_Y \left[\int_X \sum_{j=1}^\infty \chi_{A_j \times B_j}\, d\mu\right] d\nu = \sum_{j=1}^\infty \int_Y \left[\int_X \chi_{A_j \times B_j}\, d\mu\right] d\nu = \sum_{j=1}^\infty \mu(A_j)\nu(B_j).
\]
Pertanto, passando agli estremi inferiori, otteniamo
\[
\inf\Set{ \rho(R) | S \subset R \in \PP_1 } \le (\mu\times\nu)(S).
\]
Inoltre, esiste, per la (c), una successione disgiunta $\{A_j' \times B_j'\}_{j=1}^\infty$ in $\PP_0$ tale che
\[
R = \bigcup_{j=1}^\infty (A_j' \times B_j'),
\]
sicché
\[
\chi_R = \sum_{j=1}^\infty \chi_{A_j \times B_j}
\]
e, di conseguenza,
\[
\rho(R) = \sum_{j=1}^\infty \mu(A_j')\nu(B_j') \ge (\mu\times\nu)(S).
\]
\end{proofsec}

\begin{proofsec}
Fissiamo $A \times B \in \PP_0$. Allora
\[
(\mu\times\nu)(A \times B) \le \mu(A)\nu(B) = \rho(A \times B) \le \rho(R)
\]
per tutti gli $R \in \PP_1$ tali che $A \times B \subset R$. Pertanto la (e) implica
\[
(\mu\times\nu)(A \times B) = \mu(A)\nu(B).
\]
Proviamo ora che $A \times B$ è $(\mu\times\nu)$-misurabile. A tal fine supponiamo che $T \subset X \times Y$ e $T \subset R \equiv \bigcup_{j=1}^\infty (A_j \times B_j) \in \PP_1$. Allora $R - (A \times B)$ e $R \cap (A \times B)$ sono disgiunti e inoltre
\[
R - (A \times B) = \bigcup_{j=1}^\infty ((A_j \times B_j) - (A \times B)) \qquad\text{ e }\qquad R \cap (A \times B) = \bigcup_{j=1}^\infty ((A_j \times B_j) \cap (A \times B)),
\]
sicché $R - (A \times B)$ e $R \cap (A \times B)$ appartengono a $\PP_1$ al pari di $R$. Di conseguenza, per la (e),
\begin{align*}
(\mu\times\nu)(T - (A \times B)) + (\mu\times\nu)(T \cap (A \times B)) \le \rho(R - (A \times B)) + \rho(R \cap (A \times B)) = \rho(R),
\end{align*}
e quindi, ancora per la (e),
\[
(\mu\times\nu)(T - (A \times B)) + (\mu\times\nu)(T \cap (A \times B)) \le (\mu\times\nu)(T).
\]
Pertanto $(A \times B)$ è $(\mu\times\nu)$-misurabile. La (ii) resta così provata.
\end{proofsec}

\begin{proofsec}
\emph{Per ogni $S \subset X \times Y$ esiste un insieme $R \in \PP_2$ tale che $S \subset R$ e}
\[
\rho(R) = (\mu\times\nu) (S).
\]
Se $(\mu\times\nu) (S) = \infty$, poniamo $R \equiv X \times Y$. Se invece $(\mu\times\nu) (S) < \infty$, allora per ogni $j = 1, 2, \ldots$ esiste per la (e) un insieme $R_j \in \PP_1$ tale che $S \subset R_j$ e
\[
(\mu\times\nu)(R_j) = \rho(R_j) < (\mu\times\nu) (S) + \frac{1}{j}.
\]
Definiamo 
\[
R \equiv \bigcap_{j=1}^{\infty} R_j \in \PP_2;
\]
allora $S \subset R$ e inoltre, per la (d), $S \in \FF$. Ancora per la (d) possiamo supporre che la successione $\{R_j\}_{j=1}^\infty$ sia \emph{decrescente}; il teorema della convergenza dominata (\ref{thm:convergenza_dominata}) ci consente allora di passare al limite per $j \to \infty$ nella disuguaglianza
\[
(\mu\times\nu)(S) \le (\mu\times\nu)(R_j) = \rho(R_j) < (\mu\times\nu)(S) + \frac{1}{j}
\]
per ottenere
\[
\rho(R) = (\mu\times\nu)(S).
\]
\end{proofsec}

\begin{proofsec}
Dalla (ii), ricordando (\ref{thm:proprieta_insiemi_misurabili}), vediamo che ogni elemento di $\PP_2$ è $(\mu\times\nu)$-misurabile. Se inoltre $S \subset X \times Y$ è un insieme arbitrario, esiste per la (g) un $R \in \PP_2$ tale che $S \subset R$ e $\rho(R) = (\mu\times\nu)(S)$. Scriviamo $R = \bigcap_{j=1}^\infty R_j$, dove $\{R_j\}_{j=1}^\infty$ è una successione decrescente in $\PP_1$; risulta, per la (e), \mymath{(\mu\times\nu)(R) \le (\mu\times\nu)(R_j) = \rho(R_j),}{(j = 1, 2, \ldots)} sicché passando al limite per $j \to \infty$ e facendo nuovamente appello a (\ref{thm:convergenza_dominata}) otteniamo $(\mu\times\nu)(R) \le \rho(R)$. Pertanto
\[
(\mu\times\nu)(S) \le (\mu\times\nu)(R) \le \rho(R) = (\mu\times\nu)(S),
\]
ossia
\[
(\mu\times\nu)(S) = (\mu\times\nu)(R),
\]
con $R$ insieme $(\mu\times\nu)$-misurabile. La (i) resta così provata.
\end{proofsec}

\begin{proofsec}
Se $S \subset X \times Y$ e $(\mu\times\nu)(S) = 0$, allora per la (g) esiste un insieme $R \in \PP_2$ tale che $S \subset R$ e $\rho(R) = 0$; pertanto $\chi_S(x,\, y) \le \chi_R(x,\, y) = 0$ per $\qogni{x \in X}{\mu}$ e per $\qogni{y \in Y}{\nu}$. Ne segue $S \in \FF$ e $\rho(S) = 0$.

Supponiamo ora che $S \subset X \times Y$ sia $(\mu\times\nu)$-misurabile e che $(\mu\times\nu)(S) < \infty$; esiste, per la (g) e la (h), un $R \in \PP_2$ tale che $S \subset R$ e $(\mu\times\nu)(R - S) = 0$; quindi, per quanto osservato, $R - S \in \FF$ e $\rho(R - S) = 0$. Avendosi $\chi_S = \chi_R - \chi_{S - R}$, l'insieme $S_y$ è 
Pertanto
\[
\mu(S_y) = \mu\Set{ x | (x,\, y) \in S } = \mu\Set{ x | (x,\, y) \in R } = \mu(R_y)
\]
per $\qogni{y \in Y}{\nu}$, e
\[
(\mu\times\nu)(S) = \rho(R) = \int_Y \mu(S_y)\, d\nu(y).
\]
Sia infine $S \subset X \times Y$ $\sigma$-finito rispetto a $\mu\times\nu$. Possiamo allora scrivere $S = \bigcup_{k=1}^\infty S^k$, dove $\{S^k\}_{k=1}^\infty$ è una successione \emph{disgiunta} di insiemi $(\mu\times\nu)$-misurabili e $(\mu\times\nu)(S^k) < \infty$ per $k = 1, 2, \ldots$ Si ha ovviamente, per $y \in Y$,
\[
S_y = \bigcup_{k=1}^\infty S_y^k,
\]
sicché $S_y$ è $\mu$-misurabile per $\qogni{y \in Y}{\nu}$ al pari di ciascun $S_y^k$. Inoltre
\[
\mu(S_y) = \sum_{k=1}^\infty \mu(S_y^k)
\]
è $\nu$-integrabile, tale essendo $\mu(S_y^k)$ $(k = 1, 2, \ldots)$. Infine
\[
(\mu\times\nu)(S) = \sum_{k=1}^\infty (\mu\times\nu)(S^k) = \sum_{k=1}^\infty \int_Y \mu(S_y^k)\, d\nu(y) = \int_Y \sum_{k=1}^\infty \mu(S_y^k)\, d\nu(y),
\]
applicando (\ref{cor:convergenza_monotona}). Ne segue la (iii).
\end{proofsec}

\begin{proofsec}
Osserviamo che la (iv) si riduce alla (iii) quando $f = \chi_S$, con $S \subset X \times Y$ $\sigma$-finito rispetto a $\mu\times\nu$. Supponiamo allora che $f$ sia una funzione $(\mu\times\nu)$-misurabile, $\sigma$-finita rispetto a $\mu\times\nu$ e \emph{non negativa}. In virtù di (\ref{thm:decomposizione_funzione_misurabile_non_negativa}) possiamo scrivere
\[
f = \sum_{k=1}^\infty \frac{1}{k} \chi_{A_k},
\]
dove $\{A_k\}_{k=1}^\infty$ è una successione di insiemi $(\mu\times\nu)$-misurabili. Inoltre, per ogni $k$, $A_k \subset \Set{ x | f(x) \ne 0 }$, sicché ciascun $A_k$ è $\sigma$-finito rispetto a $\mu\times\nu$. Allora (\ref{cor:convergenza_monotona}) ci assicura che
\[
\int_X f(x,\, y)\, d\mu(x) = \sum_{k=1}^\infty \frac{1}{k} \int_X \chi_{A_k} (x,\, y)\, d\mu(x),
\]
ossia, tenendo conto di quanto osservato e della (iii), la funzione
\[
y \mapsto \int_X f(x,\, y)\, d\mu(x)
\]
è limite di una successione di funzioni $\nu$-misurabili e quindi $\nu$-misurabile per (\ref{thm:proprieta_funzioni_misurabili}). Essendo ovviamente non negativa, è anche $\nu$-integrabile. In modo analogo, la funzione
\[
x \mapsto \int_Y f(x,\, y)\, d\nu(y)
\]
è $\mu$-integrabile. Applicando ancora (\ref{cor:convergenza_monotona}) e usando la (iii), otteniamo poi
\begin{align*}
\int_{X \times Y} f\, d(\mu\times\nu) &= \sum_{k=1}^\infty \frac{1}{k} \int_{X \times Y} \chi_{A_k}\, d(\mu\times\nu) = \sum_{k=1}^\infty \frac{1}{k} \int_Y \left[\int_X \chi_{A_k}\, d\mu\right]\, d\nu\\
&= \int_Y \sum_{k=1}^\infty \frac{1}{k} \left[\int_X \chi_{A_k}\, d\mu\right]\, d\nu = \int_Y \left[\int_X f(x,\, y)\, d\mu(x)\right]\, d\nu(y);
\end{align*}
similmente,
\[
\int_{X \times Y} f\, d(\mu\times\nu) = \int_X \left[\int_Y f(x,\, y)\, d\nu(y)\right]\, d\mu(x).
\]
\end{proofsec}

\begin{proofsec}
Infine, per $f$ $(\mu\times\nu)$-integrabile e $\sigma$-finita rispetto a $\mu\times\nu$, ma non necessariamente non negativa, basterà usare la decomposizione 
\[
f = f^+ - f^-,
\]
e applicare la (i). La (iv) è così provata, e ciò completa la dimostrazione del teorema.\qed
\end{proofsec}
\end{proof}

\begin{osservazione}
Si confronti il teorema di Fubini con la formula di coarea (\ref{thm:formula_coarea}), che ne è una sorta di versione ``curvilinea''.
\end{osservazione}

\subsection{Le funzioni $\Gamma$ e $\beta$}

\begin{definizione}
\label{def:funzione_gamma}
Sia $t > 0$. Poniamo \mymath{\Gamma(t) \equiv \int_0^\infty x^{t-1}e^{-x}\, dx.}{(*)} Posto $f(x) = x^{t-1}e^{-x}$, risulta
\[
\int_0^1 f(x)\, dx < \int_0^1 x^{t-1}\, dx = \Bigg[\frac{x^t}{t}\Bigg]_0^1 = 1
\]
in quanto $t > 0$, sicché $f$ è sommabile in 0. D'altra parte, poiché $\lim_{x \to \infty} x^{t+1}e^{-x} = 0$, esiste $M > 0$ tale che $x^{t+1}e^{-x} < 1$ per $x \ge M$ e dunque $f(x) < 1/x^2$ per $x \ge M$, da cui segue
\[
\int_M^\infty f(x)\, dx < \int_M^\infty \frac{1}{x^2}\, dx = \Bigg[-\frac{1}{x}\Bigg]_M^\infty = \frac{1}{M} - \lim_{x \to \infty} \frac{1}{x} = \frac{1}{M}.
\]
Pertanto $f$ è sommabile anche all'infinito. Quindi la funzione definita dalla (*), detta \emph{funzione Gamma}\index{funzione!$\Gamma$}, è sempre finita per $t > 0$.
\end{definizione}

\begin{lemma}
\label{pro:proprieta_funzione_gamma}
\index{proprietà!delle funzioni $\Gamma$ e $\beta$}
\mbox{}
\begin{itemize}
\item[(i)] $\Gamma(1) = 1$.
\item[(ii)] $\Gamma(t+1) = t\Gamma(t)$ per ogni $t > 0$; in particolare per ogni intero positivo $k$ risulta
\[
\Gamma(k+1) = k\Gamma(k) = \ldots = k!\Gamma(1) = k!.
\]
\item[(iii)] $\Gamma\left(\frac{1}{2}\right) = \sqrt{\pi}$.
\end{itemize}
\end{lemma}

\begin{proof}
\begin{proofsec}
La (i) è immediata. La (ii) si ottiene con un'integrazione per parti:
\[
\Gamma(t+1) = \int_0^\infty x^t e^{-x}\, dx = \Big[-x^t e^{-x}\Big]_0^\infty + t\int_0^\infty x^{t-1} e^{-x}\, dx = t\Gamma(t).
\]
\end{proofsec}

\begin{proofsec}
Effettuando il cambio di variabili $x = y^2/2$ in 
\[
\Gamma(t) = \int_0^\infty x^{t-1}e^{-x}\, dx
\]
si ottiene che
\[
\Gamma(t) = 2^{1-t} \int_0^\infty y^{2t-1} e^{-y^2/2}\, dy.
\]
Da questa uguaglianza, indicando con $Q$ il primo quadrante nel piano, si ha facilmente, applicando prima il teorema di Fubini (\ref{thm:fubini}) e successivamente passando in coordinate polari
\[
\left[\Gamma\left(\frac{1}{2}\right)\right]^2 = 2\left(\int_0^\infty e^{-x^2/2}\, dx\right)\left(\int_0^\infty e^{-y^2/2}\, dy\right) = 2\iint_Q e^{-(x^2+y^2)/2}\, dxdy = 2\int_0^{\pi/2} d\theta \int_0^\infty \rho e^{-\rho^2/2}\, d\rho = \pi.
\]
da cui segue
\mymath{\Gamma\left(\frac{1}{2}\right) = \sqrt{\pi}.}{\qedsymbol}
\end{proofsec}
\end{proof}

\begin{definizione}
\label{def:funzione_beta}
Poniamo, per $s,\, t > 0$,
\[
\beta(s,\, t) \equiv 2\int_0^{\pi/2} (\cos\theta)^{2s-1} (\sin\theta)^{2t-1}\, d\theta.
\]
La funzione così definita prende il nome di \emph{funzione Beta}\index{funzione!$\beta$}.
\end{definizione}

\begin{lemma}
\label{pro:proprieta_funzione_beta}
\index{proprietà!delle funzioni $\Gamma$ e $\beta$}
Siano $s,\, t > 0$; allora:
\begin{itemize}
\item[(i)]
\[
\beta(s,\, t) = \frac{\Gamma(s)\Gamma(t)}{\Gamma(s+t)}
\]
(sicché in particolare $\beta(s,\, t) = \beta(t,\, s)$);
\item[(ii)]
\[
\beta(s,\, t) = \int_0^1 x^{s-1} (1-x)^{t-1}\, dx.
\]
\end{itemize}
\end{lemma}
\pagebreak

\begin{proof}
\begin{proofsec}
Con un calcolo analogo a quello fatto nella dimostrazione di (\ref{pro:proprieta_funzione_gamma}), continuando ad indicare con $Q$ il primo quadrante, otteniamo per ogni $s,\, t > 0$
\begin{align*}
\Gamma(s)\Gamma(t) &= 2^{2-s-t}\left(\int_0^\infty x^{2s-1}e^{-x^2/2}\, dx\right) \left(\int_0^\infty y^{2t-1}e^{-y^2/2}\, dy\right)\\
&= 2^{2-s-t}\iint_Q  x^{2s-1} y^{2t-1} e^{-(x^2+y^2)/2}\, dxdy\\
&= 2^{2-s-t}\int_0^\infty \rho^{2(s+t)-1} e^{-\rho^2/2}\, d\rho \int_0^{\pi/2} (\cos\theta)^{2s-1} (\sin\theta)^{2t-1}\, d\theta\\
&= 2\Gamma(s+t) \int_0^{\pi/2} (\cos\theta)^{2s-1} (\sin\theta)^{2t-1}\, d\theta\\
&= \Gamma(s+t)\beta(s,\, t).
\end{align*}
Ne segue subito la (i).
\end{proofsec}

\begin{proofsec}
Per dimostrare la (ii), si effettui il cambio di variabile $x = \cos^2 \theta$ in
\[
\beta(s,\, t) = 2\int_0^{\pi/2} (\cos\theta)^{2s-1} (\sin\theta)^{2t-1}\, d\theta.
\]
Tenendo presente che $dx = -2\cos\theta \sin\theta\, d\theta$, si ottiene
\begin{align*}
\beta(s,\, t) &= 2\int_0^{\pi/2} (\cos\theta)^{2(s-1)}\cos\theta\, (\sin\theta)^{2(t-1)}\sin\theta \, d\theta\\
&= -\int_0^{\pi/2} (\cos^2\theta)^{s-1} (\sin^2\theta)^{t-1} (-2\cos\theta\sin\theta)\, d\theta\\
&= -\int_1^0 x^{s-1} (1-x)^{t-1}\, dx = \int_0^1 x^{s-1} (1-x)^{t-1}\, dx,
\end{align*}
come volevasi.\qed
\end{proofsec}
\end{proof}

\subsection{Il volume della palla $n$-dimensionale}

\begin{notazione}
\label{not:alpha_n}
Nel seguito indicheremo con $\alpha(n)$ la misura di Lebesgue $n$-dimensionale della palla unitaria $B(0,\, 1)$ di $\RR^n$:
\[
\alpha(n) \equiv \Leb^n(B(0,\, 1)).
\]
Si ha naturalmente, per ogni $x \in \RR^n$ e per ogni $r > 0$,
\[
\Leb^n(B(x,\, r)) = r^n\alpha(n).
\]
Inoltre, $\alpha(n) < \infty$ in quanto $\Leb^n$ è una misura di Radon.
\end{notazione}

\begin{teorema2}[Volume della palla unitaria di $\RR^n$]
\label{thm:volume_palla_versione1}
\index{volume!della palla $n$-dimensionale}
Per $n \ge 1$ risulta
\[
\alpha(n) = \frac{\pi^{n/2}}{\Gamma(\frac{n}{2} + 1)}.
\]
\end{teorema2}

\begin{proof}
La dimostrazione verrà fornita in (\ref{thm:volume_palla_versione2}).\qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%
% capitolo secondo %
%%%%%%%%%%%%%%%%%%%%

\chapter{Differenziazione di misure di Radon}

\section{Teoremi di ricoprimento}

Presentiamo in questa sezione i fondamentali teoremi di ricoprimento di Vitali e di Besicovitch. Dei due, quello di Besicovitch è molto più difficile da dimostrare, ma è necessario per studiare misure di Radon arbitrarie su $\RR^n$.

\subsection{Teorema di ricoprimento di Vitali}

\begin{definizioni}
\label{def:ricoprimenti}
\mbox{}
\begin{itemize}
\item[(i)] Una famiglia $\FF$ di palle chiuse in $\RR^n$ è un \emph{ricoprimento}\index{ricoprimento} di un insieme $A \subset \RR^n$ se
\[
A \subset \bigcup_{B \in \FF} B.
\]
\item[(ii)] $\FF$ è un \emph{ricoprimento fine}\index{ricoprimento!fine} di $A$ se, in aggiunta,
\[
\inf\Set{ \diam B | x \in B,\, B \in \FF } = 0
\]
per ogni $x \in A$.
\end{itemize}
\end{definizioni}

\begin{notazione}
Se $B$ è una palla chiusa in $\RR^n$, denoteremo con $\hat{B}$ la palla chiusa concentrica a $B$ con raggio pari a 5 volte il raggio di $B$.
\end{notazione}

\begin{lemma}
\label{lem:famiglia_palle_disgiunte}
Sia $\FF$ una famiglia di palle \emph{disgiunte} in $\RR^n$ con
\[
\inf\Set{ \diam B | B \in \FF} > 0.
\]
Allora $\FF$ è numerabile.
\end{lemma}

\begin{proof}
Sia $D \equiv \inf\Set{ \diam B | B \in \FF}$, e sia $B_k \equiv B(0,\, k)$ la palla chiusa di centro l'origine e raggio $k$ $(k = 1, 2, \ldots)$. Poniamo
\[
\FF_k \equiv \Set{ B \in \FF | B \subset B_k }.
\]
Ovviamente $\FF = \bigcup_{k=1}^\infty \FF_k$; basterà allora provare che ciascun $\FF_k$ è una famiglia finita. Sia invero $\GG_k$ una qualsiasi sottofamiglia \emph{numerabile} di $\FF_k$; allora 
\[
\Leb^n(B_k) \ge \Leb^n\left(\bigcup_{B \in \GG_k} B\right) = \sum_{B \in \GG_k} \Leb^n(B) \ge \sum_{B \in \GG_k} D = D \cdot \Card(\GG_k),
\]
ed avendosi $D > 0$ e $\Leb^n(B_k) < \infty$ deve essere necessariamente $\Card(\GG_k) < \infty$. Pertanto $\FF_k$ è priva di sottofamiglie infinite, ossia è finita.\qed
\end{proof}

\begin{teorema2}[Teorema di ricoprimento di Vitali]
\label{thm:ricoprimento_vitali}
\index{teorema!di ricoprimento di Vitali}
Sia $\FF$ una qualsiasi famiglia di palle chiuse non degeneri in $\RR^n$ con
\[
\sup\Set{ \diam B | B \in \FF} < \infty.
\]
Esiste allora una famiglia \emph{numerabile} $\GG$ di palle \emph{disgiunte} in $\FF$ tale che
\[
\bigcup_{B \in \FF} B \subset \bigcup_{B \in \GG} \hat{B}.
\]
\end{teorema2}

\begin{proof}
\begin{proofsec}
Scriviamo $D \equiv \sup\Set{ \diam B | B \in \FF }$ e poniamo \mymath{\FF_j \equiv \Set { B \in \FF | D/2^j < \diam B \le D/2^{j-1}}.}{(j = 1, 2, \ldots)} Ovviamente, se $B \in \FF$ allora $0 < \diam B \le D$ sicché esiste $j \in \{1, 2, \ldots\}$ tale che $B \in \FF_j$. Pertanto
\[
\FF = \bigcup_{j=1}^\infty \FF_j.
\]
Costruiamo poi ricorsivamente una successione $\{\GG_j\}_{j=1}^\infty$ di sottofamiglie di $\FF$ come segue:
\begin{itemize}
\item[($\alpha$)] Sia $\GG_1$ una qualsiasi famiglia disgiunta massimale di palle in $\FF_1$ (esistente per il lemma di Zorn).
\item[($\beta$)] Assumendo che $\GG_1, \GG_2, \ldots, \GG_{k-1}$ siano state già costruite e facendo nuovamente appello al lemma di Zorn, scegliamo come $\GG_k$ una qualsiasi sottofamiglia disgiunta massimale di
\[
\EE_k \equiv \Set { B \in \FF_k | B \cap B' = \emptyset \text{ per ogni $B' \in \bigcup_{j=1}^{k-1} \GG_j$ } }.
\]
\end{itemize}
Infine, poniamo $\GG \equiv \bigcup_{j=1}^\infty \GG_j$; ovviamente $\GG \subset \FF$.
\end{proofsec}

\begin{proofsec}
Osserviamo che ciascun $\GG_j$ è numerabile per (\ref{lem:famiglia_palle_disgiunte}), sicché tale è $\GG$. Inoltre, $\GG$ è una famiglia \emph{disgiunta}. Se infatti $B_1,\, B_2 \in \GG$ con $B_1 \ne B_2$, esistono $k_1,\, k_2$ tali che $B_1 \in \GG_{k_1}$ e $B_2 \in \GG_{k_2}$. Supponiamo, senza ledere la generalità, $k_1 \le k_2$.

Se $k_1 = k_2$, allora $B_1$ e $B_2$ appartengono entrambi a $\GG_{k_1} = \GG_{k_2}$ che è una famiglia disgiunta, per cui $B_1	\cap B_2 = \emptyset$.

Se invece $k_1 < k_2$, allora $B_1 \in \bigcup_{j=1}^{k_2 - 1} \GG_j$ e quindi, per come è stata costruita $\GG_{k_2}$, si ha anche in questo caso $B_1 \cap B_2 = \emptyset$.
\end{proofsec}

\begin{proofsec}
\emph{Per ogni $B \in \FF$, esiste una palla $B' \in \GG$ tale che $B \cap B' \ne \emptyset$ e $B \subset \hat{B}'$.}\hspace{.5em} Fissiamo $B \in \FF$; esiste allora un indice $k$ tale che $B \in \FF_k$. Se fosse $B \cap B' = \emptyset$ per ogni $B' \in \bigcup_{j=1}^k \GG_j$, potremmo aggiungere $B$ a $\GG_k$ ottenendo ancora una sottofamiglia disgiunta di $\EE_k$. Ma questo è impossibile per la massimalità di $\GG_k \subset \EE_k$.
Dunque esiste $B' \in \bigcup_{j=1}^k \GG_j$ tale che $B \cap B' \ne \emptyset$. Ma allora $B' \in \bigcup_{j=1}^k \FF_j$, sicché  $\diam B' \ge D/2^k$; d'altra parte, essendo $B \in \FF_k$ si ha anche $\diam B \le D/2^{k-1}$, per cui $\diam B \le 2\diam B'$. Siano $r$ ed $r'$ i raggi di $B$ e $B'$ e $a,\, a'$ i rispettivi centri; fissiamo inoltre $x \in B \cap B'$. Allora, per ogni $y \in B$,
\[
\abs{y - a'} \le \abs{y - a} + \abs{a - x} + \abs{x - a'} \le r + r + r' \le 2r' + 2r' + r' = 5r',
\]
cioè $y \in \hat{B}'$. Per l'arbitrarietà di $y$, $B \subset \hat{B}'$, ed il teorema è provato.\qed
\end{proofsec}
\end{proof}

\begin{corollario}
\label{cor:vitali_1}
Assumiamo che $\FF$ sia un ricoprimento fine di $A \subset \RR^n$ costituito da palle chiuse e che
\[
\sup\Set{ \diam B | B \in \FF } < \infty.
\]
Esiste allora una famiglia numerabile $\GG$ di palle disgiunte in $\FF$ tale che per ogni sottofamiglia finita $\{B_1, \ldots, B_m\} \subset \FF$ si abbia
\[
A - \bigcup_{k=1}^m B_k \subset \bigcup_{B \in \GG - \{B_1, \ldots, B_m\}} \hat{B}.
\]
\end{corollario}

\begin{proof}
Si costruisca $\GG$ come nella dimostrazione del teorema e si scelga $\{B_1, \ldots, B_m\} \subset \FF$. Se $A \subset \bigcup_{k=1}^m B_k$, allora $A - \bigcup_{k=1}^m B_k = \emptyset$ e abbiamo finito.

Altrimenti, sia $x \in A - \bigcup_{k=1}^m B_k$. Siccome le palle in $\FF$ sono chiuse, $U \equiv \RR^n - \bigcup_{k=1}^m B_k$ è un aperto ed esiste $r > 0$ tale che la palla chiusa $B(x,\, r)$ di centro $x$ e raggio $r$ sia inclusa in $U$. Ma $\FF$ è un ricoprimento \emph{fine}, onde esiste anche $r_1 \le r$ tale che $B \equiv B(x,\, r_1) \in \FF$.

Dal momento che $B \in \FF$, per la (c) nella dimostrazione del teorema esiste una palla $B' \in \GG$ tale che $B \cap B' \ne \emptyset$ e $B \subset \hat{B}'$. Ma, essendo $r_1 \le r$, si ha $B \subset B(x,\, r) \subset U$ sicché $B \cap B_k = \emptyset$ per $k = 1, \ldots, m$; pertanto $B'$ deve appartenere a $\GG - \{B_1, \ldots, B_m\}$. Quindi
\[
x \in \bigcup_{B \in \GG - \{B_1, \ldots, B_m\}} \hat{B},
\]
onde per l'arbitrarietà di $x \in A - \bigcup_{k=1}^m B_k$ si ottiene l'asserto.\qed
\end{proof}

\noindent Mostriamo ora che possiamo ``riempire'', nel senso della misura, un aperto arbitrario per mezzo di una famiglia numerabile di palle chiuse disgiunte.

\begin{corollario}
\label{cor:vitali_2}
Siano $U \subset \RR^n$ aperto, $\delta > 0$. Esiste allora una famiglia numerabile $\GG$ di palle chiuse disgiunte in $U$ tale che $\diam B < \delta$ per ogni $B \in \GG$ e
\[
\Leb^n\left(U - \bigcup_{B \in \GG} B\right) = 0.
\]
(Si confronti con (\ref{cor:besicovitch}), che sostituisce $\Leb^n$ con una misura di Radon arbitraria.)
\end{corollario}

\begin{proof}
\begin{proofsec}
Assumiamo dapprima che $\Leb^n(U) < \infty$, e fissiamo $1 - 1/5^n < \theta < 1$. Sia $\FF$ la famiglia di \emph{tutte} le palle chiuse non degeneri di $\RR^n$.
\end{proofsec}

\begin{proofsec}
\emph{Esiste una famiglia finita $\{B_i\}_{i=1}^{M_1}$ di palle chiuse disgiunte in $U$ tali che $\diam B_i < \delta$ $(i = 1, \ldots, M_1)$ e} \mymath{\Leb^n\left(U - \bigcup_{i=1}^{M_1} B_i\right) \le \theta\Leb^n(U).}{(*)} Sia $\FF_1 \equiv \Set{ B \in \FF | B \subset U,\, \diam B < \delta }$. Essendo $U$ aperto si ha ovviamente $U = \bigcup_{B \in \FF_1} B$, sicché il teorema ci garantisce l'esistenza di una famiglia disgiunta numerabile $\GG_1 \subset \FF_1$ tale che
\[
U \subset \bigcup_{B \in \GG_1} \hat{B}.
\]
Pertanto
\[
\Leb^n(U) \le \sum_{B \in \GG_1} \Leb^n(\hat{B}) = 5^n \sum_{B \in \GG_1} \Leb^n(B) = 5^n \Leb^n \left(\bigcup_{B \in \GG_1} B\right).
\]
Ne segue
\[
\Leb^n \left(\bigcup_{B \in \GG_1} B\right) \ge \frac{1}{5^n} \Leb^n (U),
\]
da cui
\begin{align*}
\Leb^n(U) &= \Leb^n \left(U \cap \bigcup_{B \in \GG_1} B\right) + \Leb^n \left(U - \bigcup_{B \in \GG_1} B\right)\\
&= \Leb^n \left(\bigcup_{B \in \GG_1} B\right) + \Leb^n \left(U - \bigcup_{B \in \GG_1} B\right) \ge \frac{1}{5^n} \Leb^n(U) + \Leb^n \left(U - \bigcup_{B \in \GG_1} B\right);
\end{align*}
essendo $\Leb^n(U) < \infty$ otteniamo
\[
\left(1 - \frac{1}{5^n}\right) \Leb^n (U) \ge \Leb^n \left(U - \bigcup_{B \in \GG_1} B\right),
\]
e quindi anche
\[
\Leb^n \left(U - \bigcup_{B \in \GG_1} B\right) < \theta\Leb^n(U).
\]
(Nel caso $\Leb^n(U) = 0$ l'asserto è banale.) Se ora $\GG_1$ è finito, posto
\[
M_1 \equiv \Card(\GG_1) \qquad\text{ e }\qquad \{B_1, \ldots, B_{M_1}\} \equiv \GG_1
\]
abbiamo subito la (*). Se invece $\GG_1$ è infinito (ma comunque numerabile), dettane $\{B_j\}_{j=1}^\infty$ una enumerazione si ha
\[
\lim_{l \to \infty} \Leb^n \left(U - \bigcup_{j=1}^l B_j\right) = \Leb^n \left(U - \bigcup_{j=1}^\infty B_j\right) < \theta\Leb^n(U),
\]
sicché anche in questo caso esistono palle $B_1, \ldots, B_{M_1}$ in $\GG_1$ che soddisfano la (*).
\end{proofsec}

\begin{proofsec}
Siano ora
\begin{align*}
U_2 &\equiv U - \bigcup_{i=1}^{M_1} B_i,\\
\FF_2 &\equiv \Set{ B \in \FF | B \subset U_2,\, \diam B < \delta }.
\end{align*}
Si osservi che $U_2$ è aperto al pari di $U$; possiamo allora applicare a $U_2$ il ragionamento fatto per $U$ e trovare una famiglia finita $\{B_i\}_{i={M_1+1}}^{M_2}$ di palle disgiunte in $\FF_2$ tali che
\[
\Leb^n \left(U_2 - \bigcup_{i=M_1 + 1}^{M_2} B_i\right) \le \theta\Leb^n(U_2).
\]
Ne segue
\[
\Leb^n \left(U - \bigcup_{i=1}^{M_2} B_i\right) = \Leb^n \left(U_2 - \bigcup_{i=M_1 + 1}^{M_2} B_i\right)\le \theta\Leb^n(U_2) \le \theta^2\Leb^n(U).
\]
\end{proofsec}

\begin{proofsec}
Iteriamo questo processo per $k \to \infty$: posto per comodità $M_0 \equiv 0$, otterremo una successione crescente $\{M_k\}_{k=0}^\infty$ di indici ed una famiglia numerabile
\[
\{B_j\}_{j=1}^\infty \equiv \bigcup_{k=0}^\infty \{B_j\}_{j=M_k + 1}^{M_{k+1}}
\]
di palle chiuse tali che \mymath{\Leb^n \left(U - \bigcup_{i=1}^{M_k} B_i\right) \le \theta^k \Leb^n (U).}{(k = 1, 2, \ldots)} Inoltre, $\{B_j\}_{j=1}^\infty$ è una famiglia \emph{disgiunta}. Invero ciascuna $\{B_j\}_{j=M_k + 1}^{M_{k+1}}$ è una sottofamiglia disgiunta di $\FF_{k+1}$ e, per la costruzione effettuata, $\FF_h \cap \FF_l = \emptyset$ se $h \ne l$. Siccome poi $\theta^k \to 0$ per $k \to \infty$, il corollario è dimostrato se $\Leb^n (U) < \infty$.
\end{proofsec}

\begin{proofsec}
Nel caso $\Leb^n (U) = \infty$, applichiamo il ragionamento precedente agli aperti limitati \mymath{U_m \equiv \Set{ x \in U | m < \abs{x} < m + 1 },}{(m = 0, 1, \ldots)} ottenendo per ogni $m$ una famiglia numerabile $\GG_m$ di palle chiuse disgiunte incluse in $U_m$ tali che $\diam B < \delta$ per ogni $B \in \GG_m$ e
\[
\Leb^n \left(U_m - \bigcup_{B \in \GG_m} B\right) = 0.
\]
Poniamo $\GG \equiv \bigcup_{m = 0}^\infty \GG_m$. Allora $\GG$ è una famiglia numerabile di palle disgiunte (in quanto gli aperti $U_m$ sono disgiunti) e inoltre
\[
\Leb^n \left(\bigcup_{m=0}^\infty U_m - \bigcup_{B \in \GG} B\right) \le \Leb^n \left(\bigcup_{m=0}^\infty \left(U_m - \bigcup_{B \in \GG_m} B\right)\right) \le \sum_{m=0}^\infty \Leb^n \left(U_m - \bigcup_{B \in \GG_m} B\right) = 0.
\]
Avendosi ovviamente
\[
U - \bigcup_{B \in \GG} B \subset \left(\bigcup_{m=0}^\infty U_m - \bigcup_{B \in \GG} B\right) \cup \{0\},
\]
l'asserto è provato.\qed
\end{proofsec}
\end{proof}

\subsection{Teorema di ricoprimento di Besicovitch}

Cominciamo col dimostrare un lemma tecnico.

\begin{lemma}
\label{lem:ricoprimento_besicovitch}
Sia $\{B_j \equiv B(a_j, r_j)\}$ una famiglia numerabile di palle chiuse non degeneri in $\RR^n$, con la proprietà che
\begin{itemize}
\item[($\alpha$)] $a_i \in B_j$ implica $i < j$, e
\item[($\beta$)] $i < j$ implica $r_i \ge \frac{3}{4} r_j$.
\end{itemize}
Si fissi $k > 1$ e si ponga
\[
J \equiv \Set{ j | 1 \le j < k,\, B_j \cap B_k \ne \emptyset,\, r_j > 3r_k }.
\]
Esiste allora una costante $L_n$, dipendente solo da $n$, tale che $\Card(J) \le L_n$.
\end{lemma}

\begin{proof}
\begin{proofsec}
Siano $i,\, j \in J$, con $i \ne j$. Allora $1 \le i,\,j < k$, $B_i \cap B_k \ne \emptyset$, $B_j \cap B_k \ne \emptyset$, $r_i > 3r_k$, $r_j > 3r_k$. Per semplicità di notazione, assumiamo (senza ledere la generalità) $a_k = 0$. Sia $0 \le \theta \le \pi$ l'angolo tra i vettori $a_i$ e $a_j$. Vogliamo trovare una minorazione per $\theta$, e a tal fine cominciamo con il raccogliere alcune osservazioni. 

Siccome $i,\, j < k$, per l'ipotesi ($\alpha$) $0 = a_k \notin B_i \cup B_j$. Quindi $r_i < \abs{a_i}$ e $r_j < \abs{a_j}$. Siccome $B_i \cap B_k \ne \emptyset$ e $B_j \cap B_k \ne \emptyset$, $\abs{a_i} \le r_i + r_k$ e $\abs{a_j} \le r_j + r_k$. Infine, ancora senza ledere la generalità possiamo assumere $\abs{a_i} \le \abs{a_j}$. Riassumendo,
\[
\left\{\begin{array}{l}
3r_k < r_i < \abs{a_i} \le r_i + r_k\\
3r_k < r_j < \abs{a_j} \le r_j + r_k\\
\abs{a_i} \le \abs{a_j}.
\end{array}\right.
\]
\end{proofsec}

\begin{proofsec}
\emph{Se $\cos \theta > 5/6$, allora $a_i \in B_j$.}\hspace{.5em} Supponiamo dapprima $\abs{a_i - a_j} \ge \abs{a_j}$; allora $\abs{a_j}^2 - \abs{a_i - a_j}^2 \le 0$, onde il teorema di Carnot dà
\[
\cos\theta = \frac{\abs{a_i}^2 + \abs{a_j}^2 - \abs{a_i - a_j}^2}{2\abs{a_i}\abs{a_j}} \le \frac{\abs{a_i}^2}{2\abs{a_i}\abs{a_j}} = \frac{\abs{a_i}}{2\abs{a_j}} \le \frac{1}{2}.
\]
Ma $1/2 < 5/6$, sicché da $\cos\theta > 5/6$ segue necessariamente $\abs{a_i - a_j} \le \abs{a_j}$. Poniamoci dunque in questa ipotesi e supponiamo, per assurdo, $a_i \notin B_j$. Allora $\abs{a_i - a_j} > r_j$ e quindi
\begin{align*}
\cos\theta &= \frac{\abs{a_i}^2 + \abs{a_j}^2 - \abs{a_i - a_j}^2}{2\abs{a_i}\abs{a_j}} = \frac{\abs{a_i}^2}{2\abs{a_i}\abs{a_j}} + \frac{\abs{a_j}^2 - \abs{a_i - a_j}^2}{2\abs{a_i}\abs{a_j}}\\
&= \frac{\abs{a_i}}{2\abs{a_j}} + \frac{(\abs{a_j} - \abs{a_i - a_j})(\abs{a_j} + \abs{a_i - a_j})}{2\abs{a_i}\abs{a_j}} \le \frac{1}{2} + \frac{(\abs{a_j} - \abs{a_i - a_j})(2\abs{a_j})}{2\abs{a_i}\abs{a_j}} = \frac{1}{2} + \frac{\abs{a_j} - \abs{a_i - a_j}}{\abs{a_i}}.
\end{align*}
Ricordando poi che
\[
\abs{a_j} \le r_j + r_k,\qquad \abs{a_i - a_j} \ge r_j,\qquad \abs{a_i} \ge r_i,\qquad 3r_k \le r_i
\]
otteniamo
\[
\cos\theta = \frac{1}{2} + \frac{\abs{a_j} - \abs{a_i - a_j}}{\abs{a_i}} \le \frac{1}{2} + \frac{r_j + r_k - r_j}{r_i} = \frac{1}{2} + \frac{r_k}{r_i} \le \frac{1}{2} + \frac{\frac{1}{3}r_i}{r_i} = \frac{1}{2} + \frac{1}{3} = \frac{5}{6},
\]
contro l'ipotesi $\cos\theta > 5/6$. Deve essere allora $a_i \in B_j$.
\end{proofsec}

\begin{proofsec}
\emph{Se $a_i \in B_j$, allora}
\[
0 \le \abs{a_i - a_j} + \abs{a_i} - \abs{a_j} \le \abs{a_j}\epsilon(\theta),
\]
\emph{con}
\[
\epsilon(\theta) \equiv \frac{8}{3}(1 - \cos\theta).
\]
Osserviamo dapprima che $\abs{a_j} \le \abs{a_j - a_i} + \abs{a_i}$, da cui segue $\abs{a_i - a_j} + \abs{a_i} - \abs{a_j} \ge 0$. Per dimostrare la minorazione, notiamo che, siccome $a_i \in B_j$, deve essere per l'ipotesi ($\alpha$) $i < j$; quindi $a_j \notin B_i$ e così $\abs{a_i - a_j} > r_i$. Inoltre, ricordando che $\abs{a_i} \le \abs{a_j}$, otteniamo
\[
\frac{\abs{a_i - a_j} - \abs{a_i} + \abs{a_j}}{\abs{a_i - a_j}} \ge \frac{\abs{a_i - a_j}}{\abs{a_i - a_j}} = 1.
\]
Ma allora
\begin{align*}
0 &\le \frac{\abs{a_i - a_j} + \abs{a_i} - \abs{a_j}}{\abs{a_j}} \le \frac{\abs{a_i - a_j} + \abs{a_i} - \abs{a_j}}{\abs{a_j}} \cdot \frac{\abs{a_i - a_j} - \abs{a_i} + \abs{a_j}}{\abs{a_i - a_j}}\\
&= \frac{\abs{a_i - a_j}^2 - \Big(\abs{a_j} - \abs{a_i}\Big)^2}{\abs{a_j}\abs{a_i - a_j}} = \frac{\Big(\abs{a_i}^2 + \abs{a_j}^2 - 2\abs{a_i}\abs{a_j}\cos\theta\Big) - \Big(\abs{a_i}^2 + \abs{a_j}^2 - 2\abs{a_i}\abs{a_j}\Big)}{\abs{a_j}\abs{a_i - a_j}}\\
&= \frac{2\abs{a_i}\abs{a_j}(1 - \cos\theta)}{\abs{a_j}\abs{a_i - a_j}} = \frac{2\abs{a_i}(1 - \cos\theta)}{\abs{a_i - a_j}} \le \frac{2(r_i + r_k)(1 - \cos\theta)}{r_i} \le \frac{2(1 + \frac{1}{3}) r_i (1 - \cos\theta)}{r_i} = \epsilon(\theta). 
\end{align*}
\end{proofsec}

\begin{proofsec}
\emph{Se $a_i \in B_j$, allora $\cos\theta \le 61/64$.}\hspace{.5em} Come prima, $a_i \in B_j$ implica $i < j$ e $a_j \notin B_i$, e quindi $r_i < \abs{a_i - a_j} \le r_j$. Siccome $i < j$, l'ipotesi ($\beta$) assicura $r_i \ge (3/4)r_j$.  Pertanto,
\begin{align*}
\abs{a_i - a_j} + \abs{a_i} - \abs{a_j} &\ge r_i + r_i - r_j - r_k \ge 2 \cdot \frac{3}{4}r_j - r_j - r_k = \frac{1}{2}r_j - r_k\\
&\ge \frac{1}{2}r_j - \frac{1}{3}r_j = \frac{1}{6}r_j = \frac{1}{6} \cdot \frac{3}{4} \cdot \left(\frac{4}{3} r_j\right) = \frac{1}{8} \left(r_j + \frac{1}{3}r_j\right) \ge \frac{1}{8}(r_j + r_k) \ge \frac{1}{8} \abs{a_j}.
\end{align*}
Quindi, per la (c),
\[
\frac{1}{8}\abs{a_j} \le \abs{a_i - a_j} + \abs{a_i} - \abs{a_j} \le \abs{a_j} \epsilon(\theta),
\]
ossia
\[
\frac{1}{8} \le \frac{8}{3}(1 - \cos\theta).
\]
Ne segue $\cos\theta \le 61/64$.
\end{proofsec}

\begin{proofsec}
\emph{Per tutti gli $i,\, j \in J$ con $i \ne j$, sia $0 \le \theta \le \pi$ l'angolo tra i vettori $a_i - a_k$ e $a_j - a_k$. Allora}
\[
\theta \ge \arccos 61/64 \equiv \theta_0 > 0.
\]
Distinguiamo due casi.
\begin{itemize}
\item[($\alpha$)] Se $\cos\theta > 5/6$, allora per la (b) $a_i \in B_j$, sicché per la (d) $\cos\theta \le 61/64$.
\item[($\beta$)] Sia invece $\cos\theta \le 5/6$. Allora, essendo $5/6 < 61/64$, si ha anche in questo caso $\cos\theta \le 61/64$.
\end{itemize}
Ricordando ora che $\arccos$ è una funzione strettamente decrescente, otteniamo
\[
\theta \ge \arccos 61/64 > \arccos 1 = 0.
\]
\end{proofsec}

\begin{proofsec}
\emph{Esiste una costante $L_n$, dipendente solo da $n$, tale che $\Card(J) \le L_n$.}\hspace{.5em} Cominciamo col fissare $r_0 > 0$ in modo tale che, se $x \in \boundary{B(0,\, 1)}$ e $y,\, z \in B(x,\, r_0)$, allora l'angolo tra i vettori $y$ e $z$ sia minore della costante $\theta_0$ definita nella (e). Scegliamo poi un intero positivo $L_n$ tale che per ricoprire $\boundary{B(0,\, 1)}$ bastino $L_n$ palle di raggio $r_0$ e centri su $\boundary{B(0,\, 1)}$, ma non ne bastino $L_n - 1$.

Ovviamente, $L_n$ dipende solo da $n$. Ci resta da dimostrare che $\Card(J) \le L_n$. E invero, per la scelta di $L_n$, $\boundary{B_k}$ può essere coperto con $L_n$ palle di raggio $r_0 r_k$, con centri su $\boundary{B_k}$. Per la (e), se $i,\, j \in J$ con $i \ne j$, allora l'angolo tra $a_i - a_k$ e $a_j - a_k$ è $\ge \theta_0$. Pertanto, per la costruzione di $r_0$, i raggi $a_j - a_k$ e $a_i - a_k$ non possono attraversare entrambi la stessa palla centrata su $\boundary{B_k}$.  Di conseguenza, $\Card(J) \le L_n$.\qed
\end{proofsec}
\end{proof}

\begin{teorema2}[Teorema di ricoprimento di Besicovitch]
\label{thm:ricoprimento_besicovitch}
\index{teorema!di ricoprimento di Besicovitch}
Esiste una costante $N_n$, dipendente solo da $n$, con la seguente proprietà: Se $\FF$ è una qualsiasi famiglia di palle chiuse non degeneri in $\RR^n$ con
\[
\sup\Set{ \diam B | B \in \FF } < \infty
\]
e se $A$ è l'insieme dei centri delle palle in $\FF$, allora esistono $\GG_1, \ldots, \GG_{N_n}$ tali che ciascun $\GG_i$ $(i = 1, \ldots, N_n)$ sia una famiglia \emph{numerabile} di palle \emph{disgiunte} in $\FF$ e
\[
A \subset \bigcup_{i=1}^{N_n} \bigcup_{B \in \GG_i} B.
\]
\end{teorema2}

\begin{proof}
\begin{proofsec}
Supponiamo dapprima che $A$ sia limitato, e scriviamo $D \equiv \sup\Set{ \diam B | B \in \FF }$. Scegliamo una qualsiasi palla $B_1 = B(a_1,\, r_1) \in \FF$ tale che $r_1 \ge 3/4 \cdot D/2$. Scegliamo poi ricorsivamente $B_j$, $j \ge 2$, come segue. Assumendo di aver già scelto $B_1, \ldots, B_{j-1}$, poniamo $A_j \equiv A - \bigcup_{i=1}^{j-1} B_i$, e distinguiamo due casi:
\begin{itemize}
\item[($\alpha)$] se $A_j = \emptyset$, ci arrestiamo e poniamo $J \equiv j - 1$;
\item[($\beta)$] se invece $A_j \ne \emptyset$, scegliamo $B_j = B(a_j,\, r_j) \in \FF$ tale che $a_j \in A_j$ e
\[
r_j \ge 3/4 \sup\Set{ r | B(a,\, r) \in \FF,\, a \in A_j }.
\]
\end{itemize}
Se $A_j \ne \emptyset$ per ogni $j$, poniamo $J \equiv \infty$.
\end{proofsec}

\begin{proofsec}
\emph{$a_i \in B_j$ implica $i < j$.}\hspace{.5em} Segue subito dalla costruzione della famiglia $\{B_k\}_{k=1}^J$.
\end{proofsec}

\begin{proofsec}
\emph{Se $j > i$, allora $r_i \ge (3/4)r_j$.}\hspace{.5em} Supponiamo $j > i$. Allora $a_j \in A_j \subset A_i$, e quindi
\[
r_i \ge \frac{3}{4} \sup\Set{ r | B(a,\, r) \in \FF,\, a \in A_i } \ge \frac{3}{4}r_j.
\]
\end{proofsec}

\begin{proofsec}
\emph{Le palle $\{B(a_j,\, r_j/3)\}_{j=1}^J$ sono disgiunte.}\hspace{.5em} Sia $j > i$. Allora per la (b) $a_j \notin B_i$ e per la (c) $r_i \ge (3/4)r_j$; quindi
\[
\abs{a_i - a_j} > r_i = \frac{r_i}{3} + \frac{2r_i}{3} \ge \frac{r_i}{3} + \frac{2}{3} \cdot \left(\frac{3}{4} r_j\right) = \frac{r_i}{3} + \frac{r_j}{2} > \frac{r_i}{3} + \frac{r_j}{3}.
\]
Dunque la distanza tra i centri è maggiore della somma dei raggi, e
\[
B(a_i,\, r_i/3) \cap B(a_j,\, r_j/3) = \emptyset.
\]
\end{proofsec}

\begin{proofsec}
\emph{Se $J = \infty$, allora $\lim_{j \to \infty} r_j = 0$.}\hspace{.5em} Osserviamo innanzitutto che
\[
E \equiv \bigcup_{j=1}^\infty B(a_j,\, r_j/3)
\]
è limitato. Se, invero, $x,\, y \in E$, esistono $j_1,\, j_2$ tali che $x \in B(a_{j_1},\, r_{j_1}/3)$ e $y \in B(a_{j_2},\, r_{j_2}/3)$. Pertanto
\[
\abs{x - y} \le \abs{x - a_{j_1}} + \abs{a_{j_1} - a_{j_2}} + \abs{a_{j_2} - y} \le \frac{r_{j_1}}{3} + \diam A + \frac{r_{j_2}}{3} \le \frac{D}{6} + \diam A + \frac{D}{6} < \infty,
\]
in quanto $\diam A < \infty$ essendo, per l'ipotesi fatta, $A$ limitato. Quindi $E$ è limitato.

Se ora non fosse $\lim_{j \to \infty} r_j = 0$ allora, per un opportuno $\epsilon > 0$ e per $h = 1, 2, \ldots$, esisterebbe $j_h \ge h$ tale da aversi $r_{j_h} \ge \epsilon$. Siccome per la (d) le palle $\{B(a_j,\, r_j/3)\}_{j=1}^J$ sono disgiunte, si avrebbe
\[
\Leb^n\left(\bigcup_{h=1}^\infty B(a_{j_h},\, r_{j_h}/3)\right) = \sum_{h=1}^\infty \Leb^n(B(a_{j_h},\, r_{j_h}/3)) = \sum_{h=1}^\infty \alpha(n) \left(\frac{r_{j_h}}{3}\right)^n \ge \frac{\alpha(n)}{3^n} \sum_{h=1}^\infty \epsilon^n = \infty;
\]
\emph{a fortiori}, $\Leb^n(E) = \infty$. Ma, essendo $E$ limitato, questo è impossibile.
\end{proofsec}

\begin{proofsec}
\emph{Risulta $A \subset \bigcup_{j=1}^J B_j$.}\hspace{.5em} Se $J < \infty$, allora per la costruzione di $\{B_j\}_{j=1}^J$ si ha $A - \bigcup_{j=1}^J B_j = \emptyset$ e quindi $A \subset \bigcup_{j=1}^J B_j$. Supponiamo invece $J = \infty$. Se $\bar{a} \in A$, esiste un $\bar{r} > 0$ tale che $B(\bar{a},\, \bar{r}) \in \FF$. Allora per la (e) esiste un $r_j$ tale che $r_j < (3/4)\bar{r}$, e siccome, per costruzione,
\[
r_j \ge \frac{3}{4} \sup\Set{ r | B(a,\, r) \in \FF,\, a \in A - \bigcup_{i=1}^{j-1} B_i },
\]
deve essere necessariamente $\bar{a} \in \bigcup_{i=1}^{j-1} B_i$.
\end{proofsec}

\begin{proofsec}
Si fissi $k > 1$ e si ponga $I \equiv \Set{ j | 1 \le j < k,\, B_j \cap B_k \ne \emptyset }$; vogliamo trovare una maggiorazione per $\Card(I)$. A tal fine, cominciamo col porre $K \equiv I \cap \Set{ j | r_j \le 3r_k }$ e stimiamo $\Card(K)$.
\end{proofsec}

\begin{proofsec}
$\Card(K) \le 20^n$.\hspace{.5em} Sia $j \in K$. Allora per la definizione di $K$ si ha $B_j \cap B_k \ne \emptyset$, da cui $\abs{a_j - a_k} \le r_j + r_k$; inoltre $r_j \le 3r_k$. Scegliamo un qualsiasi $x \in B(a_j,\, r_j/3)$. Allora
\[
\abs{x - a_k} \le \abs{x - a_j} + \abs{a_j - a_k} \le \frac{r_j}{3} + r_j + r_k = \frac{4}{3}r_j + r_k \le \frac{4}{3}(3r_k) + r_k = 4r_k + r_k = 5r_k,
\]
così che $B(a_j,\, r_j/3) \subset B(a_k,\, 5r_k)$. Si ricordi dalla (d) che le palle $\{B(a_j,\, r_j/3)\}_{j=1}^J$ sono disgiunte. Allora
\begin{align*}
\alpha(n) 5^n r_k^n &= \Leb^n(B(a_k,\, 5r_k)) \ge \sum_{j \in K} \Leb^n(B(a_j,\, r_j/3))\\
&= \sum_{j \in K} \alpha(n) \left(\frac{r_j}{3}\right)^n \ge \sum_{j \in K} \alpha(n) \left(\frac{1}{3} \cdot \frac{3r_k}{4}\right)^n = \sum_{j \in K} \alpha(n) \left(\frac{r_k}{4}\right)^n = \alpha(n) \frac{r_k^n}{4^n} \cdot \Card(K).
\end{align*}
La seconda disuguaglianza si giustifica tenendo presente che l'ipotesi $j \in K \subset I$ implica, per la definizione di $I$, $k > j$ e quindi $r_j \ge 3/4r_k$ per la (c). Abbiamo dunque ottenuto
\[
\alpha(n) 5^n r_k^n \ge \alpha(n) \frac{r_k^n}{4^n} \cdot \Card(K);
\]
di conseguenza,
\[
\Card(K) \le 5^n \cdot 4^n = 20^n.
\]
\end{proofsec}

\begin{proofsec}
\emph{Esiste una costante $L_n$, dipendente solo da $n$, tale che $\Card(I - K) \le L_n$.}\hspace{.5em} Si ha
\[
I - K = \Set{ j | 1 \le j < k,\, B_j \cap B_k \ne \emptyset,\, r_j > 3r_k };
\]
inoltre, $\{B_j\}_{j=1}^J$ è una famiglia numerabile di palle chiuse non degeneri in $\RR^n$, con la proprietà che
\begin{itemize}
\item[($\alpha$)] $a_i \in B_j$ implica $i < j$ (per la (b)),
\item[($\beta$)] $i < j$ implica $r_i \ge \frac{3}{4} r_j$ (per la (c)).
\end{itemize}
L'asserto segue allora immediatamente da (\ref{lem:ricoprimento_besicovitch}).
\end{proofsec}

\begin{proofsec}
Si ponga $M_n \equiv 20^n + L_n + 1$. Allora, per la (h) e la (i),
\[
\Card(I) = \Card(K) + \Card(I - K) \le 20^n + L_n < M_n.
\]
Ovviamente $M_n$, al pari di $L_n$, dipende solo da $n$.
\end{proofsec}

\begin{proofsec}
Costruiamo ora una successione $\sigma : \{1, 2, \ldots\} \rightarrow \{1, \ldots, M_n\}$, procedendo ricorsivamente come segue:
\begin{itemize}
\item[($\alpha$)] Sia $\sigma(i) \equiv i$ per $1 \le i \le M_n$.
\item[($\beta$)] Al fine di definire $\sigma(k+1)$ per $k \ge M_n$, osserviamo che per la (j) \mymath{\Card\Set{ j | 1 \le j \le k,\, B_j \cap B_{k+1} \ne \emptyset } < M_n,}{(*)}
sicché esiste $l \in \{1, \ldots, M_n\}$ tale che $B_{k+1} \cap B_j = \emptyset$ per tutti i $j$ tali che $\sigma(j) = l$ ($1 \le j \le k$). E invero, se così non fosse, per ogni $l \in \{1, \ldots, M_n\}$ esisterebbe $j \in \{1, \ldots, k\}$ tale che $\sigma(j) = l$ e $B_{k+1} \cap B_j \ne \emptyset$. Si avrebbe allora
\[
\Card\Set{ \sigma(j) | 1 \le j \le k,\, B_j \cap B_{k+1} \ne \emptyset } \ge M_n,
\]
contro la (*). Poniamo dunque $\sigma(k+1) \equiv l$.
\end{itemize}
Ora, sia $\GG_j \equiv \Set{ B_i | \sigma(i) = j }, 1 \le j \le M_n$. Per la costruzione di $\sigma$, ogni $\GG_j$ consiste di palle disgiunte da $\FF$. Inoltre, ogni $B_i$ $(i = 1, \ldots, J)$ è in qualche $\GG_j$, sicché ricordando la (f) otteniamo
\[
A \subset \bigcup_{i=1}^J B_i = \bigcup_{i=1}^{M_n} \bigcup_{B \in \GG_i} B.
\]
\end{proofsec}

\begin{proofsec}
Infine, estendiamo il risultato ad un $A$ arbitrario (non necessariamente limitato). Per ogni intero positivo $l$, sia
\[
A_l \equiv A \cap \Set{ x | \frac{3}{2}D(l - 1) \le \abs{x} < \frac{3}{2}Dl }
\]
e si ponga
\[
\FF^l \equiv \Set{ B(a,\, r) \in \FF | a \in A_l }.
\]
Essendo ciascun $A_l$ limitato, esistono per quanto già dimostrato famiglie numerabili $\GG_1^l, \ldots, \GG_{M_n}^l$ di palle chiuse disgiunte in $\FF^l$ tali che
\[
A_l \subset \bigcup_{i=1}^{M_n} \bigcup_{B \in \GG_i^l} B.
\]
Siano $l,\, m$ interi positivi tali che $m \ge l+2$, e scegliamo $B \in \GG_j^l$ e $B' \in \GG_j^m$. Indichiamo con $a,\, a'$ i centri rispettivi di $B$ e di $B'$, e con $r,\, r'$ i raggi. Si ha allora
\[
\abs{a} < \frac{3}{2}Dl < \frac{3}{2}D(m-1) \le \abs{a'}
\]
sicché
\[
\abs{a - a'} \ge \abs{a'} - \abs{a} \ge \frac{3}{2}D(m-1) - \frac{3}{2}Dl = \frac{3}{2}D(m-l-1) \ge \frac{3}{2}D > r + r'.
\]
Pertanto $B \cap B' = \emptyset$, e quindi per l'arbitrarietà di $B \in \GG_j^l$ e $B' \in \GG_j^m$ le famiglie
\begin{equation*}
\begin{aligned}
\GG_j &\equiv \bigcup_{l=1}^\infty \GG_j^{2l-1} & \qquad\text{ per $1 \le j \le M_n$}\\
\GG_{j+M_n} &\equiv \bigcup_{l=1}^\infty \GG_j^{2l} & \qquad\text{ per $1 \le j \le M_n$}
\end{aligned}
\end{equation*}
sono disgiunte. Per concludere la dimostrazione, si ponga $N_n \equiv 2M_n$.\qed
\end{proofsec}
\end{proof}

\noindent Dimostriamo ora che, come conseguenza del teorema di Besicovitch, possiamo ``riempire'' un aperto arbitrario con una famiglia numerabile di palle disgiunte in modo tale che il ``rimanente'' abbia $\mu$-misura nulla.

\begin{corollario}
\label{cor:besicovitch}
Siano $\mu$ una misura Borel regolare su $\RR^n$, e $\FF$ una qualsiasi famiglia di palle chiuse non degeneri. Denotiamo con $A$ l'insieme dei centri delle palle in $\FF$. Assumiamo inoltre che $\mu(A) < \infty$ e che
\[
\inf\Set{ r | B(a,\, r) \in \FF } = 0
\]
per ogni $a \in A$. Allora, per ogni aperto $U \subset \RR^n$, esiste una famiglia \emph{numerabile} $\GG$ di palle \emph{disgiunte} in $\FF$ tale che
\[
\bigcup_{B \in \GG} B \subset U\qquad\text{ e }\qquad\mu\left((A \cap U) - \bigcup_{B \in \GG} B\right) = 0.
\]
(L'insieme $A$ può anche non essere $\mu$-misurabile qui. Si confronti con (\ref{cor:vitali_2}).)
\end{corollario}

\begin{proof}
Si fissi $1 - 1/N_n < \theta < 1$.

\begin{proofsec}
\emph{Esiste una famiglia finita $\{B_1, \ldots, B_{M_1}\}$ di palle chiuse disgiunte in $U$ tali che}
\[
\mu\left((A \cap U) - \bigcup_{i=1}^{M_1} B_i\right) \le \theta\mu(A \cap U).
\]
L'asserto è banale se $\mu(A \cap U) = 0$; supporremo pertanto $\mu(A \cap U) > 0$.

Sia $\FF_1 \equiv \Set{ B \in \FF | \diam B \le 1,\, B \subset U }$, ed osserviamo che $A \cap U$ è l'insieme dei centri delle palle di $\FF_1$. Se infatti $B \in \FF_1$, il centro di $B$ appartiene ovviamente ad $A \cap U$; d'altra parte, se $x \in A \cap U$, essendo per ipotesi $\inf\Set{ r | B(x,\, r) \in \FF } = 0$ e $U$ aperto, esiste $r_B$ con $0 < r_B \le 1$ tale che $B(x,\, r_B) \in \FF$ e $B(x,\, r_B) \subset U$, sicché $B(x,\, r_B) \in \FF_1$.

Per il teorema, allora, esistono famiglie $\GG_1, \ldots, \GG_{N_n}$ di palle disgiunte in $\FF_1$ tali che
\[
A \cap U \subset \bigcup_{i=1}^{N_n} \bigcup_{B \in \GG_i} B.
\]
Pertanto
\[
\mu(A \cap U) \le \sum_{i=1}^{N_n} \mu\left(A \cap U \cap \bigcup_{B \in \GG_i} B\right),
\]
sicché esiste un intero $j$ compreso tra 1 e $N_n$ per il quale
\[
\mu\left(A \cap U \cap \bigcup_{B \in \GG_j} B\right) \ge \frac{1}{N_n} \mu(A \cap U) > (1-\theta)\mu(A \cap U).
\]
Di conseguenza, esistono palle $B_1, \ldots, B_{M_1} \in \GG_j$ tali che \mymath{\mu\left(A \cap U \cap \bigcup_{i=1}^{M_1} B_i\right) \ge (1 - \theta)\mu(A \cap U).}{(*)} Invero, se $\GG_j$ è finito basta prendere $M_1 \equiv \Card(\GG_j)$ e $\{B_1, \ldots, B_{M_1}\} \equiv \GG_j$. Se invece $\GG_j$ è infinito (ma comunque numerabile), dettane $\{B_k\}_{k=1}^\infty$ una enumerazione si ha, in virtù di (\ref{thm:proprieta_misure_regolari}),
\[
\lim_{k \to \infty} \mu\left(A \cap U \cap \bigcup_{i=1}^k B_i\right) = \mu\left(\bigcup_{k=1}^\infty \left(A \cap U \cap \bigcup_{i=1}^k B_i\right)\right) = \mu\left(A \cap U \cap \bigcup_{B \in \GG_j} B\right) > (1-\theta)\mu(A \cap U),
\]
per cui esiste $M_1$ tale che valga la (*). Ma
\[
\mu(A \cap U) = \mu\left((A \cap U) \cap \bigcup_{i=1}^{M_1} B_i\right) + \mu\left((A \cap U) - \bigcup_{i=1}^{M_1} B_i\right),
\]
dal momento che $\bigcup_{i=1}^{M_1} B_i$ è $\mu$-misurabile, sicché essendo $\mu\left(A \cap U \cap \bigcup_{i=1}^{M_1} B_i\right) \le \mu(A) < \infty$ si ottiene in conseguenza della (*)
\[
\mu\left((A \cap U) - \bigcup_{i=1}^{M_1} B_i\right) = \mu(A \cap U) - \mu\left(A \cap U \cap \bigcup_{i=1}^{M_1} B_i\right) \le \mu(A \cap U) - (1-\theta)\mu(A \cap U) = \theta\mu(A \cap U).
\]
\end{proofsec}

\begin{proofsec}
Siano ora $U_2 \equiv U - \bigcup_{i=1}^{M_1} B_i$, $\FF_2 \equiv \Set{ B | B \in \FF,\, \diam B \le 1,\, B \subset U_2 }$ e, come sopra, si trovi una famiglia finita $\{B_{M_1 + 1}, \ldots, B_{M_2}\}$ di palle disgiunte in $\FF_2$ tali che
\[
\mu\left((A \cap U) - \bigcup_{i=1}^{M_2} B_i\right) = \mu\left((A \cap U_2) - \bigcup_{i=M_1 + 1}^{M_2} B_i\right) \le \theta\mu(A \cap U_2) \le \theta^2\mu(A \cap U).
\]
\end{proofsec}

\begin{proofsec}
Si iteri questo processo fino ad ottenere una famiglia numerabile $\GG \equiv \{B_i\}_{i=1}^\infty$ di palle disgiunte appartenenti a $\FF$ e incluse in $U$ tali che per ogni $k$
\[
\mu\left((A \cap U) - \bigcup_{i=1}^{M_k} B_i\right) \le \theta^k\mu(A \cap U);
\]
ne segue \mymath{\mu\left((A \cap U) - \bigcup_{B \in \GG} B\right) \le \theta^k\mu(A \cap U).}{(k = 1, 2, \ldots)} Essendo $\theta < 1$ e $\mu(A \cap U) \le \mu(A) < \infty$, il secondo membro tende a zero per $k \to \infty$. Pertanto
\[
\mu\left((A \cap U) - \bigcup_{B \in \GG} B\right) = 0,
\]
come volevasi.\qed
\end{proofsec}
\end{proof}

\section{Derivate}

Utilizziamo ora i teoremi di ricoprimento della sezione precedente per studiare la differenziabilità delle misure di Radon su $\RR^n$.

\begin{definizione}
\label{def:derivate_di_misure}
Siano $\mu$ e $\nu$ misure di Radon su $\RR^n$. Per ogni punto $x \in \RR^n$, definiamo
\[
\uDer{\nu}{\mu} (x) \equiv \begin{cases}
\displaystyle\limsup_{r \to 0} \frac{\nu(B(x,r))}{\mu(B(x,r))} & \text{se $\mu(B(x,r)) > 0$ per tutti gli $r > 0$}\\
\infty & \text{se $\mu(B(x,r)) = 0$ per qualche $r > 0$,}
\end{cases}
\]
\[
\lDer{\nu}{\mu} (x) \equiv \begin{cases}
\displaystyle\liminf_{r \to 0} \frac{\nu(B(x,r))}{\mu(B(x,r))} & \text{se $\mu(B(x,r)) > 0$ per tutti gli $r > 0$}\\
\infty & \text{se $\mu(B(x,r)) = 0$ per qualche $r > 0$.}
\end{cases}
\]
\end{definizione}

\begin{osservazione}
Segue subito dalla definizione che $\lDer{\nu}{\mu}(x) \le \uDer{\nu}{\mu}(x)$ per ogni $x \in \RR^n$.
\end{osservazione}

\begin{definizione}
\label{def:derivata_di_una_misura}
Se $\uDer{\nu}{\mu}(x) = \lDer{\nu}{\mu}(x) < \infty$, diremo che $\nu$ è \emph{differenziabile}\index{misura!differenziabile} rispetto a $\mu$ in $x$ e scriveremo
\[
\Der{\nu}{\mu} (x) \equiv \uDer{\nu}{\mu}(x) = \lDer{\nu}{\mu}(x).
\]
$\Der{\nu}{\mu}$ è la \emph{derivata}\index{derivata!di una misura} (o la \emph{densità}\index{densità di una misura}) di $\nu$ rispetto a $\mu$.
\end{definizione}

\begin{lemma}
\label{lem:derivate}
Si fissi $0 < \alpha < \infty$. Allora
\begin{itemize}
\item[(i)] $ A \subset \Set{ x \in \RR^n | \lDer{\nu}{\mu} (x) \le \alpha }$ implica $\nu(A) \le \alpha\mu(A)$,
\item[(ii)] $ A \subset \Set{ x \in \RR^n | \uDer{\nu}{\mu} (x) \ge \alpha }$ implica $\nu(A) \ge \alpha\mu(A)$.
\end{itemize}
(L'insieme $A$ può anche non essere $\mu$-misurabile o $\nu$-misurabile.)
\end{lemma}

\begin{proof}
Possiamo assumere $\mu(\RR^n),\, \nu(\RR^n) < \infty$, dal momento che altrimenti possiamo considerare $\mu$ e $\nu$ ristrette ai compatti di $\RR^n$.

Supponiamo che $A$ soddisfi le ipotesi della (i), e sia $x \in A$. Allora $\lDer{\nu}{\mu}(x) \le \alpha < \infty$, ossia\linebreak $\mu(B(x,\, r)) > 0$ per tutti gli $r > 0$ e
\[
\sup_{\epsilon > 0} \left(\inf_{0 < r < \epsilon} \frac{\nu(B(x,\, r))}{\mu(B(x,\, r))}\right) \equiv \liminf_{r \to 0} \frac{\nu(B(x,\, r))}{\mu(B(x,\, r))} \le \alpha.
\]
Si fissi $\epsilon > 0$; allora
\[
\inf_{0 < r < \epsilon} \frac{\nu(B(x,\, r))}{\mu(B(x,\, r))} \le \alpha,
\]
sicché esiste $r_\epsilon < \epsilon$ tale che $\nu(B(x,\, r_\epsilon)) \le (\alpha + \epsilon)\mu(B(x,\, r_\epsilon))$. Se ora $U$ è un aperto contenente $A$ e
\[
\FF \equiv \Set{ B | B = B(x,\, r),\, x \in A,\, B \subset U,\, \nu(B) \le (\alpha + \epsilon)\mu(B) },
\]
è chiaro che $\inf\Set{ r | B(x,\, r) \in \FF } = 0$ per ogni $x \in A$, e quindi (\ref{cor:besicovitch}) ci fornisce una famiglia numerabile $\GG$ di palle disgiunte in $\FF$ tali che
\[
\nu \left(A - \bigcup_{B \in \GG} B\right) = 0.
\]
Allora
\[
\nu(A) = \nu\left(A \cap \bigcup_{B \in \GG} B\right) \le \nu\left(\bigcup_{B \in \GG} B\right) = \sum_{B \in \GG} \nu(B) \le (\alpha + \epsilon) \sum_{B \in \GG} \mu(B) = (\alpha+\epsilon)\mu\left(\bigcup_{B \in \GG} B\right) \le  (\alpha + \epsilon)\mu(U).
\]
Questa stima è valida per ogni aperto $U \supset A$, sicché (\ref{thm:approssimazione_con_aperti_e_compatti}) implica che
\[
\nu(A) \le (\alpha + \epsilon) \mu(A).
\]
Passando al limite per $\epsilon \to 0$, otteniamo la (i). La dimostrazione della (ii) è del tutto analoga.\qed
\end{proof}

\begin{teorema}
\label{thm:esistenza_derivate}
Siano $\mu$ e $\nu$ misure di Radon su $\RR^n$. Allora $\Der{\nu}{\mu}$ esiste ed è finita $\qo{\mu}$ Inoltre, $\Der{\nu}{\mu}$ è $\mu$-misurabile.
\end{teorema}

\begin{proof}
Anche qui, possiamo assumere $\mu(\RR^n),\, \nu(\RR^n) < \infty$, dal momento che altrimenti possiamo considerare $\mu$ e $\nu$ ristrette ai compatti di $\RR^n$.

\begin{proofsec}
\emph{$\Der{\nu}{\mu}$ esiste ed è finita $\qo{\mu}$}\hspace{.5em} Sia $I \equiv \Set{ x | \uDer{\nu}{\mu} (x) = \infty }$ e, per ogni $0 < a < b$, sia
\[
R(a,\, b) \equiv \Set{ x | \lDer{\nu}{\mu} (x) < a < b < \uDer{\nu}{\mu} (x) < \infty }.
\]
Osserviamo che, per ogni $\alpha > 0$, $I \subset \Set{ x | \uDer{\nu}{\mu} (x) \ge \alpha }$. Pertanto per (\ref{lem:derivate}),
\[
\mu(I) \le \frac{1}{\alpha} \nu(I).
\]
Facciamo tendere $\alpha \to \infty$ per concludere $\mu(I) = 0$, e quindi $\uDer{\nu}{\mu}$ è finita $\qo{\mu}$

Usando nuovamente (\ref{lem:derivate}), vediamo che
\[
b \mu(R(a,\, b)) \le \nu(R(a,\, b)) \le a\mu(R(a,\, b)),
\]
da cui $\mu(R(a,\, b)) = 0$, in quanto $b > a$. Inoltre, posto
\[
R \equiv \Set{ x | \lDer{\nu}{\mu} (x) < \uDer{\nu}{\mu} (x) < \infty },
\]
si ha, per la densità di $\QQ$ in $\RR$, che $x \in R$ se e solo se esistono $a,\, b \in \QQ$ con $0 < a < b$ tali che $x \in R(a,\, b)$. Pertanto
\[
R = \bigcup_{\substack{0 < a < b\\a,\, b \in \QQ}} R(a,\, b),
\]
e per conseguenza $\mu(R) = 0$. Siccome
\[
\RR^n - (I \cup R) = \Set{ x | \lDer{\nu}{\mu} (x) = \uDer{\nu}{\mu} (x) < \infty } = \Set{ x | \Der{\nu}{\mu} (x) \text{ esiste ed è finita} },
\]
$\Der{\nu}{\mu}$ esiste ed è finita $\qo{\mu}$
\end{proofsec}

\begin{proofsec}
\emph{Per ogni $x \in \RR^n$ e per ogni $r > 0$,}
\[
\limsup_{y \to x} \mu(B(y,\, r)) \le \mu(B(x,\, r)).
\]
\emph{Un asserto analogo vale per $\nu$.}\hspace{.5em} Si scelga una successione $\{y_k\}_{k=1}^\infty \in \RR^n$ con $y_k \to x$, e si ponga $f_k \equiv \chi_{B(y_k,\, r)}$, $f \equiv \chi_{B(x,\, r)}$. Si fissi $a \in \RR^n$ tale che $f(a) = 0$; allora $a \notin B(x,\, r)$, ossia $\delta \equiv \abs{a - x} - r > 0$. Detto dunque $m_0$ un indice tale che $\abs{y_k - x} \le \delta/2$ per ogni $k \ge m_0$, risulta per ogni $b \in B(y_k,\, r)$
\[
\abs{b - x} \le \abs{b - y_k} + \abs{y_k - x} \le r + \frac{\delta}{2} < r + \delta = \abs{a - x},
\]
sicché $a \notin B(y_k,\, r)$ per $k \ge m_0$. Questo implica che $f_k(a) = 0$ per $k \ge m_0$, ossia che $\limsup_{k \to \infty} f_k(a) = 0$. Di conseguenza
\[
\limsup_{k \to \infty} f_k \le f,
\]
e così
\[
\liminf_{k \to \infty} (1 - f_k) \ge (1 - f).
\]
Pertanto, applicando il lemma di Fatou (\ref{thm:lemma_fatou}),
\[
\int_{B(x,\, 2r)} (1-f)\, d\mu \le \int_{B(x,\, 2r)} \liminf_{k \to \infty} (1-f_k)\, d\mu \le \liminf_{k \to \infty} \int_{B(x,\, 2r)} (1-f_k)\, d\mu,
\]
cioè
\[
\mu(B(x,\, 2r)) - \mu(B(x,\, r)) \le \liminf_{k \to \infty} (\mu(B(x,\, 2r) - \mu(B(y_k,\, r))).
\]
Essendo $\mu$ una misura di Radon, ne deduciamo 
\[
\limsup_{k \to \infty} \mu(B(y_k,\, r)) \le \mu(B(x,\, r)).
\]
Questa disuguaglianza vale per ogni successione $\{y_k\}_{k=1}^\infty$ tale che $y_k \to x$; ne segue l'asserto. 
\end{proofsec}

\begin{proofsec}
\emph{$\Der{\nu}{\mu}$ è $\mu$-misurabile.}\hspace{.5em} Per la (b), le funzioni $x \mapsto \mu(B(x,\, r))$ e $x \mapsto \nu(B(x,\, r))$ sono superiormente semicontinue per ogni $r > 0$; esse sono pertanto Borel misurabili (per (\ref{cor:funzioni_semicontinue})), e quindi, essendo $\mu$ una misura di Borel, anche $\mu$-misurabili. Di conseguenza, per ogni $r > 0$,
\[
f_r(x) \equiv \begin{cases}
\displaystyle\frac{\nu(B(x,\, r))}{\mu(B(x,\, r))} & \text{se $\mu(B(x,\, r)) > 0$}\\
\infty & \text{se $\mu(B(x,\, r)) = 0$}
\end{cases}
\]
è $\mu$-misurabile. Ma
\[
\Der{\nu}{\mu} = \lim_{r \to 0} f_r = \lim_{k \to \infty} f_{\frac{1}{k}},
\]
sicché $\Der{\nu}{\mu}$ è $\mu$-misurabile.\qed
\end{proofsec}
\end{proof}

\section{Integrazione di derivate. Decomposizione di Lebesgue}

\begin{definizione}
\label{def:misura_assolutamente_continua}
La misura $\nu$ si dice \emph{assolutamente continua}\index{misura!assolutamente continua} rispetto alla misura $\mu$, e si scrive
\[
\nu \ll \mu,
\]
se $\mu(A) = 0$ implica $\nu(A) = 0$ per ogni $A \subset R^n$.
\end{definizione}

\begin{definizione}
\label{def:misure_mutuamente_singolari}
Diremo che le misure $\mu$ e $\nu$ sono \emph{mutuamente singolari}\index{misure!mutuamente singolari}, o \emph{ortogonali}, e scriveremo
\[
\nu \perp \mu,
\]
se esiste un boreliano $B \subset \mathbb{R}^n$ tale che
\[
\mu(\mathbb{R}^n - B) = \nu(B) = 0.
\]
\end{definizione}

\begin{teorema2}[Teorema di differenziazione per le misure di Radon]
\label{thm:differenziazione_misure_radon}
\index{teorema!di differenziazione per le misure di Radon}
\index{teorema!di Radon-Nikodym}
\index{teorema!fondamentale del calcolo}
Siano $\nu,\, \mu$ misure di Radon su $\RR^n$, con $\nu \ll \mu$. Allora
\[
\nu(A) = \int_A \Der{\nu}{\mu}\, d\mu
\]
per tutti gli insiemi $\mu$-misurabili $A \subset \RR^n$.
\end{teorema2}

\begin{proof}
\begin{proofsec}
\emph{Ogni insieme $\mu$-misurabile $A \subset \RR^n$ è anche $\nu$-misurabile.}\hspace{.5em} Sia $A$ $\mu$-misurabile, e supponiamo dapprima che $\mu(A) < \infty$. Essendo $\mu$ Borel regolare, esiste un boreliano $B$ con $A \subset B$, $\mu(B) = \mu(A)$. Pertanto, $\mu(B - A) = \mu(B) - \mu(A) = 0$. Avendosi per ipotesi $\nu \ll \mu$, è anche $\nu(B - A) = 0$.

Ora, $\RR^n - B$ è $\nu$-misurabile in quanto $B$ è un boreliano e $\nu$ è di Borel; $B - A$ è $\nu$-misurabile in quanto $\nu(B - A) = 0$. Di conseguenza,
\[
\RR^n - A = (\RR^n - B) \cup (B - A)
\]
è $\nu$-misurabile, e quindi tale è anche $A$.

Nel caso $\mu(A) = \infty$, scriviamo
\[
A = \bigcup_{k=1}^\infty (A \cap B(0,\, k)),
\]
dove $B(0,\, k)$ è la palla chiusa di centro l'origine e raggio $k$. Essendo $\mu$ una misura di Radon, ciascun $A \cap B(0,\, k)$ è $\mu$-misurabile e inoltre $\mu(A \cap B(0,\, k)) \le \mu(B(0,\, k)) < \infty$, sicché per quanto sopra $A \cap B(0,\, k)$ è $\nu$-misurabile. Pertanto $A$ è $\nu$-misurabile.
\end{proofsec}

\begin{proofsec}
Poniamo
\begin{align*}
Z &\equiv \Set{ x \in \RR^n | \Der{\nu}{\mu}(x) = 0 },\\
I &\equiv \Set{ x \in \RR^n | \Der{\nu}{\mu}(x) = \infty };
\end{align*}
per (\ref{thm:esistenza_derivate}) gli insiemi $Z$ e $I$ sono $\mu$-misurabili. Inoltre, $\mu(I) = 0$ e quindi $\nu(I) = 0$ (in quanto $\nu\ll\mu$). Applicando poi (\ref{lem:derivate}) agli insiemi $Z_k \equiv B(0,\, k) \cap Z$, dove $B(0,\, k)$ è la palla chiusa di centro l'origine e raggio $k$ $(k = 1, 2, \ldots)$, vediamo che $\nu(Z_k) \le \alpha\mu(Z_k) < \infty$ per tutti gli $\alpha > 0$; pertanto $\nu(Z_k) = 0$ e quindi anche
\[
\nu(Z) \le \sum_{k=1}^\infty \nu(Z_k) = 0.
\]
Di conseguenza,
\[
\nu(Z) = 0 = \int_Z \Der{\nu}{\mu}\, d\mu
\]
e
\[
\nu(I) = 0 = \int_I \Der{\nu}{\mu}\, d\mu
\]
\end{proofsec}

\begin{proofsec}
Sia ora $A$ $\mu$-misurabile e si fissi $1 < t < \infty$. Definiamo per ogni intero $m$
\[
A_m \equiv A \cap \Set{ x \in \RR^n | t^m \le \Der{\nu}{\mu} (x) < t^{m+1} };
\]
per (\ref{thm:esistenza_derivate}) ciascun $A_m$ è $\mu$-, e quindi anche $\nu$-, misurabile. Inoltre
\[
A - \bigcup_{m = -\infty}^\infty A_m \subset Z \cup I \cup \Set{ x | \uDer{\nu}{\mu}(x) \ne \lDer{\nu}{\mu}(x) };
\]
ne segue, utilizzando ancora (\ref{thm:esistenza_derivate}),
\[
\nu\left(A - \bigcup_{m = -\infty}^\infty A_m\right) = 0.
\]
Di conseguenza,
\[
\nu(A) = \nu\left(A - \bigcup_{m = -\infty}^\infty A_m\right) + \nu\left(A \cap \bigcup_{m = -\infty}^\infty A_m\right) = \nu\left(\bigcup_{m = -\infty}^\infty A_m\right) = \sum_{m=-\infty}^\infty \nu(A_m).
\]
Pertanto, applicando (\ref{lem:derivate}) a ciascun $A_m$,
\begin{align*}
\nu(A) &= \sum_m \nu(A_m) \le \sum_m t^{m+1} \mu(A_m) = t\sum_m t^m \mu(A_m)\\
&= t\sum_m \int_{A_m} t^m\, d\mu \le t\sum_m \int_{A_m} \Der{\nu}{\mu}\, d\mu = t\int_A \Der{\nu}{\mu}\, d\mu.
\end{align*}
Similmente,
\begin{align*}
\nu(A) &= \sum_m \nu(A_m) \ge \sum_m t^m \mu(A_m) = \frac{1}{t}\sum_m t^{m+1} \mu(A_m)\\
&= \frac{1}{t}\sum_m \int_{A_m} t^{m+1}\, d\mu \ge \frac{1}{t}\sum_m \int_{A_m} \Der{\nu}{\mu}\, d\mu = \frac{1}{t}\int_A \Der{\nu}{\mu}\, d\mu.
\end{align*}
Mettendo insieme le due disuguaglianze, otteniamo
\[
1/t \int_A \Der{\nu}{\mu}\, d\mu \le \nu(A) \le t\int_A \Der{\nu}{\mu}\, d\mu
\]
per ogni $1 < t < \infty$. Facendo infine tendere $t \to 1^+$, si ha
\[
\nu(A) = \int_A \Der{\nu}{\mu}\, d\mu,
\]
come volevasi.\qed
\end{proofsec}
\end{proof}

\begin{osservazione}
Il teorema appena dimostrato è una versione del \emph{teorema di Radon-Niko\-dym}. Si osservi che non solo dimostriamo che $\nu$ ha una densità rispetto a $\mu$, ma anche che tale densità $\Der{\nu}{\mu}$ può essere calcolata ``differenziando'' $\nu$ rispetto a $\mu$. Queste affermazioni comprendono in effetti il \emph{teorema fondamentale del calcolo} per le misure di Radon su $\RR^n$.
\end{osservazione}

\begin{teorema2}[Teorema di decomposizione di Lebesgue]
\label{thm:decomposizione_lebesgue}
\index{teorema!di decomposizione di Lebesgue}
\index{decomposizione!di Lebesgue di una misura}
Siano $\nu,\, \mu$ misure di Radon su $\RR^n$.
\begin{itemize}
\item[(i)] Allora $\nu = \nu_\textup{ac} + \nu_\textup{s}$, dove $\nu_\textup{ac},\, \nu_\textup{s}$ sono misure di Radon su $\RR^n$ con
\[
\nu_\textup{ac} \ll \mu \qquad\text{ e }\qquad \nu_\textup{s} \perp \mu;
\]
la decomposizione è unica. (Chiamiamo $\nu_\textup{ac}$ la \emph{parte assolutamente continua}\index{parte!assolutamente continua} e $\nu_\textup{s}$ la \emph{parte singolare}\index{parte!singolare} di $\nu$ rispetto a $\mu$.)
\item[(ii)] Inoltre,
\[
\Der{\nu}{\mu} = \Der{\nu_\textup{ac}}{\mu} \qquad\text{ e }\qquad \Der{\nu_\textup{s}}{\mu} = 0\qquad\qo{\mu};
\]
di conseguenza,
\[
\nu(A) = \int_A \Der{\nu}{\mu}\, d\mu + \nu_\textup{s}(A)
\]
per ogni boreliano $A \subset \RR^n$. % perché per forza boreliano? non è sufficiente misurabile??
\end{itemize}
\end{teorema2}

\begin{proof}
\begin{proofsec}
Cominciamo col dimostrare che se
\[
\nu_\textup{ac} + \nu_\textup{s} \le \tilde{\nu}_\textup{ac} + \tilde{\nu}_\textup{s},
\]
dove $\nu_\textup{ac}$, $\tilde{\nu}_\textup{ac}$, $\nu_\textup{s}$ e $\tilde{\nu}_\textup{s}$ sono misure di Radon su $\RR^n$ con
\[
\nu_\textup{ac},\, \tilde{\nu}_\textup{ac} \ll \mu \qquad\text{ e }\qquad \nu_\textup{s},\, \tilde{\nu}_\textup{s} \perp \mu,
\]
allora
\[
\nu_\textup{s} \le \tilde{\nu}_\textup{s} \qquad\text{ e }\qquad \nu_\textup{ac} \le \tilde{\nu}_\textup{ac}.
\]
E invero, in tale ipotesi, esistono due boreliani $B,\, \tilde{B} \subset \RR^n$ tali che
\[
\mu(B) = \nu_\textup{s}(\RR^n - B) = 0 \qquad\text{ e }\qquad \mu(\tilde{B}) = \tilde{\nu}_\textup{s}(\RR^n - \tilde{B}) = 0;
\]
pertanto, per ogni insieme $A \subset \RR^n$,
\[
\mu(A \cap (B \cup \tilde{B})) \le \mu(B \cup \tilde{B}) \le \mu(B) + \mu(\tilde{B}) = 0,
\]
ed avendosi $\nu_\textup{ac},\, \tilde{\nu}_\textup{ac} \ll \mu$ otteniamo 
\[
\nu_\textup{ac}(A \cap (B \cup \tilde{B})) = \tilde{\nu}_\textup{ac}(A \cap (B \cup \tilde{B}) = 0.\qquad(A \subset \RR^n)
\] 
Inoltre 
\[
\nu_\textup{s}(A - (B \cup \tilde{B})) \le \nu_\textup{s}(\RR^n - B) = 0 \qquad\text{ e }\qquad \tilde{\nu}_\textup{s}(A - (B \cup \tilde{B})) \le \tilde{\nu}_\textup{s}(\RR^n - \tilde{B}) = 0,
\]
e di conseguenza, ricordando che $B \cup \tilde{B}$ è un boreliano, quindi misurabile rispetto a ciascuna delle misure $\nu_\textup{ac}$, $\nu_\textup{s}$, $\tilde{\nu}_\textup{ac}$ e $\tilde{\nu}_\textup{s}$, possiamo scrivere
\begin{align*}
\nu_\textup{ac}(A) &= \nu_\textup{ac}(A \cap (B \cup \tilde{B})) + \nu_\textup{ac}(A - (B \cup \tilde{B})) = \nu_\textup{ac}(A - (B \cup \tilde{B}))\\
&= \nu_\textup{ac}(A - (B \cup \tilde{B})) + \nu_\textup{s}(A - (B \cup \tilde{B})) \le \tilde{\nu}_\textup{ac}(A - (B \cup \tilde{B})) + \tilde{\nu}_\textup{s}(A - (B \cup \tilde{B}))\\
&= \tilde{\nu}_\textup{ac}(A - (B \cup \tilde{B})) = \tilde{\nu}_\textup{ac}(A \cap (B \cup \tilde{B})) + \tilde{\nu}_\textup{ac}(A - (B \cup \tilde{B})) = \tilde{\nu}_\textup{ac}(A) 
\end{align*}
e
\begin{align*}
\nu_\textup{s}(A) &= \nu_\textup{s}(A \cap (B \cup \tilde{B})) + \nu_\textup{s}(A - (B \cup \tilde{B})) = \nu_\textup{s}(A \cap (B \cup \tilde{B}))\\
&= \nu_\textup{ac}(A \cap (B \cup \tilde{B})) + \nu_\textup{s}(A \cap (B \cup \tilde{B})) \le \tilde{\nu}_\textup{ac}(A \cap (B \cup \tilde{B})) + \tilde{\nu}_\textup{s}(A \cap (B \cup \tilde{B}))\\
&= \tilde{\nu}_\textup{s}(A \cap (B \cup \tilde{B})) = \tilde{\nu}_\textup{s}(A \cap (B \cup \tilde{B})) + \tilde{\nu}_\textup{s}(A - (B \cup \tilde{B})) = \tilde{\nu}_\textup{s}(A) 
\end{align*}
per ogni insieme $A \subset \RR^n$. Ma allora
\[
\nu_\textup{ac} \le \tilde{\nu}_\textup{ac} \qquad\text{ e }\qquad \nu_\textup{s} \le \tilde{\nu}_\textup{s}.
\]
\end{proofsec}

\begin{proofsec}
Se, in particolare, $\nu_\textup{ac} + \nu_\textup{s} = \tilde{\nu}_\textup{ac} + \tilde{\nu}_\textup{s}$ allora
\[
\nu_\textup{ac} = \tilde{\nu}_\textup{ac} \qquad\text{ e }\qquad \nu_\textup{s} = \tilde{\nu}_\textup{s}.
\]
L'unicità della decomposizione è così provata.
\end{proofsec}

\begin{proofsec}
Dimostriamo ora l'esistenza, e supponiamo in un primo momento $\mu(\RR^n),\, \nu(\RR^n) < \infty$. Definiamo
\[
\EE \equiv \Set{ A \subset \RR^n | A \text{ boreliano, $\mu(\RR^n - A) = 0$ } },
\]
e scegliamo $B_k \in \EE$ in modo che, per $k = 1, 2, \ldots$, \mymath{\nu(B_k) \le \inf_{A \in \EE} \nu(A) + \frac{1}{k}.}{(*)} Scriviamo $B \equiv \bigcap_{k=1}^\infty B_k$; $B$ è un boreliano e inoltre
\[
\mu(\RR^n - B) \le \sum_{k=1}^\infty \mu(\RR^n - B_k) = 0,
\]
sicché $B \in \EE$. Ne segue, facendo tendere $k \to \infty$ nella (*), \mymath{\nu(B) = \inf_{A \in \EE} \nu(A).}{(**)} Definiamo
\begin{align*}
\nu_\textup{ac} &\equiv \nu\restr B,\\
\nu_\textup{s} &\equiv \nu\restr(\RR^n - B);
\end{align*}
$\nu_\textup{ac}$ e $\nu_\textup{s}$ sono misure di Radon in virtù di (\ref{cor:restrizione_misura_borel_regolare}). In più, se $A \subset \RR^n$ è un qualsiasi insieme allora
\[
\nu(A) = \nu(A \cap B) + \nu(A - B) = \nu(A \cap B) + \nu(A \cap (\RR^n - B)) = \nu_\textup{ac}(A) + \nu_\textup{s}(A)
\]
in quanto $B$ è un boreliano, quindi $\nu$-misurabile. Pertanto $\nu_\textup{ac} + \nu_\textup{s} = \nu$.
\end{proofsec}

\begin{proofsec}
Si ha $\mu(\RR^n - B) = 0 = \nu_\textup{s}(B)$, e pertanto $\nu_\textup{s} \perp \mu$. Supponiamo ora per assurdo che $\nu_\textup{ac} \nll \mu$. Esiste allora un insieme $A \subset \RR^n$ tale che $\mu(A) = 0$ ma $\nu(B \cap A) > 0$; inoltre, esiste un boreliano $A' \supset A$ tale che $\mu(A') = \mu(A) = 0$. Avendosi $\mu(\RR^n - (B - A')) = \mu((\RR^n - B) \cup A') \le \mu(\RR^n - B) + \mu(A') = 0$, $B - A' \in \EE$; d'altra parte, da $\nu(B) = \nu(B \cap A') + \nu(B - A') < \infty$ e $\nu(B \cap A') \ge \nu(B \cap A) > 0$ segue $\nu(B - A') < \nu(B)$, contro la (**). Di conseguenza, $\nu_\textup{ac} \ll \mu$.
\end{proofsec}

\begin{proofsec}
Siano ora $\nu,\, \mu$ misure di Radon arbitrarie su $\RR^n$. Per ogni intero positivo $k$, denotiamo con $B(0,\, k)$ la palla chiusa di centro l'origine e raggio $k$, e poniamo \mymath{\nu^k \equiv \nu \restr B(0,\, k),\qquad \mu^k \equiv \mu \restr B(0,\, k).}{(k = 1, 2, \ldots)} Per (\ref{cor:restrizione_misura_borel_regolare}), $\nu^k$ e $\mu^k$ $(k = 1, 2, \ldots)$ sono misure di Radon \emph{finite} su $\RR^n$. Pertanto, per quanto già dimostrato, possiamo scrivere \mymath{\nu^k = \nu^k_\textup{ac} + \nu^k_\textup{s},}{(***)} dove $\nu^k_\textup{ac},\, \nu^k_\textup{s}$ $(k = 1, 2, \ldots)$ sono misure di Radon su $\RR^n$ con
\[
\nu^k_\textup{ac} \ll \mu^k \qquad\text{ e }\qquad \nu^k_\textup{s} \perp \mu^k.
\]
Inoltre
\[
\nu^1 \le \ldots \le \nu^k \le \nu^{k+1} \le \ldots,
\]
sicché per la (a)
\[
\nu^1_\textup{ac} \le \ldots \le \nu^k_\textup{ac} \le \nu^{k+1}_\textup{ac} \le \ldots \qquad\text{ e }\qquad \nu^1_\textup{s} \le \ldots \le \nu^k_\textup{s} \le \nu^{k+1}_\textup{s} \le \ldots.
\]
Si ponga
\[
\nu_\textup{ac} \equiv \lim_{k \to \infty} \nu^k_\textup{ac} \qquad\text{ e }\qquad \nu_\textup{s} \equiv \lim_{k \to \infty} \nu^k_\textup{s};
\]
$\nu_\textup{ac}$ e $\nu_\textup{s}$ sono misure Borel regolari su $\RR^n$ per (\ref{thm:limite_di_misure}). Inoltre, passando al limite per $k \to \infty$ nella (***), otteniamo
\[
\nu = \nu_\textup{ac} + \nu_\textup{s};
\]
in particolare, se $K \subset \RR^n$ è un compatto si ha $\nu_\textup{ac}(K),\, \nu_\textup{s}(K) \le \nu(K) < \infty$, ossia $\nu_\textup{ac}$ e $\nu_\textup{s}$ sono misure di Radon.
\end{proofsec}

\begin{proofsec}
Per completare la dimostrazione della (i), dobbiamo far vedere che $\nu_\textup{ac} \ll \mu$ e che $\nu_\textup{s} \perp \mu$. Sia allora $A \subset \RR^n$ un insieme tale che $\mu(A) = 0$. Essendo $\mu^k \le \mu$ $(k = 1, 2, \ldots)$ si ha anche $\mu^k(A) = 0$ e quindi $\nu^k_\textup{ac}(A) = 0$ in quanto $\nu^k_\textup{ac} \ll \mu^k$. Passando al limite per $k \to \infty$ risulta $\nu_\textup{ac} = 0$ e quindi, stante l'arbitrarietà di $A$, $\nu_\textup{ac} \ll \mu$.

Sia poi, per ogni $k$, $B_k \subset \RR^n$ un boreliano tale che
\[
\mu^k(\RR^n - B_k) = \nu^k_\textup{s}(B_k) = 0
\]
(esistente in quanto $\nu^k_\textup{s} \perp \mu^k$), e poniamo \mymath{D_k \equiv B_k \cap B(0,\, k).}{(k = 1, 2, \ldots)} Sia $D \equiv \bigcup_{k=1}^\infty D_k$; $D$ è un boreliano e inoltre
\[
\nu_\textup{s}(D) \le \sum_{k=1}^\infty \nu_\textup{s}(D_k) = \sum_{k=1}^\infty \nu_\textup{s}(B_k \cap B(0,\, k)) = \sum_{k=1}^\infty \nu^k_\textup{s}(B_k) = 0.
\]
D'altra parte possiamo scrivere
\[
\RR^n - D = \bigcup_{k=1}^\infty B(0,\, k) - \bigcup_{k=1}^\infty (B_k \cap B(0,\, k)) \subset \bigcup_{k=1}^\infty (B(0,\, k) - B_k)),
\]
sicché
\[
\mu(\RR^n - D) \le \sum_{k=1}^\infty \mu(B(0,\, k) - B_k) = \sum_{k=1}^\infty \mu^k(\RR^n - B_k) = 0.
\]
Pertanto $\nu \perp \mu$; con ciò la dimostrazione della (i) è completa.
\end{proofsec}

\begin{proofsec}
Allo scopo di provare la (ii), si fissi $\alpha > 0$ e si ponga
\[
C \equiv \Set{ x \in D | \Der{\nu_\textup{s}}{\mu}(x) \ge \alpha },
\]
dove $D$ è l'insieme costruito nella (f). Secondo (\ref{lem:derivate}),
\[
\alpha\mu(C) \le \nu_\textup{s}(C) \le \nu_\textup{s}(D) = 0,
\]
e pertanto
\[
\mu\left(\Set{ x \in D | \Der{\nu_\textup{s}}{\mu}(x) \ne 0 }\right) \le \sum_{k=1}^\infty \mu\left(\Set{ x \in D | \Der{\nu_\textup{s}}{\mu}(x) \ge \frac{1}{k} }\right) = 0,
\]
vale a dire $\Der{\nu_\textup{s}}{\mu} = 0$ $\qo{\mu}$ Questo implica ovviamente
\[
\Der{\nu}{\mu} = \Der{\nu_\textup{ac}}{\mu}\qquad\qo{\mu}
\]
Infine, se $A$ è un boreliano, applicando il teorema di differenziazione per le misure di Radon (\ref{thm:differenziazione_misure_radon}) possiamo scrivere
\mymath{\nu(A) = \nu_\textup{ac}(A) + \nu_\textup{s}(A) = \int_A \Der{\nu_\textup{ac}}{\mu}\, d\mu + \nu_\textup{s}(A) = \int_A \Der{\nu}{\mu}\, d\mu + \nu_\textup{s}(A).}{\qedsymbol}
\end{proofsec}
\end{proof}

\section{Teorema di differenziazione di Lebesgue-Besicovitch}

\begin{definizione}
\label{def:media}
Definiamo la \emph{media}\index{media di una funzione} di $f$ sull'insieme $E$ rispetto a $\mu$ come
\[
\dashint_E f\, d\mu \equiv \frac{1}{\mu(E)} \int_E f\, d\mu,
\]
purché $0 < \mu(E) < \infty$ e l'integrale a secondo membro esista.
\end{definizione}

\noindent Premettiamo una disuguaglianza elementare.

\begin{lemma}
\label{lem:p_disuguaglianza}
Siano $a,\, b,\, p$ numeri reali, con $p > 0$. Allora
\[
\abs{a + b}^p \le \begin{cases}
\abs{a}^p + \abs{b}^b & \text{se $0 < p < 1$},\\
2^{p-1}(\abs{a}^p + \abs{b}^p) & \text{se $p \ge 1$}.
\end{cases}
\]
\end{lemma}

\begin{teorema2}[Teorema di differenziazione di Lebesgue-Besicovitch]
\label{thm:lebesgue_besicovitch}
\index{teorema!di differenziazione di Lebesgue-Besicovitch}
Siano $\mu$ una misura di Radon su $\RR^n$ e $f \in L_\textup{loc}^1(\RR^n,\, \mu)$. Allora
\[
\lim_{r \to 0} \dashint_{B(x,\, r)} f\, d\mu = f(x)
\]
per $\qogni{x \in \RR^n}{\mu}$.
\end{teorema2}

\begin{proof}
\begin{proofsec}
Per ogni insieme $\mu$-misurabile $B \subset \RR^n$, definiamo $\nu^\pm (B) \equiv \int_B f^\pm\, d\mu$ e, per un arbitrario insieme $A \subset \RR^n$,
\[
\nu^\pm (A) \equiv \inf\Set{ \nu^\pm(B) | \text{$B$ boreliano, $A \subset B$} }.
\]
Per (\ref{thm:misura_da_integrale}), $\nu^+$ e $\nu^-$ sono misure su $\RR^n$.
\end{proofsec}

\begin{proofsec}
\emph{$\nu^+$ e $\nu^-$ sono misure di Radon su $\RR^n$.}\hspace{.5em} Cominciamo col dimostrare che $\nu^+$ e $\nu^-$ sono di Borel. E invero, se $A_1,\, A_2 \subset \RR^n$ sono insiemi arbitrari con $\dist(A_1,\, A_2) > 0$, scegliamo, per ogni intero positivo $k$, un boreliano $B^k$ tale che $A_1 \cup A_2 \subset B^k$ e che
\[
\nu^\pm(B^k) \le \nu^\pm(A_1 \cup A_2) + \frac{1}{k};
\]
poniamo inoltre \mymath{B^k_1 \equiv B^k \cap \closure{A_1},\qquad B^k_2 \equiv B^k \cap \closure{A_2}.}{(k = 1, 2, \ldots)} Essendo $\dist(A_1,\, A_2) > 0$ si ha $\closure{A_1} \cap \closure{A_2} = \emptyset$ e quindi $B^k_1 \cap B^k_2 = \emptyset$ $(k = 1, 2, \ldots)$; è chiaro poi che $B^k_1$ e $B^k_2$ sono boreliani e che \mymath{A_1 \subset B^k_1,\qquad A_2 \subset B^k_2.}{(k = 1, 2, \ldots)} Pertanto
\begin{align*}
\nu^\pm(A_1) + \nu^\pm(A_2) &\le \nu^\pm(B^k_1) + \nu^\pm(B^k_2) = \int_{B^k_1} f^\pm\, d\mu + \int_{B^k_2} f^\pm\, d\mu\\
&= \int_{B^k_1 \cup B^k_2} f^\pm\, d\mu = \nu^\pm(B^k_1 \cup B^k_2) \le \nu^\pm(B^k) \le \nu^\pm(A_1 \cup A_2) + \frac{1}{k};
\end{align*}
facendo poi tendere $k \to \infty$ otteniamo
\[
\nu^\pm(A_1) + \nu^\pm(A_2) \le \nu^\pm(A_1 \cup A_2).
\] 
La disuguaglianza opposta segue dalla subadditività; di conseguenza,
\[
\nu^\pm(A_1 \cup A_2) = \nu^\pm(A_1) + \nu^\pm(A_2)
\] 
e possiamo usare il criterio di Caratheodory (\ref{thm:criterio_caratheodory}) per concludere che $\nu^+$ e $\nu^-$ sono misure di Borel su $\RR^n$.

Per far vedere che esse sono anche Borel regolari, fissiamo ad arbitrio un $A \subset \RR^n$ e scegliamo per ogni intero positivo $k$ un boreliano $B_k$ tale che $A \subset B_k$ e
\[
\nu^\pm(B_k) \le \nu^\pm(A) + \frac{1}{k}.
\]
Allora $B \equiv \bigcap_{k=1}^\infty B_k$ è un boreliano, $A \subset B$ e inoltre \mymath{\nu^\pm(A) \le \nu^\pm(B) \le \nu^\pm(B_k) \le \nu^\pm(A) + \frac{1}{k},}{(k = 1, 2, \ldots)} sicché passando al limite per $k \to \infty$ otteniamo $\nu^\pm(B) = \nu^\pm(A)$. Per l'arbitrarietà di $A \subset \RR^n$, $\nu^+$ e $\nu^-$ sono misure Borel regolari. Esse sono poi anche di Radon, in quanto, avendosi per ipotesi $f \in L_\textup{loc}^1(\RR^n,\, \mu)$, risulta per ogni compatto $K \subset \RR^n$
\[
\nu^\pm(K) = \int_K f^\pm\, d\mu < \infty.
\]
\end{proofsec}

\begin{proofsec}
Si osservi ora che $\nu^\pm \ll \mu$; invero se $\mu(A) = 0$ l'insieme $A$ è $\mu$-misurabile, sicché $\nu^\pm(A) = \int_A f^\pm\, d\mu = 0$. Possiamo pertanto applicare il teorema di differenziazione per le misure di Radon (\ref{thm:differenziazione_misure_radon}) ed ottenere
\[
\int_A f^\pm\, d\mu = \nu^\pm(A) = \int_A \Der{\nu}{\mu}^\pm\, d\mu
\]
per tutti gli insiemi $\mu$-misurabili $A$, ossia $\Der{\nu}{\mu}^\pm = f^\pm$ $\qo{\mu}$ Di conseguenza,
\begin{align*}
\lim_{r \to 0} \dashint_{B(x,\, r)} f\, d\mu &= \lim_{r \to 0} \dashint_{B(x,\, r)} (f^+ - f^-)\, d\mu\\
&= \lim_{r \to 0} \frac{1}{\mu(B(x,\, r))} [\nu^+(B(x,\, r)) - \nu^-(B(x,\, r))] = \Der{\nu}{\mu}^+(x) - \Der{\nu}{\mu}^-(x)\\
&= f^+(x) - f^-(x) = f(x)
\end{align*}
per $\qogni{x}{\mu}$.\qed
\end{proofsec}
\end{proof}

\begin{corollario}
\label{cor:punti_di_lebesgue}
Siano $\mu$ una misura di Radon su $\RR^n$, $1 \le p < \infty$, e $f \in L_\textup{loc}^p(\RR^n,\, \mu)$. Allora \mymath{\lim_{r \to 0} \dashint_{B(x,\, r)} \abs{f - f(x)}^p\, d\mu = 0}{(*)} per $\qogni{x}{\mu}$. (Un punto per il quale vale la (*) si dice un \emph{punto di Lebesgue}\index{punto!di Lebesgue} di $f$ rispetto a $\mu$.)
\end{corollario}

\begin{proof}
\begin{proofsec}
Cominciamo con l'osservare che se $s \in \RR^n$ e $K \subset \RR^n$ è un qualsiasi compatto allora per (\ref{lem:p_disuguaglianza})
\[
\int_K \abs{f - s}^p\, d\mu \le 2^{p-1} \left[\int_K \abs{f}^p\, d\mu + \int_K \abs{s}^p\, d\mu\right] = 2^{p-1}\int_K \abs{f}^p\, d\mu + 2^{p-1}\abs{s}^p\mu(K) < \infty,
\]
in quanto $f \in L_\textup{loc}^p(\RR^n, \mu)$ e $\mu$ è una misura di Radon. Pertanto, $\abs{f - s}^p \in L_\textup{loc}^1(\RR^n,\, \mu)$.
\end{proofsec}

\begin{proofsec}
Sia ora $\{s_i\}_{i=1}^\infty$ un sottoinsieme numerabile denso di $\RR^n$. Per il teorema,
\[
\lim_{r \to 0} \dashint_{B(x,\, r)} \abs{f - s_i}^p\, d\mu = \abs{f(x) - s_i}^p
\]
per $\qogni{x}{\mu}$ e per $i = 1, 2, \ldots$, sicché posto
\[
A \equiv \bigcap_{i=1}^\infty \Set{ x \in \RR^n | \lim_{r \to 0} \dashint_{B(x,\, r)} \abs{f - s_i}^p\, d\mu = \abs{f(x) - s_i}^p }
\]
si ha $\mu(\RR^n - A) = 0$. Si fissino $x \in A$, $\epsilon > 0$ e si scelga $s_i$ tale che $\abs{f(x) - s_i}^p < \epsilon/2^p$ (esistente per l'ipotesi di densità). Per (\ref{lem:p_disuguaglianza})
\begin{align*}
\abs{f - f(x)}^p \le 2^{p-1} (\abs{f - s_i}^p + \abs{f(x) - s_i}^p),
\end{align*}
da cui
\begin{align*}
\limsup_{r \to 0} \dashint_{B(x,\, r)} \abs{f &- f(x)}^p\, d\mu \le 2^{p-1} \left[\limsup_{r \to 0} \dashint_{B(x,\, r)} \abs{f - s_i}^p\, d\mu + \limsup_{r \to 0} \dashint_{B(x,\, r)} \abs{f(x) - s_i}^p\, d\mu\right]\\
&= 2^{p-1} \left[\lim_{r \to 0} \dashint_{B(x,\, r)} \abs{f - s_i}^p\, d\mu + \abs{f(x) - s_i}^p\right] = 2^{p-1} [\abs{f(x) - s_i}^p + \abs{f(x) - s_i}^p] < \epsilon.
\end{align*}
Pertanto, per l'arbitrarietà di $\epsilon > 0$,
\[
\limsup_{r \to 0} \dashint_{B(x,\, r)} \abs{f - f(x)}^p\, d\mu = 0
\]
ossia
\[
\lim_{r \to 0} \dashint_{B(x,\, r)} \abs{f - f(x)}^p\, d\mu = 0
\]
per ogni $x \in A$ con $\mu(\RR^n - A) = 0$, come volevasi.\qed
\end{proofsec}
\end{proof}

\noindent Nel caso $\mu = \Leb^n$, vale un risultato più forte:

\begin{corollario}
Se $f \in L_\textup{loc}^p$ per qualche $1 \le p < \infty$, allora
\[
\lim_{B \downarrow \{x\}} \dashint_B \abs{f - f(x)}^p\, dy = 0 \qquad\text{ per $\qogni{x}{\Leb^n}$};
\]
ossia,
\[
\lim_{k \to \infty} \dashint_{B_k} \abs{f - f(x)}^p\, dy = 0 \qquad\text{ per $\qogni{x}{\Leb^n}$},
\]
per ogni successione $\{B_k\}_{k=1}^\infty$ di palle chiuse \emph{contenenti $x$} e tali che $\diam B_k \to 0$ per $k \to \infty$. (Si noti che non è richiesto che le palle siano centrate in $x$.)
\end{corollario}

\begin{proof}
Sia dunque $\{B_k\}_{k=1}^\infty$ una successione di palle chiuse contenenti $x$ e tali che $\diam B_k \to 0$ per $k \to \infty$; posto $d_k \equiv \diam B_k$ $(k = 1, 2, \ldots)$, si ha ovviamente $B_k \subset B(x,\, d_k)$, sicché
\[
\int_{B_k} \abs{f - f(x)}^p\, dy \le \int_{B(x,\, d_k)} \abs{f - f(x)}^p\, dy;
\]
inoltre,
\[
\Leb^n(B(x,\, d_k)) = 2^n\Leb^n\left(B\left(x,\, \frac{d_k}{2}\right)\right) = 2^n\Leb^n(B_k).
\]
Di conseguenza,
\begin{align*}
\dashint_{B_k} \abs{f - f(x)}^p\, dy &= \frac{1}{\Leb^n(B_k)} \int_{B_k} \abs{f - f(x)}^p\, dy = \frac{2^n}{\Leb^n(B(x,\, d_k))} \int_{B_k} \abs{f - f(x)}^p\, dy\\
&\le \frac{2^n}{\Leb^n(B(x,\, d_k))} \int_{B(x,\, d_k)} \abs{f - f(x)}^p\, dy = 2^n\dashint_{B(x,\, d_k)} \abs{f - f(x)}^p\, dy.
\end{align*}
L'ultimo membro tende a zero se $x$ è un punto di Lebesgue, ossia, per (\ref{cor:punti_di_lebesgue}), per $\qogni{x \in \RR^n}{\Leb^n}$.\qed
\end{proof}

\begin{corollario}
Sia $E \subset \RR^n$ $\Leb^n$-misurabile. Allora
\[
\lim_{r \to 0} \frac{\Leb^n(B(x,\, r) \cap E)}{\Leb^n(B(x,\, r))} = \begin{cases}
1 & \text{per $\qogni{x \in E}{\Leb^n}$}\\
0 & \text{per $\qogni{x \in \RR^n - E}{\Leb^n}$.}
\end{cases}
\]
\end{corollario}

\begin{proof}
Si ha ovviamente $\chi_E \in L_\textup{loc}^1(\RR^n)$, sicché applicando (\ref{thm:lebesgue_besicovitch}) otteniamo
\[
\lim_{r \to 0} \dashint_{B(x,\, r)} \chi_E\, dy = \chi_E(x)
\]
per $\qogni{x \in \RR^n}{\Leb^n}$. Ma
\[
\dashint_{B(x,\, r)} \chi_E\, dy = \frac{\Leb^n(B(x,\, r) \cap E)}{\Leb^n(B(x,\, r))};
\]
ne segue subito l'asserto.\qed
\end{proof}

\begin{definizione}
\label{def:punti_di_densita}
Siano $E \subset \RR^n$, $x \in \RR^n$. Diremo che
\[
\begin{array}{ccc}
\text{$x$ è un \emph{punto di densità 1}\/ per $E$\index{punto!di densità 1}} & \text{se} & \displaystyle\lim_{r \to 0} \frac{\Leb^n(B(x,r) \cap E)}{\Leb^n(B(x,r))} = 1,\\
\noalign{\vskip10pt}\text{$x$ è un \emph{punto di densità 0}\/ per $E$\index{punto!di densità 0}} & \text{se} & \displaystyle\lim_{r \to 0} \frac{\Leb^n(B(x,r) \cap E)}{\Leb^n(B(x,r))} = 0.
\end{array}
\]
\end{definizione}

\begin{osservazione}
Possiamo riguardare l'insieme dei punti di densità 1 (rispettivamente, di densità 0) di $E$ come una sorta di \emph{interno} (rispettivamente, \emph{esterno}) di $E$ nel senso della misura.
\end{osservazione}

%%%%%%%%%%%%%%%%%%
% capitolo terzo %
%%%%%%%%%%%%%%%%%%

\chapter{La misura di Hausdorff}

\section{Definizione e proprietà elementari}

\begin{definizione}
\label{def:misura_hausdorff_delta}
Siano $A \subset \RR^n$, $0 \le s < \infty$, $0 < \delta \le \infty$ (si noti che il valore $\delta = \infty$ è permesso). Definiamo
\[
\Haus_\delta^s (A) \equiv \inf\Set{ \sum_{j=1}^\infty \alpha(s) \left(\frac{\diam C_j}{2}\right)^s | A \subset \bigcup_{j=1}^\infty C_j,\, \diam C_j \le \delta },
\]
dove
\[
\alpha(s) \equiv \frac{\pi^{s/2}}{\Gamma(\frac{s}{2} + 1)}.
\]
Qui $\Gamma$ è la funzione definita in (\ref{def:funzione_gamma}).
\end{definizione}

\begin{osservazione}
Nella definizione richiediamo implicitamente che almeno uno degli insiemi $C_j$ abbia diametro strettamente positivo.
\end{osservazione}

\begin{osservazione}
La notazione $\alpha(s)$ è consistente con quella introdotta in (\ref{not:alpha_n}); si ricordi inoltre che il volume di una palla $n$-dimensionale di raggio $r$ è dato da $\alpha(n) r^n$ (\emph{cfr.}~(\ref{thm:volume_palla_versione1})), sicché la quantità $\alpha(s) (\diam C_j/2)^s$ può essere riguardata come il volume di una sorta di ``palla $s$-dimensionale'' di diametro pari a quello di $C_j$. 
\end{osservazione}

\begin{lemma}
\mbox{}
\begin{itemize}
\item[(i)] $\Haus_\delta^s$ è una misura su $\RR^n$.
\item[(ii)] Fissati $A \subset \RR^n$ e $0 \le s < \infty$, $\Haus_\delta^s(A)$ è una funzione non crescente di $\delta$. 
\end{itemize}
\end{lemma}

\begin{proof}
\begin{proofsec}
Si scelgano $\{A_k\}_{k=1}^\infty \subset \RR^n$ e supponiamo che $A_k \subset \bigcup_{j=1}^\infty C_j^k$, $\diam C_j^k \le \delta$; allora $\{C_j^k\}_{j,\,k=1}^\infty$ è un ricoprimento di $\bigcup_{k=1}^\infty A_k$. Pertanto
\[
\Haus_\delta^s \left(\bigcup_{k=1}^\infty A_k\right) \le \sum_{k=1}^\infty \sum_{j=1}^\infty \alpha(s) \left(\frac{\diam C_j^k}{2}\right)^s.
\]
Passando agli estremi inferiori su tutte le famiglie $\{C_j^k\}_{j=1}^\infty$ $(k = 1, 2, \ldots)$ otteniamo
\[
\Haus_\delta^s \left(\bigcup_{k=1}^\infty A_k\right) \le \sum_{k=1}^\infty \Haus_\delta^s(A_k).
\]
La (i) è così provata.
\end{proofsec}

\begin{proofsec}
Per dimostrare la (ii) è sufficiente osservare che se $\delta \le \eta$ e $\{C_j\}_{j=1}^\infty$ è un ricoprimento di $A$, allora da $\diam C_j \le \delta$ segue $\diam C_j \le \eta$ $(j = 1, 2, \ldots)$ e quindi
\[
\Set{ \sum_{j=1}^\infty \alpha(s) \left(\frac{\diam C_j}{2}\right)^s | A \subset \bigcup_{j=1}^\infty C_j,\, \diam C_j \le \delta } \subset \Set{ \sum_{j=1}^\infty \alpha(s) \left(\frac{\diam C_j}{2}\right)^s | A \subset \bigcup_{j=1}^\infty C_j,\, \diam C_j \le \eta },
\]
ossia passando agli estremi inferiori
\mymath{\Haus_\delta^s(A) \ge \Haus_\eta^s(A).}{\qedsymbol}
\end{proofsec}
\end{proof}

\begin{definizione}
\label{def:misura_hausdorff}
Per $A$ ed $s$ come in (\ref{def:misura_hausdorff_delta}), definiamo
\[
\Haus^s(A) \equiv \lim_{\delta \to 0} \Haus_\delta^s(A) = \sup_{\delta > 0} \Haus_\delta^s (A).
\]
Chiamiamo $\Haus^s$ la \emph{misura di Hausdorff $s$-dimensionale}\index{misura!di Hausdorff} su $\RR^n$.
\end{definizione}

\begin{osservazione}
La richiesta $\delta \to 0$ costringe il ricoprimento a ``seguire la geometria locale'' dell'insieme $A$.
\end{osservazione}

\begin{teorema}
\label{thm:misura_hausdorff}
$\Haus^s$ è una misura Borel regolare su $\RR^n$.
\end{teorema}

\begin{proof}
\begin{proofsec}
\emph{$\Haus^s$ è una misura.}\hspace{.5em} Si scelgano $\{A_k\}_{k=1}^\infty \subset \RR^n$. Allora, tenendo presente che $\Haus_\delta^s$ è una misura,
\[
\Haus_\delta^s \left(\bigcup_{k=1}^\infty A_k\right) \le \sum_{k=1}^\infty \Haus_\delta^s(A_k) \le \sum_{k=1}^\infty \Haus^s(A_k).
\]
Si faccia tendere $\delta \to 0$.
\end{proofsec}

\begin{proofsec}
\emph{$\Haus^s$ è una misura di Borel.}\hspace{.5em} Si scelgano $A,\, B \subset \RR^n$ con $\dist(A,\, B) > 0$, e sia $0 < \delta < \dist(A,\, B)$. Supponiamo che $A \cup B \subset \bigcup_{k=1}^\infty C_k$ e $\diam C_k \le \delta$.

Osserviamo innanzitutto che se $C_i \cap A \ne \emptyset$ e $C_j \cap B \ne \emptyset$ allora $C_i \ne C_j$: invero, se così non fosse, esisterebbero $x \in A$ e $y \in B$ tali da aversi $\abs{x - y} \le \diam C_j < \dist(A,\, B)$, che è palesemente assurdo.

Scriviamo $\AA \equiv \Set{ C_k | C_k \cap A \ne \emptyset }$ e $\BB \equiv \Set{ C_k | C_k \cap B \ne \emptyset }$. Allora $A \subset \bigcup_{C_k \in \AA} C_k$ e $B \subset \bigcup_{C_k \in \BB} C_k$, e inoltre $C_i \ne C_j$ se $C_i \in \AA$, $C_j \in \BB$. Pertanto $\AA \cap \BB = \emptyset$ e
\begin{align*}
\sum_{k=1}^\infty \alpha(s)\left(\frac{\diam C_k}{2}\right)^s \ge \sum_{C_k \in \AA} \alpha(s)\left(\frac{\diam C_k}{2}\right)^s + \sum_{C_k \in \BB} \alpha(s)\left(\frac{\diam C_k}{2}\right)^s \ge \Haus_\delta^s(A) + \Haus_\delta^s(B).
\end{align*}

Passando agli estremi inferiori su tutte le famiglie $\{C_k\}_{k=1}^\infty$, troviamo che $\Haus_\delta^s (A \cup B) \ge \Haus_\delta^s(A) + \Haus_\delta^s(B)$, purché $0 < \delta < \dist(A,\, B)$. Facendo tendere $\delta \to 0$, otteniamo $\Haus^s(A \cup B) \ge \Haus^s(A) + \Haus^s(B)$. Di conseguenza,
\[
\Haus^s(A \cup B) = \Haus^s(A) + \Haus^s(B)
\]
per tutti gli $A,\, B \subset \RR^n$ con $\dist(A,\, B) > 0$. Quindi il criterio di Caratheodory (\ref{thm:criterio_caratheodory}) implica che $\Haus^s$ è una misura di Borel.
\end{proofsec}

\begin{proofsec}
\emph{$\Haus^s$ è una misura Borel regolare.}\hspace{.5em} Dobbiamo provare che, dato $A \subset \RR^n$, esiste un boreliano $B \supset A$ con $\Haus^s(A) = \Haus^s(B)$. A tal fine scegliamo, per ogni $k \ge 1$, una famiglia di insiemi $\{C_j^k\}_{j=1}^\infty$ tali che $\diam C_j^k \le 1/k$, $A \subset \bigcup_{j=1}^\infty C_j^k$, e
\[
\sum_{j=1}^\infty \alpha(s)\left(\frac{\diam C_j^k}{2}\right)^s \le \Haus_{1/k}^s (A) + \frac{1}{k}.
\]
Si noti che $\diam \closure{C_j^k} = \diam C_j^k$; quindi possiamo assumere che i $C_j^k$ siano chiusi. Poniamo allora $A_k \equiv \bigcup_{j=1}^\infty C_j^k$, $B \equiv \bigcap_{k=1}^\infty A_k$; $B$ è un boreliano. Inoltre $A \subset A_k$ per ogni $k$, e quindi $A \subset B$, per cui $\Haus^s(A) \le \Haus^s(B)$. D'altra parte, $B \subset A_k$ per ogni $k$, sicché
\[
\Haus_{1/k}^s (B) \le \sum_{j=1}^\infty \alpha(s)\left(\frac{\diam C_j^k}{2}\right)^s \le \Haus_{1/k}^s (A) + \frac{1}{k}.
\]
Facendo tendere $k \to \infty$, otteniamo $\Haus^s(B) \le \Haus^s(A)$ e quindi $\Haus^s(A) = \Haus^s(B)$.\qed
\end{proofsec}
\end{proof}

\begin{osservazione}
Se $0 \le s < n$, $\Haus^s$ \emph{non} è una misura di Radon (si veda, più avanti, (\ref{cor:hausdorff_non_est_radon})).
\end{osservazione}

\begin{teorema}[Proprietà elementari della misura di Hausdorff]
\label{thm:proprieta_misura_hausdorff}
\index{proprietà!della misura di Hausdorff}
\mbox{}
\begin{itemize}
\item[(i)] $\Haus^0$ è la misura che conta i punti
\item[(ii)] $\Haus^1 = \Leb^1$ su $\RR^1$
\item[(iii)] $\Haus^s \equiv 0$ su $\RR^n$ per ogni $s > n$
\item[(iv)] $\Haus^s (\lambda A) = \lambda^s \Haus^s (A)$ per ogni $\lambda > 0$, $A \subset \RR^n$
\item[(v)] $\Haus^s (L(A)) = \Haus^s (A)$ per ogni isometria affine $L : \RR^n \rightarrow \RR^n$, $A \subset \RR^n$
\end{itemize}
\end{teorema}

\begin{proof}
\begin{proofsec}
Sia $C_j \subset \RR^n$ un insieme arbitrario. Allora, tenendo presente che $\alpha(0) = 1/\Gamma(1) = 1$, risulta
\[
\alpha(0)\left(\frac{\diam C_j}{2}\right)^0 =
\begin{cases}
1 & \text{se $\diam C_j > 0$,}\\
0 & \text{altrimenti.}
\end{cases}
\]
Pertanto, per ogni $a \in \RR^n$ e per ogni $\delta > 0$,
\[
\Haus_\delta^s (\{a\}) = \inf\Set{ \sum_{j=1}^\infty \alpha(0) \left(\frac{\diam C_j}{2}\right)^0 | a \in \bigcup_{j=1}^\infty C_j,\, \diam C_j \le \delta } = 1
\]
(si ricordi che nella definizione si richiede che almeno uno degli insiemi $C_j$ abbia diametro strettamente positivo), e quindi anche $\Haus^0(\{a\})= 1$. Ricordando la definizione della misura che conta i punti (\ref{ex:misura_che_conta}), ne segue la (i).
\end{proofsec}

\begin{proofsec}
Per dimostrare la (ii), osserviamo innanzitutto che
\[
\alpha(1) \equiv \frac{\sqrt{\pi}}{\Gamma(\frac{1}{2} + 1)} = \frac{\sqrt{\pi}}{\frac{1}{2}\Gamma(\frac{1}{2})} = 2 \frac{\sqrt{\pi}}{\sqrt{\pi}} = 2.
\]
Pertanto, scelti $A \subset \RR^1$ e $\delta > 0$, risulta
\begin{align*}
\Haus_\delta^1 (A) &= \inf\Set{ \sum_{j=1}^\infty \alpha(1) \frac{\diam C_j}{2} | A \subset \bigcup_{j=1}^\infty C_j,\, \diam C_j \le \delta }\\
&= \inf\Set{ \sum_{j=1}^\infty \diam C_j | A \subset \bigcup_{j=1}^\infty C_j,\, \diam C_j \le \delta }.
\end{align*}
Tenendo conto di (\ref{oss:caratterizzazione_misura_lebesgue_lineare}), otteniamo
\[
\Leb^1(A) = \inf\Set{ \sum_{j=1}^\infty \diam C_j | A \subset \bigcup_{j=1}^\infty C_j } \le \inf\Set{ \sum_{j=1}^\infty \diam C_j | A \subset \bigcup_{j=1}^\infty C_j,\, \diam C_j \le \delta } = \Haus_\delta^1 (A).
\]
D'altra parte, posto $I_k \equiv [k\delta,\, (k+1)\delta]$ per ogni intero $k$, risulta $\diam (C \cap I_k) \le \delta$ per ogni insieme $C \subset \RR^1$; inoltre, è immediato verificare che
\[
\sum_{k=-\infty}^\infty \diam (C \cap I_k) \le \diam C.
\]
Di conseguenza,
\[
\Leb^1(A) = \inf\Set{ \sum_{j=1}^\infty \diam C_j | A \subset \bigcup_{j=1}^\infty C_j } \ge \inf\Set{ \sum_{j=1}^\infty \sum_{k=-\infty}^\infty \diam (C_j \cap I_k) | A \subset \bigcup_{j=1}^\infty C_j } \ge \Haus_\delta^1 (A).
\]
Pertanto $\Leb^1 = \Haus_\delta^1$ per ogni $\delta > 0$, e quindi $\Leb^1 = \Haus^1$ su $\RR^1$.
\end{proofsec}

\begin{proofsec}
Proviamo ora la (iii). Si fissi un intero $m \ge 1$. Il cubo unitario $Q$ in $\RR^n$ può essere decomposto in $m^n$ cubetti di spigolo $1/m$ e diametro $\sqrt{n}/m$. Pertanto
\[
\Haus_{\sqrt{n}/m}^s (Q) \le \sum_{i=1}^{m^n} \alpha(s)\left(\frac{\sqrt{n}/m}{2}\right)^s = \alpha(s) 2^{-s} n^{s/2} m^{n-s},
\]
e l'ultimo membro tende a zero per $m \to \infty$, se $s > n$. Pertanto $\Haus^s(Q) = 0$, e quindi, essendo $\RR^n$ unione numerabile di cubi unitari, $\Haus^s(\RR^n) = 0$.
\end{proofsec}

\begin{proofsec}
La (iv) e la (v) seguono facilmente dalla definizione di $\Haus^s$, ove si ponga mente che $\diam (\lambda A) = \lambda \diam A$ per ogni $\lambda > 0$, e $\diam (L(A)) = \diam A$ per ogni isometria affine $L : \RR^n \rightarrow \RR^n$.\qed
\end{proofsec}
\end{proof}

\section{Dimensione di Hausdorff}

\begin{lemma}
Supponiamo che $A \subset \RR^n$ e $\Haus_\delta^s (A) = 0$ per qualche $0 < \delta \le \infty$. Allora $\Haus^s (A) = 0$.
\end{lemma}

\begin{proof}
Se $s = 0$ ed esiste $0 < \delta \le \infty$ tale che $\Haus_\delta^s(A) = 0$, allora $A = \emptyset$ e quindi anche $\Haus^s(A) = 0$. Possiamo quindi supporre $s > 0$. Si fissi $\epsilon > 0$. Esistono allora insiemi $\{C_j\}_{j=1}^\infty$ tali che $A \subset \bigcup_{j=1}^\infty C_j$ e
\[
\sum_{j=1}^\infty \alpha(s)\left(\frac{\diam C_j}{2}\right)^s \le \epsilon.
\]
In particolare per ogni $j$
\[
\alpha(s)\left(\frac{\diam C_j}{2}\right)^s \le \epsilon,
\]
sicché
\[
\diam C_j \le 2\left(\frac{\epsilon}{\alpha(s)}\right)^{1/s} \equiv \delta(\epsilon).
\]
Quindi
\[
\Haus_{\delta(\epsilon)}^s (A) \le \epsilon.
\]
Passando al limite per $\epsilon \to 0$ in entrambi i membri della disuguaglianza troviamo
\mymath{\Haus^s (A) = 0.}{\qedsymbol}
\end{proof}

\begin{lemma}
\label{lem:pre_proprieta_dimensione_hausdorff}
Siano $A \subset \RR^n$ e $0 \le s < t < \infty$.
\begin{itemize}
\item[(i)] Se $\Haus^s(A) < \infty$, allora $\Haus^t(A) = 0$.
\item[(ii)] Se $\Haus^t(A) > 0$, allora $\Haus^s(A) = \infty$.
\end{itemize}
\end{lemma}

\begin{proof}
Siano $\Haus^s(A) < \infty$ e $\delta > 0$. Esistono allora insiemi $\{C_j\}_{j=1}^\infty$ tali che $A \subset \bigcup_{j=1}^\infty C_j$, $\diam C_j \le \delta$ e
\[
\sum_{j=1}^\infty \alpha(s) \left(\frac{\diam C_j}{2}\right)^s \le \Haus_\delta^s(A) + 1 \le \Haus^s(A) + 1.
\]
Pertanto
\[
\Haus_\delta^t (A) \le \sum_{j=1}^\infty \alpha(t) \left(\frac{\diam C_j}{2}\right)^t
\]
da cui otteniamo
\begin{align*}
\Haus_\delta^t (A) &\le \frac{\alpha(t)}{\alpha(s)} \sum_{j=1}^\infty \alpha(s) \left(\frac{\diam C_j}{2}\right)^s \left(\frac{\diam C_j}{2}\right)^{t-s}\\
&\le \frac{\alpha(t)}{\alpha(s)} 2^{s-t} \delta^{t-s} \sum_{j=1}^\infty \alpha(s) \left(\frac{\diam C_j}{2}\right)^s \le \frac{\alpha(t)}{\alpha(s)} 2^{s-t} \delta^{t-s} (\Haus^s(A) + 1).
\end{align*}
Ricordando che $t > s$ e che $\Haus^s(A) < \infty$ notiamo che l'ultimo membro tende a 0 per $\delta \to 0$. Pertanto
\[
\Haus^t(A) = 0.
\]
Questo prova la (i).

Per quanto riguarda la (ii), se fosse $\Haus^s(A) < \infty$ si avrebbe, per la (i), $\Haus^t(A) = 0$, contro l'ipotesi.\qed
\end{proof}

\begin{definizione}
\label{def:dimensione_hausdorff}
La \emph{dimensione di Hausdorff}\index{dimensione di Hausdorff} di un insieme $A \subset \RR^n$ è definita come
\[
\Hausdim(A) \equiv \inf\Set{ 0 \le s < \infty | \Haus^s(A) = 0 }.
\]
\end{definizione}

\begin{osservazioni}
\label{oss:proprieta_dimensione_hausdorff}
\index{proprietà!della dimensione di Hausdorff}
\mbox{}
\begin{itemize}
\item[(i)] Se $s \equiv \Hausdim(A)$, allora $s \le n$, in quanto per (\ref{thm:proprieta_misura_hausdorff}) $\Haus^t(A) = 0$ per ogni $t > n$. Inoltre, $\Haus^t(A) = 0$ per ogni $t > s$ e $\Haus^t(A) = \infty$ per ogni $t < s$. Sia invero $t > s$; allora non può essere $\Haus^t(A) > 0$ altrimenti, per (\ref{lem:pre_proprieta_dimensione_hausdorff}), si avrebbe $\Haus^\sigma(A) = \infty$ per ogni $\sigma < t$. Analogamente, se $t < s$, deve essere $\Haus^t(A) = \infty$, altrimenti, sempre per (\ref{lem:pre_proprieta_dimensione_hausdorff}), si avrebbe $\Haus^\tau(A) = 0$ per ogni $t < \tau < s$. 
\item[(ii)] Inoltre, se $s = \Hausdim(A)$, allora $\Haus^s(A)$ può essere un qualsiasi numero compreso tra $0$ e $\infty$, estremi inclusi; d'altra parte, $\Hausdim(A)$ può non essere un intero. Anche se $\Hausdim(A) = k$ è un intero e $0 < \Haus^k(A) < \infty$, $A$ può non essere una ``superficie $k$-dimensionale''; si consulti \cite{falconer} o \cite{federer} per esempi di insiemi $A \subset \RR^n$ estremamente complessi, con $0 < \Haus^k(A) < \infty$. Si vedano inoltre, più avanti, (\ref{def:insiemi_cantor_like}) e (\ref{thm:dimensione_insieme_cantor}).
\end{itemize}
\end{osservazioni}

\begin{teorema}
\label{thm:proprieta_dimensione_hausdorff}
\index{proprietà!della dimensione di Hausdorff}
La dimensione di Hausdorff gode delle proprietà seguenti:
\begin{itemize}
\item[(i)] \emph{Monotonia.} Se $A \subset B$ allora $\Hausdim(A) \le \Hausdim(B)$.
\item[(ii)] \emph{Stabilità numerabile.} Se $\{A_j\}_{j=1}^\infty$ è una qualsiasi successione di insiemi, risulta
\[
\Hausdim\left(\bigcup_{j=1}^\infty A_j\right) = \sup_{1 \le j \le \infty} \Hausdim(A_j).
\]
\item[(iii)] \emph{Insiemi numerabili.} $\Hausdim(A) = 0$ per ogni insieme numerabile $A \subset \RR^n$.
\item[(iv)] \emph{Aperti.} Se $U \subset \RR^n$ è un aperto (non vuoto), $\Hausdim(U) = n$.
\item[(v)] \emph{Varietà.} Se $A$ è una sottovarietà liscia $m$-dimensionale di $\RR^n$, $\Hausdim(A) = m$.
\end{itemize}
\end{teorema}

\begin{proof}
\begin{proofsec}
Se $A \subset B$ e $\Haus^s(B) = 0$ allora anche $\Haus^s(A) = 0$; pertanto
\[
\Set{ 0 \le s < \infty | \Haus^s(B) = 0 } \subset \Set{ 0 \le s < \infty | \Haus^s(A) = 0 },
\]
e quindi
\[
\Hausdim(B) = \inf\Set{ 0 \le s < \infty | \Haus^s(B) = 0 } \ge \inf\Set{ 0 \le s < \infty | \Haus^s(A) = 0 } = \Hausdim(A).
\]
La (i) resta così provata.
\end{proofsec}

\begin{proofsec}
Per la proprietà di monotonia, $\Hausdim\left(\bigcup_{j=1}^\infty A_j\right) \ge \Hausdim(A_k)$ per ogni $k$. D'altra parte, se $s > \Hausdim(A_j)$ per ogni $j$, per (\ref{oss:proprieta_dimensione_hausdorff}) si ha anche $\Haus^s(A_j) = 0$ sicché $\Haus^s\left(\bigcup_{j=1}^\infty A_j\right) = 0$. Ne segue la (ii). 
\end{proofsec}

\begin{proofsec}
Per provare la (iii), osserviamo che $\Haus^0\{x\} = 1$ per ogni $x \in A$, per cui $\Hausdim\{x\} = 0$. Se dunque $A$ è numerabile, per la (ii) risulta $\Hausdim(A) = 0$.
\end{proofsec}

\begin{proofsec}
Sia $U \subset \RR^n$ aperto, $U \ne \emptyset$. Allora, siccome $U$ contiene una palla di misura $n$-dimensionale positiva, si ha $\Haus^n(U) > 0$ e quindi $\Hausdim(U) \ge n$. D'altra parte, $\Hausdim(U) \le n$ per (\ref{oss:proprieta_dimensione_hausdorff}). Si ha così la (iv). 
\end{proofsec}

\begin{proofsec}
Per la (v), si veda~\cite[pag.~32]{falconer}.\qed
\end{proofsec}
\end{proof}

\begin{definizioni}
\label{def:funzione_lipschitz}
\mbox{}
\begin{itemize}
\item[(i)] Una funzione $f : \RR^n \rightarrow \RR^m$ si dice \emph{Lipschitz}\index{funzione!Lipschitz} se esiste una costante $C$ tale che \mymath{\abs{f(x) - f(y)} \le C\abs{x - y}}{(*)} per ogni $x,\, y \in \RR^n$.
\item[(ii)] La più piccola costante $C$ per cui la (*) è valida per ogni $x,\, y$ si denota 
\[
\Lip(f) \equiv \sup\Set{ \frac{\abs{f(x) - f(y)}}{\abs{x - y}} | x,\,y \in \RR^n \text{ con $x \ne y$} }.
\]
\end{itemize}
\end{definizioni}

\begin{osservazione}
Una funzione Lipschitz è uniformemente continua, e quindi \emph{a fortiori} continua.
\end{osservazione}

\begin{osservazione}
\label{oss:componenti_funzione_lipschitz}
Una funzione $f \equiv (f^1, \ldots, f^m): \RR^n \rightarrow \RR^m$ è Lipschitz se e solo se tale è ciascuna $f^j$ $(j = 1, \ldots, m)$. E invero, per ogni $x,\, y \in \RR^n$ e per $j = 1, \ldots, m$ risulta
\[
\abs{f^j(x) - f^j(y)} \le \abs{f(x) - f(y)} \le \sqrt{m} \max_{1 \le k \le m} \abs{f^k(x) - f^k(y)}
\]
sicché
\[
\Lip(f^j) \le \Lip(f) \le \sqrt{m} \max_{1 \le k \le m} \Lip(f^k).
\]
\end{osservazione}

\begin{teorema}
\label{thm:misura_di_hausdorff_e_funzioni_lipschitz}
Siano $f : \RR^n \rightarrow \RR^m$ una funzione Lipschitz, $A \subset \RR^n$, $0 \le s < \infty$. Allora
\[
\Haus^s(f(A)) \le (\Lip(f))^s \Haus^s(A).
\]
\end{teorema}

\begin{proof}
Si fissi $\delta > 0$ e si scelgano insiemi $\{C_j\}_{j=1}^\infty \subset \RR^n$ tali che $\diam C_j \le \delta$ e $A \subset \bigcup_{j=1}^\infty C_j$. Allora $\diam f(C_j) \le \Lip(f) \diam C_j \le \Lip(f) \delta$ e $f(A) \subset \bigcup_{j=1}^\infty f(C_j)$. Pertanto
\[
\Haus_{\Lip(f)\delta}^s (f(A)) \le \sum_{j=1}^\infty \alpha(s) \left(\frac{\diam f(C_j)}{2}\right)^s \le (\Lip(f))^s \sum_{j=1}^\infty \alpha(s) \left(\frac{\diam C_j}{2}\right)^s.
\]
Passando agli estremi inferiori su tutti i siffatti ricoprimenti $\{C_j\}_{j=1}^\infty$, troviamo
\[
\Haus_{\Lip(f)\delta}^s (f(A)) \le (\Lip(f))^s \Haus_\delta^s(A).
\]
Facciamo tendere $\delta \to 0$ per completare la dimostrazione.\qed
\end{proof}

\noindent In generale, la dimensione di un insieme, da sola, non ci dice molto sulle proprietà topologiche di quest'ultimo. Possiamo tuttavia affermare quanto segue:

\begin{lemma}
Un insieme $A \subset \RR^n$ con $\Hausdim(A) < 1$ è totalmente disconnesso (le componenti connesse di $A$ sono i punti).
\end{lemma}

\begin{proof}
Siano $x$ e $y$ punti distinti di $A$, e definiamo una funzione $f : \RR^n \rightarrow \RR$ ponendo $f(z) \equiv \abs{z - x}$. Risulta, per ogni $z,\, w \in \RR^n$,
\[
\abs{f(z) - f(w)} = \Abs{\abs{z - x} - \abs{w - x}} \le \Abs{(z - x) - (w - x)} = \abs{z - w},
\]
e quindi $f$ è Lipschitz con $\Lip(f) \le 1$. Pertanto, applicando (\ref{thm:misura_di_hausdorff_e_funzioni_lipschitz}), $\Hausdim(f(A)) \le \Hausdim(A) < 1$, ossia $f(A)$ è un sottoinsieme di $\RR$ con $\Haus^1(f(A)) = 0$. Ma da (\ref{thm:proprieta_misura_hausdorff}) sappiamo che $\Haus^1 = \Leb^1$ su $\RR$; quindi $\Leb^1(f(A)) = 0$. Questo implica che $f(A)$ non può contenere aperti non vuoti; in altri termini, per ogni aperto non vuoto $U \subset \RR$ si ha $U \cap (\RR - f(A)) \ne \emptyset$. Prendendo $U \equiv ]0,\, f(y)[$, vediamo allora che deve esistere un $r \in \RR - f(A)$ tale che $0 < r < f(y)$; risulta pertanto
\[
A = \Set{ z \in A | \abs{z - x} < r } \cup \Set{ z \in A | \abs{z - x} > r }.
\] 
Dunque $A$ è incluso in due aperti disgiunti contenenti l'uno $x$, l'altro $y$, sicché $x$ e $y$ appartengono a componenti connesse distinte di $A$.\qed
\end{proof}

\section{L'insieme di Cantor}

\begin{definizione}
\label{def:insiemi_cantor_like}
Costruiamo ricorsivamente su $n$ una famiglia di $2^n$-ple $\{J_{n1}, \ldots, J_{n,\, 2^n}\}$ di intervalli chiusi disgiunti inclusi in $[0,\, 1]$, aventi ciascuno lunghezza minore di $\frac{1}{2^n}$, come segue:
\begin{itemize}
\item[($\alpha$)] Per $n = 1$ rimuoviamo da $[0,\, 1]$ un qualsiasi intervallo aperto $I_{11}$ di lunghezza minore di 1, concentrico con $[0,\, 1]$. Otteniamo così due intervalli chiusi disgiunti $J_{11}$ e $J_{12}$ ciascuno di lunghezza minore di $\frac{1}{2}$; è il primo passo della costruzione. 
\item[($\beta$)] Supponiamo di aver completato il passo $n$-mo della costruzione. Abbiamo allora $2^n$ intervalli chiusi disgiunti $J_{n1}, \ldots, J_{n,\, 2^n}$ (numerati da sinistra a destra), ciascuno di lunghezza minore di $\frac{1}{2^n}$. Il passo $(n+1)$-mo consiste nel rimuovere da ciascun $J_{nk}$ $(1 \le k \le 2^n)$ un qualsiasi intervallo aperto $I_{n+1,\, k}$ di lunghezza minore della lunghezza di $J_{nk}$ e concentrico con $J_{nk}$. In tal modo, otteniamo $2^{n+1}$ intervalli chiusi $J_{n+1,\, 1}, \ldots, J_{n+1,\, 2^{n+1}}$ ciascuno di lunghezza minore di $\frac{1}{2^{n+1}}$.
\end{itemize}
Poniamo poi $P_n \equiv \bigcup_{k=1}^{2^n} J_{nk}$ $(n = 1, 2, \ldots)$ e $P \equiv \bigcap_{n=1}^\infty P_n$. Ogni insieme $P$ costruito in tal modo dicesi \emph{Cantor-like}\index{insieme!Cantor-like}. Nel caso particolare che $I_{11} = \left]\frac{1}{3},\, \frac{2}{3}\right[$ e che la lunghezza di $I_{n+1,\, k}$ sia esattamente $\frac{1}{3}$ della lunghezza di $J_{nk}$ per ogni $n \ge 1$, $1 \le k \le 2^n$, l'insieme $P$ prende il nome di \emph{insieme di Cantor ternario} (o semplicemente \emph{insieme di Cantor})\index{insieme!di Cantor}. In questa ipotesi si ha ad esempio $J_{11} = \left[0,\, \frac{1}{3}\right]$, $J_{12} = \left[\frac{2}{3},\, 1\right]$, $I_{21} = \left]\frac{1}{9},\, \frac{2}{9}\right[$, $I_{22} = \left]\frac{7}{9},\, \frac{8}{9}\right[$, $J_{21} = \left[0,\, \frac{1}{9}\right]$, etc. 
\end{definizione}

\begin{definizioni}
Siano $X$ uno spazio topologico, $A$ un suo sottoinsieme. Diremo che $A$ è:
\begin{itemize}
\item[(i)] \emph{mai denso} in $X$\index{insieme!mai denso}, se $\interior{\closure{A}} = \emptyset$;
\item[(ii)] \emph{perfetto}\index{insieme!perfetto}, se $A$ è chiuso e privo di punti isolati.
\end{itemize}
\end{definizioni}

\begin{teorema}
\label{thm:proprieta_topologiche_insieme_cantor}
\index{proprietà!dell'insieme di Cantor}
Sia $P$ un qualsiasi insieme Cantor-like. Allora $P$ è compatto, mai denso in $\RR$ e perfetto.
\end{teorema}

\begin{proof}
Continuiamo ad usare le notazioni di (\ref{def:insiemi_cantor_like}). Ovviamente ciascun $P_n$ è chiuso (in quanto unione finita di chiusi), sicché $P$ è chiuso e limitato e quindi compatto. Siccome poi nessun $P_n$ contiene un intervallo di lunghezza $\ge \frac{1}{2^n}$ e $P \subset P_n$ per ogni $n \ge 1$, ne segue che $P$ non contiene alcun intervallo (non degenere). Pertanto $\interior{\closure{P}} = \interior{P} = \emptyset$, cioè $P$ è mai denso in $\RR$.

Per provare che $P$ è anche perfetto, scegliamo ad arbitrio un $x \in P$ ed osserviamo che, per ogni $n \ge 1$, $x \in P_n$ sicché esiste $k_n$ tale che $x \in J_{n,\, k_n}$. Fissati allora un $\epsilon > 0$ ed un intero positivo $n$ tale che $\frac{1}{2^n} < \epsilon$, si ha che gli estremi di $J_{n,\, k_n}$ stanno entrambi in $]x - \epsilon,\, x + \epsilon[$. Ma, per come $P$ è stato costruito, tali estremi stanno anche in $P$; pertanto $x$ è un punto di accumulazione per $P$. Ne segue che $P$ è perfetto.\qed
\end{proof}

\begin{teorema}
\index{proprietà!dell'insieme di Cantor}
Sia $P$ l'insieme di Cantor. Allora
\[
P = \Set{ \sum_{n=1}^\infty \frac{x_n}{3^n} | x_n \in \{0,\, 2\} \text{ per ogni $n \ge 1$} };
\]
in particolare, $P$ ha la potenza del continuo.
\end{teorema}

\begin{proof}
Si veda~\cite[Theorem~6.64, pag.~71]{stromberg}.\qed
\end{proof}

\begin{osservazione}
Sia $P$ l'insieme di Cantor. Allo scopo di calcolare $\Hausdim(P)$, premettiamo un'argomentazione informale. Posto $P_S \equiv P \cap \left[0,\, \frac{1}{3}\right]$ e $P_D \equiv P \cap \left[\frac{2}{3},\, 1\right]$, si ha
\[
P_S = \frac{1}{3}P,\qquad P_D = \frac{1}{3}P,\qquad P = P_S \cup P_D,
\]
per cui applicando (\ref{thm:proprieta_misura_hausdorff}) possiamo scrivere per ogni $t$
\[
\Haus^t(P) = \Haus^t(P_S) + \Haus^t(P_D) = \left(\frac{1}{3}\right)^t\Haus^t(P) + \left(\frac{1}{3}\right)^t\Haus^t(P) = \frac{2}{3^t}\Haus^t(P). 
\]
\emph{Assumiamo che esista un $s$ tale che $0 < \Haus^s(P) < \infty$}; possiamo allora dividere per $\Haus^s(P)$ per ottenere $1 = 2/3^s$, ossia
\[
s = \frac{\log 2}{\log 3}.
\]
\end{osservazione}

\begin{teorema}
\label{thm:dimensione_insieme_cantor}
\index{proprietà!dell'insieme di Cantor}
Sia $P$ l'insieme di Cantor. Allora
\begin{itemize}
\item[(i)] $\Leb^1(P) = 0$;
\item[(ii)] $\Hausdim(P) = s$, dove
\[
s \equiv \frac{\log 2}{\log 3} = 0.63092975\ldots
\]
\end{itemize}
\end{teorema}

\begin{proof}
Usiamo ancora le notazioni di (\ref{def:insiemi_cantor_like}).

\begin{proofsec}
Per ogni intero positivo $n$ e per $1 \le k \le 2^n$ risulta $\Leb^1(J_{nk}) = \frac{1}{3^n}$, sicché \mymath{\Leb^1(P_n) = \Leb^1\left(\bigcup_{k=1}^{2^n} J_{nk}\right) = \sum_{k=1}^{2^n} \Leb^1(J_{nk}) = \frac{2^n}{3^n} = \left(\frac{2}{3}\right)^n.}{(n = 1, 2, \ldots)} Di conseguenza,
\[
\Leb^1(P) = \Leb^1\left(\bigcap_{n=1}^\infty P_n\right) = \lim_{n \to \infty} \Leb^1(P_n) = 0.
\]
La (i) resta così dimostrata.
\end{proofsec}

\begin{proofsec}
$\Haus^s (P) < \infty$.\hspace{.5em} Per ogni intero positivo $n$ si ha
\[
\Haus_{3^{-n}}^s (P) \le \Haus_{3^{-n}}^s (P_n) \le \sum_{k=1}^{2^n} \alpha(s) \left(\frac{\diam J_{nk}}{2}\right)^s = 2^{n-s}\alpha(s)\frac{1}{3^{ns}} = 2^{n-s}\alpha(s)\frac{1}{2^n}, 
\]
osservando che
\[
3^s = 3^{\log 2/\log 3} = 2.
\]
Pertanto
\[
\Haus^s (P) = \lim_{n \to \infty} \Haus_{3^{-n}}^s (P) \le \frac{\alpha(s)}{2^s} < \infty.
\]
\end{proofsec}

\begin{proofsec}
$\Haus^s (P) > 0$.\hspace{.5em} Basterà dimostrare che per ogni ricoprimento $\{C_j\}_{j=1}^\infty$ di $P$ risulta \mymath{\sum_{j=1}^\infty (\diam C_j)^s \ge \frac{1}{2}.}{(*)} Si osservi che
\[
\diam C_j = \diam [\inf C_j,\, \sup C_j],
\]
e quindi possiamo assumere che ciascun $C_j$ sia un intervallo $[a_j,\, b_j]$. Fissiamo $\epsilon > 0$; posto allora
\[
U_j \equiv \left]a_j - \frac{\epsilon}{2 \cdot 3^j},\, b_j + \frac{\epsilon}{2 \cdot 3^j}\right[
\]
per ciascun intero positivo $j$, otteniamo un ricoprimento aperto $\{U_j\}_{j=1}^\infty$ di $P$. Ma per (\ref{thm:proprieta_topologiche_insieme_cantor}) $P$ è compatto, per cui esiste $N < \infty$ tale che $P \subset \bigcup_{j=1}^N U_j$.
D'altra parte, $\diam U_j = \diam C_j + \frac{\epsilon}{3^j}$, sicché, osservando che $0 < s < 1$ e usando (\ref{lem:p_disuguaglianza}), risulta
\[
(\diam U_j)^s = \left(\diam C_j + \frac{\epsilon}{3^j}\right)^s \le (\diam C_j)^s + \left(\frac{\epsilon}{3^j}\right)^s = (\diam C_j)^s + \frac{\epsilon^s}{2^j}.
\]
Di conseguenza,
\[
(\diam C_j)^s \ge (\diam U_j)^s - \frac{\epsilon^s}{2^j},
\]
e quindi
\[
\sum_{j=1}^\infty (\diam C_j)^s \ge \sum_{j=1}^\infty (\diam U_j)^s - \sum_{j=1}^\infty \frac{\epsilon^s}{2^j} = \sum_{j=1}^\infty (\diam U_j)^s - \epsilon^s \ge \sum_{j=1}^N (\diam U_j)^s - \epsilon^s = \sum_{j=1}^N (\diam \closure{U_j})^s - \epsilon^s. 
\]
Possiamo allora limitarci a provare che la (*) vale per ogni ricoprimento \emph{finito} $\{C_j\}_{j=1}^N$ di $P$ costituito da intervalli chiusi (inclusi in $[0,\, 1]$). Fissiamo invero $1 \le j \le N$ e scegliamo un intero positivo $n$ tale che \mymath{3^{-(n+1)} \le \diam C_j < 3^{-n}.}{(**)} \`E chiaro che $C_j$ può intersecare al più uno tra gli intervalli $J_{n1}, \ldots, J_{n,\, 2^n}$, dal momento che la separazione tra tali intervalli è almeno $3^{-n}$. Se poi $m \ge n$, allora, per la costruzione di $P$, $C_j$ intersecherà al più $2^{m-n}$ tra gli intervalli $J_{m1}, \ldots, J_{m,\, 2^m}$. Siccome $N < \infty$, possiamo scegliere un $m$ sufficientemente grande da aversi $3^{-(m+1)} \le \diam C_j$ per ogni $j = 1, \ldots, N$; ma $\{C_j\}_{j=1}^N$ è un ricoprimento di $P$ e quindi interseca \emph{tutti}\/ i $2^m$ intervalli $J_{m1}, \ldots, J_{m,\, 2^m}$. Pertanto $N \ge 2^m / 2^{m-n} = 2^n$. Tenendo poi presente che, per la (**), $2^{m-n} = 2^m3^{-ns} = 2^m3^s3^{-(n+1)s} \le 2^m3^s(\diam C_j)^s$, e riordinando se necessario gli insiemi $C_j$, otteniamo
\[
\sum_{j=1}^N (\diam C_j)^s \ge \sum_{j=1}^{2^n} (\diam C_j)^s \ge 2^n \cdot \frac{2^{m-n}}{2^m3^s} = \frac{1}{3^s} = \frac{1}{2}.
\] 
\end{proofsec}

\begin{proofsec}
Mettendo insieme la (b) e la (c) otteniamo
\[
0 < \Haus^s(A) < \infty,
\]
per cui (\ref{lem:pre_proprieta_dimensione_hausdorff}) ci assicura che $\Haus^t(A) = 0$ per ogni $t > s$ e $\Haus^t(A) = \infty$ per ogni $t < s$. Pertanto $\Hausdim(A) = s$, cioè la (ii).\qed
\end{proofsec}
\end{proof}

\begin{osservazione}
Si può dimostrare che $\Haus^s(P) = 1$; si veda~\cite[pag.~35]{falconer}.
\end{osservazione}

\section{Disuguaglianza isodiametrica. $\Haus^n = \Leb^n$ su $\RR^n$}

\begin{lemma}
\label{lem:regione_sotto_il_grafico}
Sia $f : \RR^n \rightarrow [0,\, \infty]$ $\Leb^n$-misurabile. Allora la regione ``sotto il grafico di $f$'', ossia l'insieme
\[
A \equiv \Set { (x,\, y) | x \in \RR^n,\, y \in \RR,\, 0 \le y \le f(x) }
\]
è $\Leb^{n+1}$-misurabile. Analogamente, se $g : \RR^n \rightarrow [-\infty,\, 0]$ è $\Leb^n$-misurabile, l'insieme
\[
B \equiv \Set { (x,\, y) | x \in \RR^n,\, y \in \RR,\, g(x) \le y \le 0 }
\]
è $\Leb^{n+1}$-misurabile.
\end{lemma}

\begin{proof}
Si ponga
\[
h(x,\, y) = f(x) - y
\]
per $x \in \RR^n$ e $y \in \RR$. Allora $h$ è $\Leb^{n+1}$-misurabile e perciò
\[
A = \Set{ (x,\, y) | y \ge 0 } \cap \Set{ (x,\, y) | h(x,\, y) \ge 0 }
\]
è $\Leb^{n+1}$-misurabile. In modo analogo si dimostra che tale è $B$.\qed
\end{proof}

\begin{notazione}
Si fissino $a,\, b \in \RR^n$, con $\abs{a} = 1$. Definiamo
\begin{align*}
L_b^a &\equiv \Set{ b + ta | t \in \RR}, \text{ la retta per $b$ nella direzione $a$,}\\
P_a &\equiv \Set{ x \in \RR^n | x \cdot a = 0}, \text{ il piano per l'origine perpendicolare ad $a$.}
\end{align*}
\end{notazione}

\begin{definizione}
\label{def:simmetrizzazione_steiner}
Si scelga $a \in \RR^n$ con $\abs{a} = 1$, e sia $A \subset \RR^n$. Definiamo \emph{simmetrizzazione di Steiner}\index{simmetrizzazione di Steiner} di $A$ rispetto al piano $P_a$ l'insieme
\[
S_a(A) \equiv \bigcup_{\substack{b \in P_a\\A \cap L_b^a \ne \emptyset}} \Set{ b+ta | \abs{t} \le \frac{1}{2} \Haus^1(A \cap L_b^a) }.
\]
\end{definizione}

\begin{lemma}[Proprietà della simmetrizzazione di Steiner]
\label{lem:proprieta_simmetrizzazione_steiner}
\index{proprietà!della simmetrizzazione di Steiner}
\mbox{}
\begin{itemize}
\item[(i)] Se $A \subset B$, allora $S_a(A) \subset S_a(B)$.
\item[(ii)] $\diam S_a(A) \le \diam A$.
\item[(iii)] Se $A$ è $\Leb^n$-misurabile, allora tale è $S_a(A)$, e $\Leb^n(S_a(A)) = \Leb^n(A)$.
\end{itemize}
\end{lemma}

\begin{proof}
\begin{proofsec}
Supponiamo $A \subset B$, e sia $x \in S_a(A)$. Allora esistono $b \in P_a$ e $t \in \RR$ tali che $A \cap L_b^a \ne \emptyset$, $\abs{t} \le 1/2\Haus^1(A \cap L_b^a)$ e $x = b + ta$. Quindi $B \cap L_b^a \ne \emptyset$, e inoltre
\[
\abs{t} \le \frac{1}{2}\Haus^1(A \cap L_b^a) \le \frac{1}{2}\Haus^1(B\cap L_b^a),
\]
sicché $x \in S_a(B)$. Per l'arbitrarietà di $x \in S_a(A)$, la (i) è provata.
\end{proofsec}

\begin{proofsec}
Supponiamo di aver dimostrato la (ii) nel caso che $A$ sia chiuso. Per un insieme $A$ arbitrario segue allora dalla (i)
\[
\diam S_a(A) \le \diam S_a(\closure{A}) \le \diam \closure{A} = \diam A,
\]
per cui possiamo assumere, senza ledere la generalità, che $A$ è chiuso. Inoltre, la (ii) è banalmente verificata se $\diam A = \infty$; assumiamo allora che $\diam A < \infty$.
\end{proofsec}

\begin{proofsec}
\emph{Siano $a,\, b \in \RR^n$ e $r,\, s \in \RR$, con $\abs{a} = 1$ e $r \le s$. Allora $\Haus^1([b+ra,\, b+sa]) \le s-r$, dove}
\[
[b+ra,\, b+sa] \equiv \Set{ b + ta | r \le t \le s }.
\]
Consideriamo la funzione $G : [r,\, s] \rightarrow [b+ra,\, b+sa]$ data da $t \mapsto b+ta$; per ogni $t_1,\, t_2 \in \RR$ con $t_1 \ne t_2$ si ha
\[
\frac{\abs{G(t_1) - G(t_2)}}{\abs{t_1 - t_2}} = \frac{\abs{(b+t_1a) - (b+t_2a)}}{\abs{t_1 - t_2}} = \frac{\abs{t_1 - t_2}\abs{a}}{\abs{t_1 - t_2}} = 1,
\]
sicché $\Lip(G) = 1$. Pertanto, applicando (\ref{thm:misura_di_hausdorff_e_funzioni_lipschitz}), otteniamo $\Haus^1([b+ra,\, b+sa]) = \Haus^1(G([r,\, s])) \le \Haus^1([r,\, s]) = \Leb^1([r,\, s]) = s-r$.
\end{proofsec}

\begin{proofsec}
Si fissi ora $\epsilon > 0$. Avendosi per definizione 
\[
\diam S_a(A) = \sup\Set{ \abs{x - y} | x,\, y \in S_a(A) },
\]
esistono $x,\, y \in S_a(A)$ tali che
\[
\abs{x - y} \ge \diam S_a(A) - \epsilon.
\]
Scriviamo $b \equiv x - (x \cdot a)a$ e $c \equiv y - (y \cdot a)a$ (``altezze'' relative ad $a$ condotte da $x$ e $y$, rispettivamente); allora
\[
b \cdot a = (x \cdot a) - (x \cdot a)(a \cdot a) = (x \cdot a) - (x \cdot a) = 0,
\]
sicché $b \in P_a$. Analogamente, $c \in P_a$. Poniamo 
\begin{align*}
r &\equiv \inf\Set{ t | b + ta \in A },\\
s &\equiv \sup\Set{ t | b + ta \in A },\\
u &\equiv \inf\Set{ t | c + ta \in A },\\
v &\equiv \sup\Set{ t | c + ta \in A }.
\end{align*}
Senza perdita di generalità, possiamo assumere $v - r \ge s - u$. Allora
\[
v - r \ge \frac{1}{2}(v - r) + \frac{1}{2}(s - u) = \frac{1}{2}(s - r) + \frac{1}{2}(v - u);
\]
inoltre, $A \cap L_b^a \subset [b+ra,\, b+sa]$ e quindi, per la (c), $\Haus^1(A \cap L_b^a) \le s - r$, e analogamente $\Haus^1(A \cap L_c^a) \le v - u$. Pertanto, \mymath{v - r \ge \frac{1}{2}\Haus^1(A \cap L_b^a) + \frac{1}{2}\Haus^1(A \cap L_c^a).}{(*)} Ora, avendosi $x \in S_a(A)$ possiamo scrivere $x = b + ta$ per un $b \in P_a$ e un $t \in \RR$ tale che $\abs{t} \le 1/2\Haus^1(A \cap L_b^a)$; quindi $\abs{x \cdot a} = \abs{(b+ta) \cdot a} = \abs{t}$. Di conseguenza, $\abs{x \cdot a} \le 1/2 \Haus^1(A \cap L_b^a)$ e, analogamente, $\abs{y \cdot a} \le 1/2 \Haus^1(A \cap L_c^a)$. Ne segue, tenendo presente la (*), \mymath{v-r \ge \abs{x \cdot a} + \abs{y \cdot a} \ge \abs{x \cdot a - y \cdot a}.}{(**)}
\end{proofsec}

\begin{proofsec}
Si ha \mymath{x-y = b + (x \cdot a)a - c - (y \cdot a)a = b - c + (x \cdot a - y \cdot a)a,}{(***)} e inoltre $(b-c) \cdot (x \cdot a - y \cdot a)a = 0$ in quanto $b,\, c \in P_a$. Pertanto, elevando a quadrato il primo e l'ultimo membro nella (***) otteniamo
\[
\abs{x-y}^2 = \abs{b - c}^2 + \abs{x \cdot a - y \cdot a}^2\abs{a}^2 = \abs{b - c}^2 + \abs{x \cdot a - y \cdot a}^2.
\]
Ricordando poi la scelta di $x,\, y$ e la (**) possiamo scrivere \mymath{(\diam S_a(A) - \epsilon)^2 \le \abs{x - y}^2 = \abs{b - c}^2 + \abs{x \cdot a - y \cdot a}^2 \le \abs{b - c}^2 + (v - r)^2;}{(****)} tenendo inoltre presente che $(b-c) \cdot (r-v)a = 0$ possiamo riscrivere l'ultimo membro come segue:
\[
\abs{b - c}^2 + (v - r)^2 = \abs{b - c}^2 + \abs{r - v}^2\abs{a}^2 = \abs{b - c + (r-v)a}^2 = \abs{(b + ra) - (c + va)}^2.
\]
Ma, per ipotesi, $A$ è chiuso, per cui $b+ra,\, c+va \in A$. Ma allora $\abs{(b + ra) - (c + va)}^2 \le (\diam A)^2$; pertanto, per la (****), $(\diam S_a(A) - \epsilon)^2 \le (\diam A)^2$, ossia
\[
\diam S_a(A) - \epsilon \le \diam A.
\]
Stante l'arbitrarietà di $\epsilon > 0$, la (ii) resta dimostrata.
\end{proofsec}

\begin{proofsec}
Proveremo la (iii) soltanto nel caso che $a$ sia un versore coordinato standard. Invero, questo caso particolare sarà sufficiente per dimostrare la disuguaglianza isodiametrica (\ref{thm:disuguaglianza_isodiametrica}), e quindi anche per dimostrare che $\Haus^n = \Leb^n$ su $\RR^n$ (\ref{thm:hausdorff_uguale_lebesgue}). Ma per (\ref{thm:proprieta_misura_hausdorff}) $\Haus^n$ è invariante per isometrie, e in particolare per rotazioni; tale sarà allora anche $\Leb^n$. Di conseguenza, l'ipotesi $a \in \{e_1, \ldots, e_n\}$ non risulterà, in effetti, restrittiva.

Assumiamo dunque $a = e_n = (0, \ldots, 0,\, 1)$ (la dimostrazione è analoga se $a = e_j$, $1 \le j \le n-1$). Allora $P_a = P_{e_n} = \RR^{n-1}$. Dal teorema di Fubini (\ref{thm:fubini}) sappiamo che la funzione
\[
f : b \in \RR^{n-1} \mapsto \Leb^1\left(\Set{ t | (b,\, t) \in A }\right) \in \RR^1 
\]
è $\Leb^{n-1}$-integrabile e che
\[
\Leb^n(A) = (\Leb^{n-1}\times\Leb^1)(A) = \int_{\RR^{n-1}} f(b)\, db. 
\]
Ma
\[
\Leb^1\left(\Set{ t | (b,\, t) \in A }\right) = \Leb^1(A \cap L_b^{e_n}) = \Haus^1(A \cap L_b^{e_n})
\]
ricordando che per (\ref{thm:proprieta_misura_hausdorff}) $\Leb^1 = \Haus^1$ su $\RR^1$; di conseguenza, 
\[
S_{e_n}(A) = \Set{ (b,\, t) | \frac{-f(b)}{2} \le t \le \frac{f(b)}{2} } - \Set{ (b,\, 0) | A \cap L_b^{e_n} = \emptyset }
\]
è $\Leb^n$-misurabile per (\ref{lem:regione_sotto_il_grafico}), e tenendo presente che
\[
\Leb^n\left(\Set{ (b,\, 0) | A \cap L_b^{e_n} = \emptyset }\right) \le \Leb^n(\RR^{n-1} \times \{0\}) = 0
\]
otteniamo
\[
\Leb^n(S_{e_n}(A)) = \Leb^n\left(\Set{ (b,\, t) | \frac{-f(b)}{2} \le t \le \frac{f(b)}{2} }\right) = \int_{\RR^{n-1}} db \int_\frac{-f(b)}{2}^\frac{f(b)}{2} dt = \int_{\RR^{n-1}} f(b)\, db = \Leb^n(A),
\]
come volevasi.\qed
\end{proofsec}
\end{proof}

\begin{teorema}[Disuguaglianza isodiametrica]
\label{thm:disuguaglianza_isodiametrica}
\index{disuguaglianza isodiametrica}
Per tutti gli insiemi $A \subset \RR^n$ risulta
\[
\Leb^n(A) \le \alpha(n) \left(\frac{\diam A}{2}\right)^n.
\]
(In altri termini, fissato il diametro, l'insieme di misura $n$-dimensionale massima è la palla.)
\end{teorema}

\begin{proof}
\begin{proofsec}
Se $\diam A = \infty$, l'asserto è banale; supporremo perciò $\diam A < \infty$. Sia $\{e_1, \ldots, e_n\}$ la base standard di $\RR^n$, e definiamo induttivamente
\[
A_1 \equiv S_{e_1}(A),\quad A_2 \equiv S_{e_2}(A_1),\quad \ldots,\quad A_n \equiv S_{e_n}(A_{n-1}).
\]
Poniamo $A^\star = A_n$.
\end{proofsec}
 
\begin{proofsec}
\emph{$A^\star$ è simmetrico rispetto all'origine.}\hspace{.5em} Sia \mymath{\sigma_j : v \in \RR^n \mapsto v - 2(v \cdot e_j)e_j \in \RR^n}{(j = 1, \ldots, n)} la \emph{riflessione} rispetto a $P_{e_j}$; ovviamente $E \subset \RR^n$ è simmetrico rispetto a $P_{e_j}$ se e solo se $\sigma_j(E) = E$. Per $b \in P_{e_j}$ e per ogni $t \in \RR$ risulta
\[
\sigma_j(b+te_j) = b + te_j - 2((b+te_j) \cdot e_j)e_j = b + te_j - 2(b \cdot e_j + te_j \cdot e_j)e_j = b + te_j - 2te_j = b - te_j,
\]
sicché
\[
b + te_j \in S_{e_j}(E) \iff \sigma_j(b + te_j) \in S_{e_j}(E),
\]
ossia $S_{e_j}(E)$ è simmetrico rispetto a $P_{e_j}$. In particolare, $A_1$ è simmetrico rispetto a $P_{e_1}$. Procediamo ora per induzione; sia $1 \le k < n$ e supponiamo che $A_k$ sia simmetrico rispetto a $P_{e_1}, \ldots, P_{e_k}$. Per quanto osservato, $A_{k+1} = S_{e_{k+1}} (A_k)$ è simmetrico rispetto a $P_{e_{k+1}}$. Si fissino $1 \le j \le k$ e $b \in P_{e_{k+1}}$. Per ogni $t \in \RR$ si ha
\[
\sigma_j(b+te_{k+1}) = b + te_{k+1} - 2((b+te_{k+1}) \cdot e_j) e_j = b + te_{k+1} - 2(b \cdot e_j)e_j = \sigma_jb + te_{k+1},
\]
ossia $\sigma_j(L_b^{e_{k+1}}) = L_{\sigma_jb}^{e_{k+1}}$. Ricordando che per l'ipotesi induttiva $\sigma_j(A_k) = A_k$, otteniamo
\[
\sigma_j(A_k \cap L_b^{e_{k+1}}) = \sigma_j(A_k) \cap \sigma_j(L_b^{e_{k+1}}) = A_k \cap L_{\sigma_jb}^{e_{k+1}},
\]
e quindi, tenendo presente che $\Haus^1$ è ovviamente invariante rispetto a $\sigma_j$,
\[
\Haus^1(A_k \cap L_b^{e_{k+1}}) = \Haus^1(A_k \cap L_{\sigma_jb}^{e_{k+1}});
\]
di conseguenza
\[
\Set{ t | b + te_{k+1} \in A_{k+1} } = \Set{ t | \sigma_j b + te_{k+1} \in A_{k+1} }.
\]
Pertanto $\sigma_j(A_{k+1}) = A_{k+1}$; vale a dire, $A_{k+1}$ è simmetrico rispetto a $P_{e_j}$, per $1 \le j < n+1$. Per induzione, $A^\star = A_n$ è simmetrico rispetto a $P_{e_1}, \ldots, P_{e_n}$, e quindi rispetto all'origine.
\end{proofsec}

\begin{proofsec}
\emph{Si ha}
\[
\Leb^n(A^\star) \le \alpha(n) \left(\frac{\diam A^\star}{2}\right)^n.
\]
Si scelga $x \in A^\star$. Allora per la (a) anche $-x \in A^\star$, e pertanto
\[
\diam A^\star \ge \abs{x - (-x)} = \abs{2x} = 2\abs{x}.
\]
Ne segue $x \in B(0,\, \diam A^\star/2)$, e quindi, per l'arbitrarietà di $x$,
\[
A^\star \subset B\left(0,\, \frac{\diam A^\star}{2}\right).
\]
Di conseguenza, ricordando (\ref{thm:volume_palla_versione1}),
\[
\Leb^n(A^\star) \le \Leb^n \left(B\left(0,\, \frac{\diam A^\star}{2}\right)\right) = \alpha(n)\left(\frac{\diam A^\star}{2}\right)^n.
\]
\end{proofsec}

\begin{proofsec}
\emph{Si ha}
\[
\Leb^n(A) \le \alpha(n) \left(\frac{\diam A}{2}\right)^n.
\]
E invero, $\closure{A}$ è chiuso, quindi $\Leb^n$-misurabile; pertanto, ricordando che
\[
(\closure{A})^\star = S_{e_n} (S_{e_{n-1}} ( \cdots S_{e_1} (\closure{A}) \cdots ))
\]
e applicando $n$ volte (\ref{lem:proprieta_simmetrizzazione_steiner}), otteniamo
\[
\Leb^n((\closure{A})^\star) = \Leb^n(\closure{A}),\qquad \diam(\closure{A})^\star \le \diam \closure{A}.
\]
Dalla (c) (scritta con $\closure{A}$ al posto di $A$) sappiamo inoltre che
\[
\displaystyle\Leb^n((\closure{A})^\star) \le \alpha(n) \left(\frac{\diam (\closure{A})^\star}{2}\right)^n.
\]
Di conseguenza,
\[
\Leb^n(\closure{A}) = \Leb^n((\closure{A})^\star) \le \alpha(n) \left(\frac{\diam (\closure{A})^\star}{2}\right)^n \le \alpha(n) \left(\frac{\diam \closure{A}}{2}\right)^n = \alpha(n) \left(\frac{\diam A}{2}\right)^n.
\]
Per concludere osserviamo che $A \subset \closure{A}$ implica $\Leb^n(A) \le \Leb^n(\closure{A})$ e quindi
\mymath{\Leb^n(A) \le \alpha(n) \left(\frac{\diam A}{2}\right)^n.}{\qedsymbol}
\end{proofsec}
\end{proof}

\begin{osservazione}
La disuguaglianza isodiametrica è interessante dal momento che non è detto che $A$ sia contenuto in una palla di diametro $\diam A$. Consideriamo, invero, l'insieme $A \equiv \{a,\, b,\, c\} \subset \RR^2$, dove
\[
a \equiv (-\rho,\, 0)\qquad b \equiv (1,\, 0)\qquad c \equiv (0,\, 1),
\]
con $0 < \rho < \sqrt{2}-1$. Si ha
\[
\abs{a-b} = 1 + \rho < \sqrt{2},\qquad \abs{b-c} = \sqrt{2}
\]
e
\[
\abs{a-c} = \sqrt{\rho^2 + 1} < \sqrt{(\sqrt{2}-1)^2 + 1} = \sqrt{2 + 1 - 2\sqrt{2} + 1} = \sqrt{4 - 2\sqrt{2}} < \sqrt{4 - 2} = \sqrt{2},
\]
sicché $\diam A = \sqrt{2}$. Se ora $B$ è la palla chiusa di centro un $x \in \RR^2$ e raggio $\sqrt{2}/2$, è chiaro che affinché $b$ e $c$ appartengano a $B$ deve essere $x = (1/2,\, 1/2)$. Ma allora
\[
\abs{x-a} = \sqrt{\left(\frac{1}{2} + \rho\right)^2 + \left(\frac{1}{2}\right)^2} = \sqrt{\frac{1}{4} + \rho^2 + \rho + \frac{1}{4}} = \sqrt{\rho^2 + \rho + \frac{1}{2}} > \sqrt{\frac{1}{2}} = \frac{\sqrt{2}}{2},
\]
per cui $a \notin B$.
\end{osservazione}

\begin{teorema}
\label{thm:hausdorff_uguale_lebesgue}
$\Haus^n = \Leb^n$ su $\RR^n$.
\end{teorema}

\begin{proof}
\begin{proofsec}
\emph{$\Leb^n(A) \le \Haus^n(A)$ per ogni insieme $A \subset \RR^n$.}\hspace{.5em} Si fissi $\delta > 0$ e si scelgano insiemi $\{C_j\}_{j=1}^\infty$ tali che $A \subset \bigcup_{j=1}^\infty C_j$ e $\diam C_j \le \delta$. Allora, per la disuguaglianza isodiametrica,
\[
\Leb^n(A) \le \sum_{j=1}^\infty \Leb^n(C_j) \le \sum_{j=1}^\infty \alpha(n) \left(\frac{\diam C_j}{2}\right)^n.
\]
Passando agli estremi inferiori su tutte le famiglie $\{C_j\}_{j=1}^\infty$, troviamo che $\Leb^n(A) \le \Haus_\delta^n(A)$, e pertanto, facendo tendere $\delta \to 0$, $\Leb^n(A) \le \Haus^n(A)$.
\end{proofsec}

\begin{proofsec}
\emph{$\Haus_\delta^n$ è assolutamente continua rispetto a $\Leb^n$.}\hspace{.5em} Osserviamo in primo luogo che dalla definizione (\ref{def:misura_lebesgue}) di $\Leb^n$ segue subito che, per ogni $A \subset \RR^n$ e per ogni $\delta > 0$, \mymath{\Leb^n(A) = \inf\Set{ \sum_{i=1}^\infty \Leb^n(Q_i) | Q_i \text{ cubi, } A \subset \bigcup_{i=1}^\infty Q_i,\, \diam Q_i \le \delta }.}{(*)} Si ponga $C_n \equiv \alpha(n)(\sqrt{n}/2)^n$. Allora per ogni cubo $Q \subset \RR^n$, detta $l$ la lunghezza del suo spigolo, si ha
\[
\alpha(n) \left(\frac{\diam Q}{2}\right)^n = \alpha(n) \left(\frac{l\sqrt{n}}{2}\right)^n = C_n l^n = C_n \Leb^n(Q).
\]
Pertanto, per la (*),
\begin{align*}
\Haus_\delta^n(A) &\le \inf\Set{ \sum_{i=1}^\infty \alpha(n)\left(\frac{\diam Q_i}{2}\right)^n | Q_i \text{ cubi, } A \subset \bigcup_{i=1}^\infty Q_i,\, \diam Q_i \le \delta } = C_n\Leb^n(A).
\end{align*}
\end{proofsec}

\begin{proofsec}
\emph{$\Haus^n (A) \le \Leb^n (A)$ per ogni $A \subset \RR^n$.}\hspace{.5em} Si fissino $\delta > 0$, $\epsilon > 0$. Per la (*) possiamo scegliere cubi $\{Q_i\}_{i=1}^\infty$ tali che $A \subset \bigcup_{i=1}^\infty Q_i$, $\diam Q_i \le \delta$ e
\[
\sum_{i=1}^\infty \Leb^n (Q_i) \le \Leb^n (A) + \epsilon.
\]
Usando (\ref{cor:vitali_2}), per ogni $i$ troviamo una successione $\{B_k^i\}_{k=1}^\infty$ di palle chiuse \emph{disgiunte} contenute in $\interior{Q_i}$ tali che
\[
\diam B_k^i \le \delta,\qquad \Leb^n \left(\interior{Q_i} - \bigcup_{k=1}^\infty B_k^i\right) = 0.
\]
Ma ovviamente $\Leb^n (\boundary{Q_i}) = 0$, sicché è anche
\[
\Leb^n \left(Q_i - \bigcup_{k=1}^\infty B_k^i\right) = \Leb^n \left(\interior{Q_i} - \bigcup_{k=1}^\infty B_k^i\right) = 0;
\]
di conseguenza, per la (b), anche $\Haus_\delta^n \left(Q_i - \bigcup_{k=1}^\infty B_k^i\right) = 0$. Pertanto
\[
\Leb^n(Q_i) = \Leb^n\left(\bigcup_{k=1}^\infty B_k^i\right) \qquad\text{ e }\qquad \Haus_\delta^n(Q_i) = \Haus_\delta^n\left(\bigcup_{k=1}^\infty B_k^i\right);
\]
tenendo anche presente che dalla definizione (\ref{def:misura_hausdorff_delta}) segue subito $\Haus_\delta^n (E) \le \alpha(n) (\diam E/2)^n$ per ogni insieme $E \subset \RR^n$, otteniamo
\begin{align*}
\Haus_\delta^n (A) &\le \sum_{i=1}^\infty \Haus_\delta^n (Q_i) = \sum_{i=1}^\infty \Haus_\delta^n \left(\bigcup_{k=1}^\infty B_k^i\right) = \sum_{i=1}^\infty \sum_{k=1}^\infty \Haus_\delta^n (B_k^i)\\
&\le \sum_{i=1}^\infty \sum_{k=1}^\infty \alpha(n) \left(\frac{\diam B_k^i}{2}\right)^n = \sum_{i=1}^\infty \sum_{k=1}^\infty \Leb^n (B_k^i) = \sum_{i=1}^\infty \Leb^n \left(\bigcup_{k=1}^\infty B_k^i\right) = \sum_{i=1}^\infty \Leb^n (Q_i) \le \Leb^n (A) + \epsilon.
\end{align*}
Facciamo tendere $\epsilon \to 0$, e poi $\delta \to 0$, per ottenere $\Haus^n(A) \le \Leb^n(A)$.\qed
\end{proofsec}
\end{proof}

\begin{corollario}
\label{cor:hausdorff_non_est_radon}
Se $0 \le s < n$, $\Haus^s$ \emph{non} è una misura di Radon.
\end{corollario}

\begin{proof}
Sia $B_1 \subset \RR^n$ la palla chiusa unitaria (ma va ugualmente bene un qualsiasi compatto $K \subset \RR^n$, purché $\Leb^n(K) > 0$); allora $\Haus^n(B_1) = \Leb^n(B_1) > 0$. Per (\ref{lem:pre_proprieta_dimensione_hausdorff}) allora $\Haus^s(B_1) = \infty$, per ogni $s < n$.\qed
\end{proof}

\begin{corollario}
\label{cor:misura_lebesgue_est_invariante_per_rotazioni}
$\Leb^n$ è invariante per rotazioni.
\end{corollario}

\begin{proof}
Per il teorema, $\Leb^n = \Haus^n$ su $\RR^n$; ma da (\ref{thm:proprieta_misura_hausdorff}) sappiamo che $\Haus^n$ è invariante per rotazioni. Pertanto, tale è anche $\Leb^n$.\qed
\end{proof} 

\section{Misura di Hausdorff e proprietà fini delle funzioni}

In questa sezione studieremo alcune proprietà che legano il comportamento delle funzioni e la misura di Hausdorff.

\subsection{Grafici delle funzioni Lipschitz}

\begin{definizione}
Per $f : \RR^n \rightarrow \RR^m$, $A \subset \RR^n$, scriveremo
\[
G(f;\, A) \equiv \Set{(x,\, f(x)) | x \in A } \subset \RR^n \times \RR^m = \RR^{n+m};
\]
$G(f;\, A)$ è il \emph{grafico}\index{grafico di una funzione} di $f$ su $A$.
\end{definizione}

\begin{lemma}
\label{lem:dimensione_proiezione}
Supponiamo $n > k$. Siano $P : \RR^n \rightarrow \RR^k$ la proiezione usuale, $A \subset \RR^n$, $0 \le s < \infty$. Allora
\[
\Haus^s(P(A)) \le \Haus^s(A).
\]
\end{lemma}

\begin{proof}
La tesi segue da (\ref{thm:misura_di_hausdorff_e_funzioni_lipschitz}), ove si osservi che $\Lip(P) = 1$.\qed
\end{proof}

\begin{teorema}
\label{thm:grafico_funzioni_lipschitz}
Assumiamo $f : \RR^n \rightarrow \RR^m$, $\Leb^n(A) > 0$. Allora:
\begin{itemize}
\item[(i)] $\Hausdim(G(f;\, A)) \ge n$;
\item[(ii)] se $f$ è Lipschitz, $\Hausdim(G(f;\, A)) = n$.
\end{itemize}
(In altre parole, il grafico di una funzione Lipschitz ha la dimensione di Hausdorff ``che ci aspettavamo''.)
\end{teorema}

\begin{proof}
\begin{proofsec}
Sia $P : \RR^{n+m} \rightarrow \RR^n$ la proiezione. Applicando (\ref{lem:dimensione_proiezione}) scriviamo
\[
\Haus^n(G(f;\, A)) \ge \Haus^n(P(G(f;\, A))) = \Haus^n(A);
\]
ma per (\ref{thm:proprieta_misura_hausdorff}) $\Haus^n(A) = \Leb^n(A) > 0$, sicché $\Hausdim(G(f;\, A)) \ge n$.
\end{proofsec}

\begin{proofsec}
Denotiamo con $Q$ un qualsiasi cubo in $\RR^n$ avente spigolo di lunghezza 1. Suddividiamo $Q$ in $k^n$ cubetti $Q_1, \ldots, Q_{k^n}$, ciascuno avente spigolo di lunghezza $1/k$, e poniamo \mymath{a_j^i \equiv \min_{x \in Q_j} f^i(x) \qquad\text{ e }\qquad b_j^i \equiv \max_{x \in Q_j} f^i(x).}{(i = 1, \ldots, m;\;\; j = 1, \ldots, k^n)} Essendo $f$ Lipschitz, risulta
\[
\abs{b_j^i - a_j^i} \le \Lip(f^i) \diam Q_j \le \Lip(f) \diam Q_j = \Lip(f) \frac{\sqrt{n}}{k};
\]
ne segue, per $j = 1, 2, \ldots$, l'esistenza di un insieme $C_j \subset \RR^{n+m}$ tale che
\[
\Set{ (x,\, f(x)) | x \in Q_j \cap A } \subset C_j
\]
e
\[
\diam C_j = \sqrt{\sum_{i=1}^n \left(\frac{1}{k}\right)^2 + \sum_{i=1}^m \left(\Lip(f)\frac{\sqrt{n}}{k}\right)^2}
= \sqrt{\frac{n}{k^2} + m(\Lip(f))^2 \frac{n}{k^2}} = \frac{\sqrt{n}}{k} \sqrt{1 + m(\Lip(f))^2} = \frac{C}{k}, 
\]
dove si è posto $C \equiv \sqrt{n} \sqrt{1 + m(\Lip(f))^2}$. Avendosi $G(f;\, A \cap Q) \subset \bigcup_{j=1}^{k^n} C_j$, otteniamo
\[
\Haus_{C/k}^n(G(f;\, A \cap Q)) \le \sum_{j=1}^{k^n} \alpha(n) \left(\frac{\diam C_j}{2}\right)^n \le k^n \alpha(n) \left(\frac{C}{2k}\right)^n = \alpha(n) \left(\frac{C}{2}\right)^n.
\]
Facendo tendere $k \to \infty$, troviamo che $\Haus^n(G(f;\, A \cap Q)) < \infty$, sicché per (\ref{lem:pre_proprieta_dimensione_hausdorff}) $\Haus^t(G(f;\, A \cap Q)) = 0$ per ogni $t > n$. Pertanto, $\Hausdim(G(f;\, A \cap Q)) \le n$. Questa stima è valida per ogni cubo $Q$ in $\RR^n$ avente lato di lunghezza 1, e di conseguenza, ricoprendo $A$ con una famiglia numerabile di cubi e usando la proprietà di stabilità numerabile della dimensione di Hausdorff (\emph{cfr.}~(\ref{thm:proprieta_dimensione_hausdorff})), otteniamo che
\[
\Hausdim(G(f;\, A)) \le n.
\]
Da questa disuguaglianza e dalla (i) segue la (ii).\qed
\end{proofsec}
\end{proof}

\subsection{L'insieme dove una funzione sommabile è ``grande''}

\begin{teorema}
\index{insieme!dove una funzione sommabile è ``grande''}
Sia $f \in L_\textup{loc}^1 (\RR^n)$, supponiamo $0 \le s < n$, e definiamo
\[
\Lambda_s \equiv \Set{ x \in \RR^n | \limsup_{r \to 0} \frac{1}{r^s} \int_{B(x,\, r)} \abs{f}\, dy > 0 }.
\]
Allora
\[
\Haus^s(\Lambda_s) = 0.
\]
\end{teorema}

\begin{proof}
\begin{proofsec}
Risulta ovviamente, per ogni $x \in \RR^n$,
\[
\limsup_{r \to 0} \frac{1}{r^s} \int_{B(x,\, r)} \abs{f}\, dy = \limsup_{r \to 0} \frac{1}{r^s} \int_{B(x,\, r)} \abs{f}\chi_{B(x,\, 1)}\, dy;
\]
possiamo pertanto assumere che $f \in L^1(\RR^n)$. Per il teorema di differenziazione di Lebesgue-Besi\-covitch (\ref{thm:lebesgue_besicovitch})
\[
\lim_{r \to 0} \dashint_{B(x,\, r)} \abs{f}\, dy = \abs{f(x)},
\]
e pertanto
\begin{align*}
\lim_{r \to 0} \frac{1}{r^s} \int_{B(x,\, r)} \abs{f}\, dy &= \lim_{r \to 0} \frac{\alpha(n) r^{n-s}}{\alpha(n) r^n} \int_{B(x,\, r)} \abs{f}\, dy = \alpha(n) \lim_{r \to 0} \frac{r^{n-s}}{\Leb^n(B(x,\, r))} \int_{B(x,\, r)} \abs{f}\, dy\\
&= \alpha(n) \lim_{r \to 0} r^{n-s} \dashint_{B(x,\, r)} \abs{f}\, dy = \alpha(n) \lim_{r \to 0} r^{n-s} \abs{f(x)} = 0
\end{align*}
per $\qogni{x}{\Leb^n}$, essendo $0 \le s < n$. Ne segue
\[
\Leb^n(\Lambda_s) = 0.
\]
\end{proofsec}

\begin{proofsec}
Si fissino ora $\epsilon > 0$, $\delta > 0$, $\sigma > 0$. Essendo $f$ $\Leb^n$-sommabile, esiste per (\ref{thm:assoluta_continuita_integrale}) un $\eta > 0$ tale che
\[
\int_U \abs{f}\, dx < \sigma
\]
per ogni insieme $\Leb^n$-misurabile $U$ con $\Leb^n(U) < \eta$. Definiamo
\[
\Lambda_s^\epsilon \equiv \Set { x \in \RR^n | \limsup_{r \to 0} \frac{1}{r^s} \int_{B(x,\, r)} \abs{f}\, dy > \epsilon };
\]
si ha $\Lambda_s^\epsilon \subset \Lambda_s$ e quindi, per quanto sopra,
\[
\Leb^n(\Lambda_s^\epsilon) = 0.
\]
Esiste allora per (\ref{thm:approssimazione_con_aperti_e_compatti}) un aperto $U$ con $U \supset \Lambda_s^\epsilon$, $\Leb^n(U) < \eta$. Poniamo
\[
\FF \equiv \Set { B(x,\, r) | x \in \Lambda_s^\epsilon,\, 0 < r \le \delta,\, B(x,\, r) \subset U,\, \frac{1}{r^s} \int_{B(x,\, r)} \abs{f}\, dy > \epsilon }.
\]
Avendosi ovviamente
\[
\sup\Set{ \diam B | B \in \FF } \le 2\delta < \infty,
\]
il teorema di ricoprimento di Vitali (\ref{thm:ricoprimento_vitali}) ci garantisce l'esistenza di una successione $\{B_i\}_{i=1}^\infty$ di palle \emph{disgiunte} in $\FF$ tali che
\[
\bigcup_{B \in \FF} B \subset \bigcup_{i=1}^\infty \hat{B}_i.
\]
D'altra parte, se $x \in \Lambda_s^\epsilon$ risulta, per ogni $\rho > 0$,
\[
\sup_{0 < r < \rho} \frac{1}{r^s} \int_{B(x,\, r)} \abs{f}\, dy > \epsilon.
\]
Scegliamo $\rho \le \delta$ e inoltre così piccolo che $B(x,\, \rho) \subset U$; esiste allora $r < \rho$ tale che 
\[
\frac{1}{r^s} \int_{B(x,r)} \abs{f}\, dy > \epsilon.
\]
Pertanto $B(x,\, r) \in \FF$ e quindi
\[
x \in B(x,\, r) \subset \bigcup_{B \in \FF} B.
\]
Per l'arbitrarietà di $x \in \Lambda_s^\epsilon$,
\[
\Lambda_s^\epsilon \subset \bigcup_{B \in \FF} B \subset \bigcup_{i=1}^\infty \hat{B}_i.
\]
\end{proofsec}

\begin{proofsec}
Denotiamo con $r_i$ il raggio di $B_i$ $(i = 1, 2, \ldots)$; allora, per definizione di $\FF$,
\mymath{r_i^s \le \frac{1}{\epsilon} \int_{B_i} \abs{f}\, dy.}{(i = 1, 2, \ldots)} Quindi, tenendo presente che $\diam \hat{B}_i = 5\diam B_i = 10r_i \le 10\delta$, calcoliamo
\[
\Haus_{10\delta}^s (\Lambda_s^\epsilon) \le \sum_{i=1}^\infty \alpha(s)(5r_i)^s = \alpha(s) 5^s \sum_{i=1}^\infty r_i^s \le \frac{\alpha(s)5^s}{\epsilon} \sum_{i=1}^\infty \int_{B_i} \abs{f}\, dy \le \frac{\alpha(s)5^s}{\epsilon} \int_U \abs{f}\, dy \le \frac{\alpha(s)5^s}{\epsilon} \sigma.
\]
Facciamo tendere $\delta \to 0$, e poi $\sigma \to 0$, per ottenere
\[
\Haus^s(\Lambda_s^\epsilon) = 0;
\]
ne segue
\[
\Haus^s(\Lambda_s) \le \sum_{k=1}^\infty \Haus^s(\Lambda_s^{1/k}) = 0,
\]
come volevasi.\qed
\end{proofsec}
\end{proof}

%%%%%%%%%%%%%%%%%%%
% capitolo quarto %
%%%%%%%%%%%%%%%%%%%

\chapter{Formule di area e di coarea}

\section{Jacobiano di un operatore lineare}

Richiamiamo alcune definizioni e risultati standard di algebra lineare.

\begin{definizioni}
\mbox{}
\begin{itemize}
\item[(i)] Un operatore lineare $O : \RR^n \rightarrow \RR^m$ è \emph{ortogonale}\index{operatore!ortogonale} se $(Ox)\cdot(Oy) = x \cdot y$ per ogni $x,\, y \in \RR^n$.
\item[(ii)] Un operatore lineare $S : \RR^n \rightarrow \RR^n$ è \emph{simmetrico}\index{operatore!simmetrico} se $x \cdot (Sy) = (Sx) \cdot y$ per ogni $x,\, y \in \RR^n$.
\item[(iii)] Sia $A : \RR^n \rightarrow \RR^m$ un operatore lineare. L'\kern1pt\emph{operatore aggiunto}\index{operatore!aggiunto} di $A$ è l'operatore lineare\linebreak $A^\star : \RR^m \rightarrow \RR^n$ definito da $x \cdot (A^\star y) = (Ax) \cdot y$ per ogni $x \in \RR^n$, $y \in \RR^m$.
\end{itemize}
\end{definizioni}

\begin{lemma}
\mbox{}
\begin{itemize}
\item[(i)] $A^{\star\star} = A$.
\item[(ii)] $(A \circ B)^\star = B^\star \circ A^\star$.
\item[(iii)] $O^\star = O^{-1}$ se $O : \RR^n \rightarrow \RR^n$ è ortogonale.
\item[(iv)] $S^\star = S$ se $S : \RR^n \rightarrow \RR^n$ è simmetrico.
\end{itemize}
\end{lemma}

\begin{teorema}[Decomposizione Polare]
\index{decomposizione polare}
Sia $L : \RR^n \rightarrow \RR^m$ un operatore lineare.
\begin{itemize}
\item[(i)] Se $n \le m$, esistono un operatore simmetrico $S : \RR^n \rightarrow \RR^n$ ed un operatore ortogonale $O : \RR^n \rightarrow \RR^m$ tali che
\[
L = O \circ S.
\]
\item[(ii)] Se $n \ge m$, esistono un operatore simmetrico $S : \RR^m \rightarrow \RR^m$ ed un operatore ortogonale $O : \RR^m \rightarrow \RR^n$ tali che
\[
L = S \circ O^\star.
\]
\end{itemize}
\end{teorema}

\begin{proof}
\begin{proofsec}
Supponiamo dapprima $n \le m$. Consideriamo $C \equiv L^\star \circ L : \RR^n \rightarrow \RR^n$. Ora
\[
(Cx)\cdot y = (L^\star \circ Lx) \cdot y = Lx \cdot Ly = x \cdot (L^\star \circ L)y = x \cdot Cy
\]
e inoltre
\[
(Cx)\cdot x = Lx \cdot Lx \ge 0.
\]
Pertanto $C$ è simmetrico, semidefinito positivo. Esistono allora $\mu_1, \ldots, \mu_n \ge 0$ e una base ortonormale $\{x_k\}_{k=1}^n$ di $\RR^n$ tali che \mymath{Cx_k = \mu_kx_k.}{(k = 1, \ldots, n)} Scriviamo $\lambda_k\equiv\sqrt{\mu_k}$ per $k = 1, \ldots, n$.
\end{proofsec}

\begin{proofsec}
\emph{Esiste un insieme ortonormale $\{z_k\}_{k=1}^n$ in $\RR^m$ tale che \mymath{Lx_k = \lambda_kz_k.}{(*)} per $k = 1, 2, \ldots$} E invero, se $\lambda_k \ne 0$, definiamo
\[
z_k \equiv \frac{1}{\lambda_k} Lx_k.
\]
Allora per $\lambda_k,\, \lambda_l \ne 0$ risulta
\[
z_k \cdot z_l = \frac{1}{\lambda_k\lambda_l} Lx_k \cdot Lx_l = \frac{1}{\lambda_k\lambda_l} (Cx_k) \cdot x_l = \frac{\lambda_k^2}{\lambda_k\lambda_l} x_k \cdot x_l = \frac{\lambda_k}{\lambda_l} \delta_{kl}.
\]
Pertanto l'insieme $\Set{ z_k | \lambda_k \ne 0 }$ è ortonormale. Se invece $\lambda_k = 0$, si ha $Cx_k = \mu_k x_k = \lambda_k^2 x_k = 0$ da cui $Lx_k \cdot Lx_k = (Cx_k) \cdot x_k = 0$, ossia $Lx_k = 0$. La (*) risulta così verificata per qualsiasi $z_k$; possiamo allora scegliere come $z_k$ un qualsiasi versore tale che $\{z_k\}_{k=1}^n$ sia ortonormale. 
\end{proofsec}

\begin{proofsec}
Ora definiamo
\[
S : \RR^n \rightarrow \RR^n \qquad\text{ e }\qquad O : \RR^n \rightarrow \RR^m
\]
ponendo $Sx_k = \lambda_kx_k$ e $Ox_k = z_k$ $(k = 1, \ldots, n)$.  Allora $O \circ Sx_k = \lambda_k Ox_k = \lambda_k z_k = Lx_k$, e così, essendo $\{x_k\}_{k=1}^n$ una base di $\RR^n$, risulta
\[
L = O \circ S.
\]
L'operatore $S$ è chiaramente simmetrico, e $O$ è ortogonale dal momento che
\[
Ox_k \cdot Ox_l = z_k \cdot z_l = \delta_{kl} = x_k \cdot x_l.
\]
\end{proofsec}

\begin{proofsec}
Supponiamo ora $n \ge m$. Applicando la (i) all'operatore lineare $L^\star : \RR^m \rightarrow \RR^n$ otteniamo l'esistenza di un operatore simmetrico $S : \RR^m \rightarrow \RR^m$ e di un operatore ortogonale $O : \RR^m \rightarrow \RR^n$ tali che $L^\star = O \circ S$. Ma allora
\mymath{L = L^{\star\star} = (O \circ S)^\star = S^\star \circ O^\star = S \circ O^\star.}{\qedsymbol}
\end{proofsec}
\end{proof}

\begin{definizione}
\index{jacobiano!di un operatore lineare}
Sia $L : \RR^n \rightarrow \RR^m$ un operatore lineare.
\begin{itemize}
\item[(i)] Se $n \le m$, scriviamo $L = O \circ S$ come sopra, e definiamo lo \emph{jacobiano} di $L$ come
\[
\jacobian{L} \equiv \abs{\det S}.
\]
\item[(ii)] Se $n \ge m$, scriviamo $L = S \circ O^\star$ come sopra, e definiamo lo \emph{jacobiano} di $L$ come
\[
\jacobian{L} \equiv \abs{\det S}.
\]
\end{itemize}
\end{definizione}

\begin{lemma}
\label{pro:unicita_jacobiano}
\mbox{}
\begin{itemize}
\item[(i)] Se $n \le m$,
\[
\jacobian{L}^2 = \det(L^\star \circ L).
\]
\item[(ii)] Se $n \ge m$,
\[
\jacobian{L}^2 = \det(L \circ L^\star).
\]
\end{itemize}
\end{lemma}

\begin{proof}
Assumiamo $n \le m$, e scriviamo $L = O \circ S$, dove $S$ è simmetrico e $O$ è ortogonale. Allora $L^\star = S^\star \circ O^\star = S \circ O^\star$, sicché
\[
L^\star \circ L = S \circ O^\star \circ O \circ S = S \circ S = S^2,
\]
ricordando che $O^\star \circ O = I$. Pertanto
\[
\det (L^\star \circ L) = (\det S)^2 = \jacobian{L}^2.
\]
La (i) resta così provata; la dimostrazione della (ii) è analoga.\qed
\end{proof}

\begin{notazione}
\mbox{}
\begin{itemize}
\item[(i)] Se $n \le m$, definiamo
\[
\Lambda(m,\, n) \equiv \Set{ \lambda : \{1, \ldots, n\} \rightarrow \{1, \ldots, m\} | \text{$\lambda$ è crescente} }.
\]
\item[(ii)] Per ogni $\lambda \in \Lambda(m,\, n)$, definiamo $P_\lambda : \RR^m \rightarrow \RR^n$ ponendo
\[
P_\lambda(x_1, \ldots, x_m) \equiv (x_{\lambda(1)}, \ldots, x_{\lambda(n)}).
\]
\end{itemize}
\end{notazione}

\begin{teorema2}[Formula di Binet-Cauchy]
\label{thm:formula_binet_cauchy}
\index{formula!di Binet-Cauchy}
Assumiamo che $n \le m$ e che $L : \RR^n \rightarrow \RR^m$ sia lineare. Allora
\[
\jacobian{L}^2 = \sum_{\lambda \in \Lambda(m,\, n)} (\det(P_\lambda \circ L))^2.
\]
In particolare, $\jacobian{L}^2$ può scriversi come somma dei quadrati dei minori di ordine $n$ della matrice $(m \times n)$ che rappresenta $L$ rispetto alle basi standard di $\RR^n$ e $\RR^m$.
\end{teorema2}

\begin{proof}
Si veda~\cite[Theorem~4, Section~3.2, pag.~89]{evans}.\qed
\end{proof}

\section{Funzioni Lipschitz e differenziabilità}

\begin{definizione}
\label{def:funzione_differenziabile}
Una funzione $f : \RR^n \rightarrow \RR^m$ si dice \emph{differenziabile}\index{funzione!differenziabile} in $x \in \RR^n$ se esiste un operatore lineare $L : \RR^n \rightarrow \RR^m$ tale che
\[
\lim_{y \to x} \frac{\abs{f(y) - f(x) - L(y-x)}}{\abs{x-y}} = 0,
\]
o, ciò che è lo stesso, se
\[
f(y) = f(x) + L(y-x) + \smalloh(\abs{y-x})\qquad\text{per $y \to x$}.
\]
Un siffatto $L$, se esiste, è unico; ha allora senso denotarlo con $Df(x)$ e chiamarlo la \emph{derivata}\index{derivata!di una funzione} di $f$ in $x$.
\end{definizione}

\begin{teorema2}[Teorema di Rademacher]
\label{thm:rademacher}
\index{teorema!di Rademacher}
Sia $f : \RR^n \rightarrow \RR^m$ una funzione Lipschitz. Allora $f$ è differenziabile $\qo{\Leb^n}$
\end{teorema2}

\begin{proof}
Si veda~\cite[Theorem~2, Section~3.1.2, pag.~81]{evans}.\qed
\end{proof}

\begin{osservazione}
Il teorema di Rademacher è un risultato sorprendente; invero, la disuguaglianza
\[
\abs{f(x)-f(y)}\le\Lip(f)\abs{x-y}
\]
nulla ci dice, in apparenza, sulla possibilità di approssimare localmente $f$ mediante un operatore lineare.
\end{osservazione}

\begin{osservazione}
Sia $f : \RR^n \rightarrow \RR^m$ una funzione Lipschitz. Per il teorema di Rademacher, $f$ è differenziabile $\qo{\Leb^n}$, e pertanto $Df(x)$ esiste e può essere riguardato come un operatore lineare di $\RR^n$ in $\RR^m$ per $\qogni{x \in \RR^n}{\Leb^n}$.
\end{osservazione}

\begin{definizione}
\label{def:jacobiano_di_f}
Sia $f : \RR^n \rightarrow \RR^m$ una funzione Lipschitz. Lo \emph{jacobiano}\index{jacobiano!di una funzione Lipschitz} di $f$ è definito come 
\[
Jf(x) \equiv \jacobian{Df(x)}
\]
per $\qogni{x}{\Leb^n}$.
\end{definizione}

\section{Formula dell'area. Applicazioni}

\begin{teorema}[Formula dell'area]
\label{thm:formula_area}
\index{formula!dell'area}
Sia $f : \RR^n \rightarrow \RR^m$, con $n \le m$, una funzione Lipschitz. Allora per ogni insieme $\Leb^n$-misurabile $A \subset \RR^n$ risulta
\[
\int_A Jf\, dx = \int_{\RR^m} \Haus^0(A \cap f^{-1}\{y\})\, d\Haus^n(y).
\]
\end{teorema}

\begin{proof}
Si veda~\cite[Theorem~1, Section~3.3.2, pag.~96]{evans}.\qed
\end{proof}

\begin{teorema}[Cambiamento di variabili]
\label{thm:cambiamento_variabili_area}
Sia $f : \RR^n \rightarrow \RR^m$, con $n \le m$, una funzione Lipschitz. Allora per ogni funzione $\Leb^n$-sommabile $g : \RR^n \rightarrow \RR$ si ha
\[
\int_{\RR^n} g(x) Jf(x)\, dx = \int_{\RR^m} \left[\sum_{x \in f^{-1}\{y\}} g(x)\right]\, d\Haus^n(y).
\]
\end{teorema}

\begin{proof}
\begin{proofsec}
Osserviamo in primo luogo che $f^{-1}\{y\}$ è al più numerabile per $\qogni{y \in \RR^m}{\Haus^n}$. E invero, denotata con $B(0,\, k)$ la palla di centro l'origine e raggio $k$ $(k = 1, 2, \ldots)$, la formula dell'area ci assicura che
\[
\int_{\RR^m} \Haus^0(B(0,\, k) \cap f^{-1}\{y\})\, d\Haus^n(y) = \int_{B(0,\, k)} Jf\, dx < \infty,
\] 
sicché
\[
\Haus^0(B(0,\, k) \cap f^{-1}\{y\}) < \infty
\]
per $\qogni{y \in \RR^m}{\Haus^n}$. Avendosi ovviamente $f^{-1}\{y\} = \bigcup_{k=1}^\infty (B(0,\, k) \cap f^{-1}\{y\})$ e ricordando da (\ref{thm:proprieta_misura_hausdorff}) che $\Haus^0$ è la misura che conta i punti, ne segue che $f^{-1}\{y\}$ è al più numerabile per $\qogni{y \in \RR^m}{\Haus^n}$.
\end{proofsec}

\begin{proofsec}
Per dimostrare la formula, supponiamo dapprima $g \ge 0$. Per (\ref{thm:decomposizione_funzione_misurabile_non_negativa}) si ha
\[
g = \sum_{i=1}^\infty \frac{1}{i} \chi_{A_i},
\]
per appropriati insiemi $\Leb^n$-misurabili $\{A_i\}_{i=1}^\infty$. Utilizzando più volte il corollario (\ref{cor:convergenza_monotona}) del teorema della convergenza monotona e la formula dell'area possiamo scrivere 
\begin{align*}
\int_{\RR^n} gJf\, dx &= \sum_{i=1}^\infty \frac{1}{i} \int_{\RR^n} \chi_{A_i} Jf\, dx = \sum_{i=1}^\infty \frac{1}{i} \int_{A_i} Jf\, dx\\
&= \sum_{i=1}^\infty \frac{1}{i} \int_{\RR^m} \Haus^0(A_i \cap f^{-1}\{y\})\, d\Haus^n(y) = \int_{\RR^m} \sum_{i=1}^\infty \frac{1}{i} \sum_{x \in f^{-1}\{y\}} \chi_{A_i}(x)\, d\Haus^n(y)\\
&= \int_{\RR^m} \sum_{x \in f^{-1}\{y\}} \sum_{i=1}^\infty \frac{1}{i} \chi_{A_i}(x)\, d\Haus^n(y) = \int_{\RR^m} \left[\sum_{x \in f^{-1}\{y\}} g(x)\right]\, d\Haus^n(y).
\end{align*}
\end{proofsec}

\begin{proofsec}
Se ora $g$ è una qualsiasi funzione $\Leb^n$-sommabile, è sufficiente scrivere $g = g^+ - g^-$ ed applicare la (b) alle funzioni non negative $g^+$ e $g^-$.\qed
\end{proofsec}
\end{proof}

\begin{teorema2}[Lunghezza di una curva ($n = 1$, $m \ge 1$)]
\index{lunghezza di una curva}
Sia $f : \RR \rightarrow \RR^m$ Lipschitz e iniettiva. Per $-\infty < a < b < \infty$, definiamo la \emph{curva}\index{curva}
\[
C \equiv f([a,\, b]) \subset \RR^m.
\]
Allora
\[
\Haus^1(C) = \text{``lunghezza'' di $C$} = \int_a^b \abs{\dot{f}}\, dt.
\]
\end{teorema2}

\begin{proof}
Scriviamo
\[
f = (f^1, \ldots, f^m),\qquad Df = (\dot{f}^1, \ldots, \dot{f}^m),
\]
sicché
\[
Jf = \abs{Df} = \abs{\dot{f}}.
\]
Siccome $f$ è iniettiva,
\[
\Haus^0([a,\, b] \cap f^{-1}\{y\}) = \begin{cases}
1 & \text{se esiste $t \in [a,b]$ tale che $y = f(t)$,}\\
0 & \text{altrimenti;}
\end{cases}
\]
in altri termini, $\Haus^0([a,\, b] \cap f^{-1}\{y\}) = \chi_C(y)$. Dalla formula dell'area ricaviamo pertanto 
\mymath{\Haus^1(C) = \int_{\RR^m} \chi_C\, d\Haus^1 = \int_{\RR^m} \Haus^0([a,\, b] \cap f^{-1}\{y\})\, d\Haus^1(y) = \int_a^b Jf\, dt = \int_a^b \abs{\dot{f}}\, dt.}{\qedsymbol}
\end{proof}

\begin{teorema2}[Area della superficie di un grafico ($n \ge 1$, $m = n + 1$)]
\label{thm:area_superficie_grafico}
\index{area della superficie!di un grafico}
Siano $g : \RR^n \rightarrow \RR$ una funzione\linebreak Lipschitz, $U \subset \RR^n$ un aperto e $G$ il grafico di $g$ su $U$: 
\[
G \equiv G(g;\, U) = \Set{ (x,\, g(x)) | x \in U } \subset \RR^{n+1}.
\]
Allora
\[
\Haus^n(G) = \text{``area della superficie'' di $G$} = \int_U (1 + \abs{Dg}^2)^{\frac{1}{2}}\, dx.
\]
\end{teorema2}

\begin{proof}
Cominciamo con l'osservare che se $a_1, \ldots, a_n$ sono numeri reali e $A$ è la matrice
\[
\left(\begin{array}{ccccccc}
1 & & & & & & \\
& \ddots & & & & & \\
& & 1 & & & & \\
& & & 0 & 1 & & \\
& & & & \ddots & \ddots & \\
& & & & & 0 & 1\\
a_1 & \cdots & a_{j-1} & a_j & a_{j+1} & \cdots & a_n
\end{array}\right)_{n \times n},
\]
allora, con facili calcoli, $\det A = \pm a_j$. Definiamo poi $f : \RR^n \rightarrow \RR^{n+1}$ ponendo
\[
f(x) \equiv (x,\, g(x)).
\]
Allora $f$ è Lipschitz (per (\ref{oss:componenti_funzione_lipschitz})) e
\[
Df = \left(\begin{array}{ccc}
1 & \cdots & 0\\
\vdots & & \vdots\\
0 & \cdots & 1\\
\displaystyle\frac{\partial g}{\partial x_1} & \cdots & \displaystyle\frac{\partial g}{\partial x_n}
\end{array}\right)_{(n+1) \times n},
\]
sicché, applicando la formula di Binet-Cauchy (\ref{thm:formula_binet_cauchy}) e quanto osservato prima, otteniamo
\[
(Jf)^2 = \text{somma dei quadrati dei minori di ordine $n$ di $Df$} = 1 + \left(\frac{\partial g}{\partial x_1}\right)^2 + \ldots + \left(\frac{\partial g}{\partial x_n}\right)^2 = 1 + \abs{Dg}^2.
\]
Si noti che $f$ è iniettiva, per cui, fissato $y \in \RR^{n+1}$, risulta 
\[
\Haus^0(U \cap f^{-1}\{y\}) = \begin{cases}
1 & \text{se esiste $x \in U$ tale che $y = f(x)$,}\\
0 & \text{altrimenti;}
\end{cases}
\]
in altri termini, $\Haus^0(U \cap f^{-1}\{y\}) = \chi_G(y)$. Dalla formula dell'area ricaviamo pertanto 
\[
\Haus^n(G) = \int_{\RR^{n+1}} \chi_G\, d\Haus^n = \int_{\RR^{n+1}} \Haus^0(U \cap f^{-1}\{y\})\, d\Haus^n(y) = \int_U Jf\, dx = \int_U (1 + \abs{Dg}^2)^{\frac{1}{2}}\, dx,
\]
come volevasi.\qed
\end{proof}

\noindent Generalizziamo l'esempio precedente:

\begin{teorema2}[Area della superficie di una ipersuperficie parametrica ($n \ge 1$, $m = n + 1$)]
\label{thm:area_superficie_ipersuperficie_parametrica}
\index{area della superficie!di una ipersuperficie parametrica}
Siano $U$\linebreak $\subset \RR^n$ un aperto, $f : \RR^n \rightarrow \RR^{n+1}$ una funzione Lipschitz e iniettiva, e scriviamo
\[
S \equiv f(U) \subset \RR^{n+1}.
\]
Allora
\[
\Haus^n(S) = \text{``area della superficie'' di $S$} = \int_U \left(\sum_{k=1}^{n+1} \left[\frac{\partial(f^1, \ldots, f^{k-1},\, f^{k+1}, \ldots, f^{n+1})}{\partial (x_1, \ldots, x_n)}\right]^2\right)^{\frac{1}{2}}\, dx.
\]
\end{teorema2}

\begin{proof}
Si ha
\[
Df = \left(\begin{array}{ccc}
\displaystyle\frac{\partial f^1}{\partial x_1} & \cdots & \displaystyle\frac{\partial f^1}{\partial x_n}\\
\vdots & & \vdots\\
\displaystyle\frac{\partial f^{n+1}}{\partial x_1} & \cdots & \displaystyle\frac{\partial f^{n+1}}{\partial x_n}
\end{array}\right)_{(n+1) \times n},
\]
sicché, applicando la formula di Binet-Cauchy (\ref{thm:formula_binet_cauchy}),
\[
(Jf)^ 2 = \text{somma dei quadrati dei minori di ordine $n$} = \sum_{k=1}^{n+1} \left[\frac{\partial(f^1, \ldots, f^{k-1},\, f^{k+1}, \ldots, f^{n+1})}{\partial (x_1, \ldots, x_n)}\right]^2.
\]
La tesi segue dalla formula dell'area (\ref{thm:formula_area}) con ragionamenti analoghi a quelli svolti nell'esempio precedente.\qed 
\end{proof}

\section{Formula di coarea. Applicazioni}

\begin{teorema}[Formula di coarea]
\label{thm:formula_coarea}
Sia $f : \RR^n \rightarrow \RR^m$ Lipschitz, con $n \ge m$. Allora per ogni insieme $\Leb^n$-misurabile $A \subset \RR^n$ risulta
\[
\int_A Jf\, dx = \int_{\RR^m} \Haus^{n-m}(A \cap f^{-1}\{y\})\, dy.
\]
\end{teorema}

\begin{proof}
Si veda~\cite[Theorem~1, Section~3.4.2, pag.~112]{evans}.\qed 
\end{proof}

\begin{osservazioni}
\mbox{}
\begin{itemize}
\item[(i)] Si osservi che la formula di coarea è una sorta di generalizzazione ``curvilinea'' del teorema di Fubini.
\item[(ii)] Applicando la formula di coarea all'insieme $A \equiv \{Jf = 0\}$, scopriamo che \mymath{\Haus^{n-m}(\{Jf = 0\} \cap f^{-1}\{y\}) = 0}{(*)} per $\qogni{y \in \RR^m}{\Leb^m}$. Questa è una versione debole del \emph{teorema di Morse-Sard}, il quale asserisce che
\[
\{Jf = 0\} \cap f^{-1}\{y\} = \emptyset
\]
per $\qogni{y}{\Leb^m}$, purché $f \in C^k(\RR^n;\, \RR^m)$ per
\[
k = 1 + n - m.
\]
Si osservi, comunque, che la (*) richiede soltanto che $f$ sia Lipschitz.
\end{itemize}
\end{osservazioni}

\begin{teorema}[Cambiamento di variabili]
\label{thm:cambiamento_variabili_coarea}
Sia $f : \RR^n \rightarrow \RR^m$ Lipschitz, con $n \ge m$. Allora per ogni funzione $\Leb^n$-sommabile $g : \RR^n \rightarrow \RR$
\[
g_{|f^{-1}\{y\}}\text{ è $\Haus^{n-m}$-sommabile per $\qogni{y}{\Leb^m}$}
\]
e
\[
\int_{\RR^n} g(x)Jf(x)\, dx = \int_{\RR^m} \left[\int_{f^{-1}\{y\}} g\, d\Haus^{n-m}\right]\, dy.
\]
(Per ogni $y \in \RR^m$, $f^{-1}\{y\}$ è chiuso e dunque $\Haus^{n-m}$-misurabile.)
\end{teorema}

\begin{proof}
Analoga alla dimostrazione di (\ref{thm:cambiamento_variabili_area}) (si utilizza però la formula di coarea).\qed
\end{proof}

\begin{teorema2}[Coordinate polari]
\label{thm:coordinate_polari}
\index{coordinate polari}
\mbox{}
\begin{itemize}
\item[(i)] Sia $g : \RR^n \rightarrow \RR$ $\Leb^n$-sommabile. Allora
\[
\int_{\RR^n} g\, dx = \int_0^\infty \left(\int_{\boundary{B(0,\, \rho)}} g\, d\Haus^{n-1}\right)\, d\rho.
\]
\item[(ii)] Sia $r > 0$, e sia $g : B(0,\, r) \subset \RR^n \rightarrow \RR$ $\Leb^n$-sommabile. Allora
\[
\int_{B(0,\, r)} g\, dx = \int_0^r \left(\int_{\boundary{B(0,\, \rho)}} g\, d\Haus^{n-1}\right)\, d\rho.
\]
\end{itemize}
\end{teorema2}

\begin{proof}
Poniamo $f(x) \equiv \abs{x}$; allora
\[
Df(x) = \frac{x}{\abs{x}},\qquad Jf(x) = 1\,\qquad (x \ne 0);
\]
inoltre
\[
f^{-1}\{\rho\} = \begin{cases}
\boundary{B(0,\, \rho)} & \text{se $\rho \ge 0$},\\
\emptyset & \text{se $\rho < 0$}.
\end{cases}
\]
Applicando (\ref{thm:cambiamento_variabili_coarea}) si ha dunque 
\[
\int_{\RR^n} g\, dx = \int_{-\infty}^\infty \left(\int_{f^{-1}\{\rho\}} g\, d\Haus^{n-1}\right)\, d\rho = \int_0^\infty \left(\int_{\boundary{B(0,\, \rho)}} g\, d\Haus^{n-1}\right)\, d\rho,
\]
cioè la (i). Per ottenere la (ii), scriviamo la (i) con $g\chi_{B(0,\, r)}$ in luogo di $g$; risulta 
\[
\int_{B(0,\, r)} g\, dx = \int_{\RR^n} g\chi_{B(0,\, r)}\, dx = \int_0^\infty \left(\int_{\boundary{B(0,\, \rho)}} g\chi_{B(0,\, r)}\, d\Haus^{n-1}\right)\, d\rho = \int_0^r \left(\int_{\boundary{B(0,\, \rho)}} g\, d\Haus^{n-1}\right)\, d\rho.
\]
L'ultimo passaggio segue dall'osservazione che 
\[
\int_{\boundary{B(0,\, \rho)}} g\chi_{B(0,\, r)}\, d\Haus^{n-1} = 0
\]
per $\rho > r$.\qed
\end{proof}
\pagebreak

\begin{definizione}
Siano $X$ un insieme, $\mu$ una misura su $X$, $f : X \rightarrow \RR$ una funzione.
\begin{itemize}
\item[(i)] Si defisce \emph{estremo superiore essenziale}\index{estremo!superiore essenziale} di $f$ il numero
\[
\esssup f \equiv \inf\Set{ a \in \RR | \mu\left(\Set{ x | f(x) > a }\right) = 0 }
\] 
ed \emph{estremo inferiore essenziale}\index{estremo!inferiore essenziale} di $f$ il numero
\[
\essinf f \equiv \sup\Set{ b \in \RR | \mu\left(\Set{ x | f(x) < b }\right) = 0 },
\] 
con la convenzione che $\inf\emptyset = \infty$, $\sup\emptyset = -\infty$.
\item[(ii)] La funzione $f$ si dice \emph{essenzialmente limitata}\index{funzione!essenzialmente limitata} se
\[
\norm{f}_\infty \equiv \esssup\abs{f} < \infty.
\]
\end{itemize}
\end{definizione}

\begin{osservazione}
\label{oss:funzioni_essenzialmente_limitate}
Siano $X$ un insieme, $\mu$ una misura su $X$ e $f,\, g : X \rightarrow \RR$ due funzioni. Supponiamo che $f$ sia $\mu$-sommabile e che $g$ sia $\mu$-misurabile ed essenzialmente limitata. Allora
\[
\int \abs{fg}\, d\mu \le \norm{g}_\infty \int \abs{f} d\mu < \infty,
\]
e quindi $fg$ è $\mu$-sommabile. 
\end{osservazione}

\begin{teorema2}[Insiemi di livello]
\label{thm:insiemi_di_livello}
\index{insieme!di livello}
Sia $f : \RR^n \rightarrow \RR$ Lipschitz. Allora:
\begin{itemize}
\item[(i)]
\[
\int_{\RR^n} \abs{Df}\, dx = \int_{-\infty}^\infty \Haus^{n-1}(\{f = t\})\, dt;
\]
\item[(ii)] se inoltre $\essinf \abs{Df} > 0$ e $g : \RR^n \rightarrow \RR$ è $\Leb^n$-sommabile,
\[
\int_{\{f > t\}} g\, dx = \int_t^\infty \left(\int_{\{f = s\}} \frac{g}{\abs{Df}}\, d\Haus^{n-1}\right)\, ds.
\]
\end{itemize}
\end{teorema2}

\begin{proof}
\begin{proofsec}
Si ha $Jf = \abs{Df}$, sicché applicando la formula di coarea (\ref{thm:formula_coarea}) con $A \equiv \RR^n$ scriviamo
\[
\int_{\RR^n} \abs{Df}\, dx = \int_{\RR^n} Jf\, dx = \int_{-\infty}^\infty \Haus^{n-1}(f^{-1}\{t\})\, dt = \int_{-\infty}^\infty \Haus^{n-1}(\{f = t\})\, dt.
\]
\end{proofsec}

\begin{proofsec}
Come sopra, $Jf = \abs{Df}$; inoltre l'ipotesi $\essinf \abs{Df} > 0$ implica ovviamente che $1/\abs{Df}$ è essenzialmente limitata, per cui (\ref{oss:funzioni_essenzialmente_limitate}) ci garantisce che
\[
\frac{g}{\abs{Df}}
\]
è $\Leb^n$-sommabile. Scriviamo $E_t \equiv \{f > t\}$ e usiamo (\ref{thm:cambiamento_variabili_coarea}) per calcolare
\[
\int_{\{f > t\}} g\, dx = \int_{\RR^n} \chi_{E_t} \frac{g}{\abs{Df}} Jf\, dx
= \int_{-\infty}^\infty \left(\int_{\{f = s\}} \chi_{E_t} \frac{g}{\abs{Df}}\, d\Haus^{n-1}\right)\, ds = \int_t^\infty \left(\int_{\{f = s\}} \frac{g}{\abs{Df}}\, d\Haus^{n-1}\right)\, ds.
\]
L'ultimo passaggio segue dall'ovvia osservazione che, per $s < t$,
\[
\int_{\{f = s\}} \chi_{E_t} \frac{g}{\abs{Df}}\, d\Haus^{n-1} = 0.
\]
\end{proofsec}
\end{proof}

\subsection{Il volume della palla $n$-dimensionale}

\begin{notazione}
Nel seguito indicheremo con $\sigma(n)$ la misura di Hausdorff $(n-1)$-dimensionale della superficie della palla unitaria $B_1 \equiv B(0,\, 1)$ di $\RR^n$:
\[
\sigma(n) \equiv \Haus^{n-1}(\boundary{B_1}).
\]
\end{notazione}

\begin{osservazione}
Per ogni $x \in \RR^n$ e per ogni $r > 0$ risulta, per (\ref{thm:proprieta_misura_hausdorff}),
\[
\Haus^{n-1}(\boundary{B(x,\, r)}) = r^{n-1}\sigma(n).
\]
\end{osservazione}

\begin{lemma}
\label{lem:misura_superficie_palla}
Per ogni $n \ge 2$ risulta $\sigma(n) = n\alpha(n)$.
\end{lemma}

\begin{proof}
Applicando (\ref{thm:coordinate_polari}) con $g \equiv 1$ si ha subito
\[
\alpha(n) = \int_{B_1} dx = \int_0^1 d\rho \int_{\boundary{B(\rho,0)}} d\Haus^{n-1} = \int_0^1 \rho^{n-1}\sigma(n)\, d\rho = \frac{\sigma(n)}{n},
\]
da cui segue la tesi.\qed
\end{proof}

\noindent Enunciamo e dimostriamo un risultato già anticipato in (\ref{thm:volume_palla_versione1}).

\begin{teorema2}[Volume della palla unitaria di $\RR^n$]
\label{thm:volume_palla_versione2}
\index{volume!della palla $n$-dimensionale}
\mbox{}
\begin{itemize}
\item[(i)]
Per $n \ge 1$,
\[
\alpha(n) = \frac{\pi^{n/2}}{\Gamma(\frac{n}{2} + 1)} = \frac{\pi^{n/2}}{\frac{n}{2} \Gamma(\frac{n}{2})}.
\]
\item[(ii)]
In particolare, si ha per ogni intero $k \ge 1$
\[
\alpha(2k-1) = \frac{2^k \pi^{k-1}}{(2k-1)!!},\qquad \alpha(2k) = \frac{\pi^k}{k!}.
\]
\end{itemize}
\end{teorema2}

\begin{proof}
\begin{proofsec}
Ricordando (\ref{pro:proprieta_funzione_gamma}) si ha subito
\[
\frac{\pi^{1/2}}{\frac{1}{2}\Gamma\left(\frac{1}{2}\right)} = 2 \frac{\pi^{1/2}}{\pi^{1/2}} = 2 = \alpha(1)
\]
e
\[
\frac{\pi^{2/2}}{\frac{2}{2}\Gamma\left(\frac{2}{2}\right)} = \frac{\pi}{1 \cdot 1} = \pi = \alpha(2).
\] 
Ragioniamo ora per induzione e fissiamo $n \ge 3$ tale che la tesi sia vera per $n - 1$. Denotiamo con $x'$ il generico punto di $\RR^{n-1}$ e con $x \equiv (x',\, x_n) \equiv (x_1, \ldots, x_{n-1},\, x_n)$ il generico punto di $\RR^n$. Poiché
\begin{align*}
x \in B_1 &\iff \abs{x} \le 1 \iff x_1^2 + \ldots + x_{n-1}^2 + x_n^2 \le 1\\
&\iff x_n^2 \le 1 - (x_1^2 + \ldots + x_{n-1}^2 ) = 1 - \abs{x'}^2\\
&\iff \abs{x'} \le 1 \land \abs{x_n} \le \sqrt{1 - \abs{x'}^2},
\end{align*}
risulta
\[
B_1 = \Set{(x',\, x_n) \in \RR^n | \abs{x'} \le 1,\, \abs{x_n} \le \sqrt{1 - \abs{x'}^2} },
\]
sicché utilizzando il teorema di Fubini (\ref{thm:fubini}) scriviamo
\[
\alpha(n) = \int_{B_1} dx = \int_{B_1^{n-1}} dx' \int_{-\sqrt{1-\abs{x'}^2}}^{\sqrt{1 - \abs{x'}^2}} dx_n = 2\int_{B_1^{n-1}} \sqrt{1-\abs{x'}^2}\, dx',
\] 
dove $B_1^{n-1}$ denota la palla unitaria di $\RR^{n-1}$. Applicando poi (\ref{thm:coordinate_polari}) a $B_1^{n-1}$ otteniamo, ricordando anche (\ref{lem:misura_superficie_palla}),
\begin{align*}
\alpha(n) &= 2\int_0^1 d\rho \int_{\boundary{B_\rho^{n-1}}} \sqrt{1-\abs{x'}^2}\, d\Haus^{n-2} = 2\int_0^1 \sqrt{1-\rho^2}\, d\rho \int_{\boundary{B_\rho^{n-1}}} d\Haus^{n-2}\\
&= 2\int_0^1 \Haus^{n-2}(\boundary{B_\rho^{n-1}}) \sqrt{1-\rho^2}\, d\rho = 2\sigma(n-1) \int_0^1 \rho^{n-2} \sqrt{1-\rho^2}\, d\rho\\
&= 2(n-1) \alpha(n-1) \int_0^1 \rho^{n-2} \sqrt{1-\rho^2}\, d\rho.
\end{align*}
Effettuiamo, nell'ultimo integrale, il cambiamento di variabili $\rho = r^{1/2}$. In tal modo, ricordando che per ipotesi induttiva la tesi è vera per $n - 1$ e utilizzando (\ref{pro:proprieta_funzione_beta}) e (\ref{pro:proprieta_funzione_gamma}), otteniamo facilmente
\begin{align*}
\alpha(n) &= 2(n-1)\alpha(n-1) \int_0^1 r^{(n-2)/2} (1-r)^{1/2}\, \frac{1}{2}r^{-1/2}\, dr\\
&= (n-1)\alpha(n-1) \int_0^1 r^{(n-3)/2} (1-r)^{1/2}\, dr = (n-1) \frac{\pi^{(n-1)/2}}{\frac{n-1}{2} \Gamma\left(\frac{n-1}{2}\right)} \beta\left(\frac{n-1}{2}, \frac{3}{2}\right)\\
&= \frac{2\pi^{(n-1)/2}}{\Gamma\left(\frac{n-1}{2}\right)} \frac{\Gamma\left(\frac{n-1}{2}\right)\Gamma\left(\frac{3}{2}\right)}{\Gamma\left(\frac{n+2}{2}\right)} = 2\pi^{(n-1)/2}\frac{\frac{1}{2}\Gamma\left(\frac{1}{2}\right)}{\frac{n}{2}\Gamma\left(\frac{n}{2}\right)} = \frac{\pi^{n/2}}{\frac{n}{2}\Gamma\left(\frac{n}{2}\right)}.
\end{align*}
La (i) è così dimostrata.
\end{proofsec}

\begin{proofsec}
Proviamo ora la (ii). Per $k = 1$ risulta 
\[
\frac{2^1\pi^{1-1}}{(2 \cdot 1 - 1)!!} = 2 = \alpha(1) = \alpha(2 \cdot 1 - 1)
\]
e
\[
\frac{\pi^1}{1!} = \pi = \alpha(2) = \alpha(2 \cdot 1).
\]
Supposto dunque $k \ge 2$ e applicando (\ref{pro:proprieta_funzione_gamma}) si ha  
\[
\Gamma\left(\frac{2k-1}{2}\right) = \frac{2k-3}{2}\Gamma\left(\frac{2k-3}{2}\right) = \ldots = \frac{(2k-3)!!}{2^{k-1}}\Gamma\left(\frac{1}{2}\right) = \frac{(2k-3)!!}{2^{k-1}}\pi^{1/2}.
\]
Da questa uguaglianza, per la (i), otteniamo
\[
\alpha(2k-1) = \frac{\pi^{(2k-1)/2}}{\frac{2k-1}{2}\Gamma\left(\frac{2k-1}{2}\right)} = \frac{\pi^{(2k-1)/2 - 1/2} \cdot 2^{1+(k-1)}}{(2k-1)(2k-3)!!} = \frac{2^k \pi^{k-1}}{(2k-1)!!}.
\]
Infine, ricordando che $k\Gamma(k) = k!$,
\mymath{\alpha(2k) = \frac{\pi^{2k/2}}{\frac{2k}{2}\Gamma\left(\frac{2k}{2}\right)} = \frac{\pi^k}{k\Gamma(k)} = \frac{\pi^k}{k!}.}{\qedsymbol}
\end{proofsec}
\end{proof}

%%%%%%%%%%%%%%%%
% bibliografia %
%%%%%%%%%%%%%%%%

\cleardoublepage
\addcontentsline{toc}{chapter}{\bibname}

\begin{thebibliography}{9999}
\bibitem[AFP]{fusco} L.~Ambrosio, N.~Fusco, D.~Pallara, \emph{Functions of Bounded Variation and Free Discontinuity Problems}, Oxford University Press (2000)
\bibitem[E-G]{evans} L.~Evans, R.~Gariepy, \emph{Measure Theory and Fine Properties of Functions}, CRC Press (1992)
\bibitem[Falc]{falconer} K.~Falconer, \emph{Fractal Geometry}, 2nd~edn., Wiley (2003)
\bibitem[Fed]{federer} H.~Federer, \emph{Geometric Measure Theory}, Springer-Verlag (1969)
\bibitem[H-S]{stromberg} E.~Hewitt, K.~Stromberg, \emph{Real and Abstract Analysis}, Springer-Verlag (1965)
\bibitem[Hut]{hutchinson} J.~Hutchinson, ``Fractals and Self Similarity'', \emph{Indiana Univ. Math.~J.}\/~{\bfseries 30}, 713--747 (1981)
\end{thebibliography}

%%%%%%%%%%%%%%%%%%%%
% indice analitico %
%%%%%%%%%%%%%%%%%%%%

\cleardoublepage
\addcontentsline{toc}{chapter}{\indexname}
\printindex

\end{document}

%%%%%%%%%%%%%%%%%%%%%%%
% link utili su LaTeX %
%%%%%%%%%%%%%%%%%%%%%%%

% http://web.science.mq.edu.au/~rdale/resources/writingnotes/latexstyle.html
% http://www.stat.psu.edu/~surajit/present/pdf.html
% http://tex.loria.fr/english/fontes.html
% http://ctan.tug.org/tex-archive/info/Free_Math_Font_Survey/survey.html
% http://www.tug.dk/FontCatalogue/tgschola/
% http://forum.ubuntu-it.org/index.php?topic=211941.0
% http://nitens.org/taraborelli/latex#smallcaps
% http://www.math.uiuc.edu/~hildebr/tex/
% http://tex.loria.fr/english/packages.html
% http://wpage.unina.it/nfusco/
% http://forum.ubuntu-it.org/index.php?topic=211941.0
